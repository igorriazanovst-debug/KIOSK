import{r as ue,d as Pe,g as Ee,b as w,u as Ae,R as X,N as he,B as Le,e as Fe,f as ie}from"./vendor-COey_eQ5.js";import{G as ee,R as C,T as F,I as Me,L as re,a as se,S as De,E as Oe,C as _e,b as $e,c as Be,d as He}from"./konva-CDS8iPAx.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))t(d);new MutationObserver(d=>{for(const s of d)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&t(n)}).observe(document,{childList:!0,subtree:!0});function i(d){const s={};return d.integrity&&(s.integrity=d.integrity),d.referrerPolicy&&(s.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?s.credentials="include":d.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(d){if(d.ep)return;d.ep=!0;const s=i(d);fetch(d.href,s)}})();var ae={exports:{}},te={};var xe;function Ue(){if(xe)return te;xe=1;var r=ue(),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),t=Object.prototype.hasOwnProperty,d=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function n(c,a,l){var u,h={},x=null,m=null;l!==void 0&&(x=""+l),a.key!==void 0&&(x=""+a.key),a.ref!==void 0&&(m=a.ref);for(u in a)t.call(a,u)&&!s.hasOwnProperty(u)&&(h[u]=a[u]);if(c&&c.defaultProps)for(u in a=c.defaultProps,a)h[u]===void 0&&(h[u]=a[u]);return{$$typeof:o,type:c,key:x,ref:m,props:h,_owner:d.current}}return te.Fragment=i,te.jsx=n,te.jsxs=n,te}var fe;function qe(){return fe||(fe=1,ae.exports=Ue()),ae.exports}var e=qe(),oe={},ge;function Ve(){if(ge)return oe;ge=1;var r=Pe();return oe.createRoot=r.createRoot,oe.hydrateRoot=r.hydrateRoot,oe}var Xe=Ve();const Ge=Ee(Xe);var Ke={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ze=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ye=(r,o)=>{const i=w.forwardRef(({color:t="currentColor",size:d=24,strokeWidth:s=2,absoluteStrokeWidth:n,children:c,...a},l)=>w.createElement("svg",{ref:l,...Ke,width:d,height:d,stroke:t,strokeWidth:n?Number(s)*24/Number(d):s,className:`lucide lucide-${Ze(r)}`,...a},[...o.map(([u,h])=>w.createElement(u,h)),...(Array.isArray(c)?c:[c])||[]]));return i.displayName=`${r}`,i};var A=Ye;const Te=A("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Je=A("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Qe=A("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),et=A("FolderOpen",[["path",{d:"m6 14 1.45-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.55 6a2 2 0 0 1-1.94 1.5H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H18a2 2 0 0 1 2 2v2",key:"1nmvlm"}]]),tt=A("Grid",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}]]),rt=A("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),me=A("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),We=A("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),nt=A("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),it=A("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),st=A("Magnet",[["path",{d:"m6 15-4-4 6.75-6.77a7.79 7.79 0 0 1 11 11L13 22l-4-4 6.39-6.36a2.14 2.14 0 0 0-3-3L6 15",key:"1i3lhw"}],["path",{d:"m5 8 4 4",key:"j6kj7e"}],["path",{d:"m12 15 4 4",key:"lnac28"}]]),ot=A("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),at=A("MousePointer",[["path",{d:"m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z",key:"y2ucgo"}],["path",{d:"m13 13 6 6",key:"1nhxnf"}]]),lt=A("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),ct=A("Redo2",[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5v0A5.5 5.5 0 0 0 9.5 20H13",key:"19mnr4"}]]),dt=A("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),pt=A("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),ht=A("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ut=A("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),xt=A("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]),ft=A("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),gt=A("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),mt=A("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),jt=A("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),yt=A("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);class vt{logs=[];MAX_LOGS=100;log(o,i,t){const d={timestamp:new Date().toISOString(),level:o,message:i,details:t};this.logs.push(d),this.logs.length>this.MAX_LOGS&&this.logs.shift(),(o==="error"?console.error:o==="warn"?console.warn:console.log)(`[${o.toUpperCase()}] ${i}`,t||"")}info(o,i){this.log("info",o,i)}warn(o,i){this.log("warn",o,i)}error(o,i){this.log("error",o,i)}getLogs(){return[...this.logs]}clear(){this.logs=[]}export(){return JSON.stringify(this.logs,null,2)}}const P=new vt;class bt{baseUrl="";token=null;organizationName=null;plan=null;constructor(){this.loadToken()}loadToken(){const o=sessionStorage.getItem("kiosk_auth_token");if(o)try{const i=JSON.parse(o);this.token=i.token,this.organizationName=i.organizationName||null,this.plan=i.plan||null,P.info("Token loaded from sessionStorage",{hasToken:!!this.token,organization:this.organizationName,plan:this.plan})}catch(i){P.error("Failed to parse stored token",i),this.clearToken()}}saveToken(o,i,t){const d={token:o,organizationName:i,plan:t,savedAt:new Date().toISOString()};sessionStorage.setItem("kiosk_auth_token",JSON.stringify(d)),this.token=o,this.organizationName=i,this.plan=t,P.info("Token saved to sessionStorage",{organization:i,plan:t})}clearToken(){sessionStorage.removeItem("kiosk_auth_token"),this.token=null,this.organizationName=null,this.plan=null,P.info("Token cleared from sessionStorage")}isAuthenticated(){return this.token!==null}getToken(){return this.token}getOrganizationData(){return{name:this.organizationName,plan:this.plan}}async loginWithLicense(o){P.info("Attempting login with license key");try{const i=await this.request("/api/auth/license",{method:"POST",body:JSON.stringify({licenseKey:o})});return i.token&&i.license&&(this.saveToken(i.token,i.license.organizationName,i.license.plan),P.info("Login successful",{organization:i.license.organizationName,plan:i.license.plan})),i}catch(i){throw P.error("Login failed",i),i}}async refreshToken(){P.info("Refreshing token");try{const o=await this.request("/api/auth/refresh",{method:"POST",authenticated:!0});return o.token&&o.license&&(this.saveToken(o.token,o.license.organizationName,o.license.plan),P.info("Token refreshed successfully")),o}catch(o){throw P.error("Token refresh failed",o),o}}async verifyToken(){try{return await this.request("/api/auth/verify",{method:"GET",authenticated:!0}),P.info("Token verified successfully"),!0}catch(o){return P.warn("Token verification failed",o),this.clearToken(),!1}}logout(){P.info("User logout"),this.clearToken(),window.dispatchEvent(new CustomEvent("auth:logout"))}async getProjects(o){const i=new URLSearchParams;o?.search&&i.append("search",o.search),o?.tags&&i.append("tags",o.tags.join(",")),o?.isPublished!==void 0&&i.append("isPublished",String(o.isPublished)),o?.page&&i.append("page",String(o.page)),o?.limit&&i.append("limit",String(o.limit));const t=i.toString(),d=`/api/projects${t?"?"+t:""}`;return await this.request(d,{method:"GET",authenticated:!0})}async getProject(o){return await this.request(`/api/projects/${o}`,{method:"GET",authenticated:!0})}async createProject(o){P.info("Creating new project",{name:o.name});try{const i=await this.request("/api/projects",{method:"POST",authenticated:!0,body:JSON.stringify(o)});return P.info("Project created successfully",{id:i.project.id}),i}catch(i){throw P.error("Failed to create project",i),i}}async updateProject(o,i){P.info("Updating project",{id:o});try{const t=await this.request(`/api/projects/${o}`,{method:"PUT",authenticated:!0,body:JSON.stringify(i)});return P.info("Project updated successfully",{id:o}),t}catch(t){throw P.error("Failed to update project",{id:o,error:t}),t}}async deleteProject(o){P.info("Deleting project",{id:o});try{const i=await this.request(`/api/projects/${o}`,{method:"DELETE",authenticated:!0});return P.info("Project deleted successfully",{id:o}),i}catch(i){throw P.error("Failed to delete project",{id:o,error:i}),i}}async request(o,i){const t=`${this.baseUrl}${o}`,d={"Content-Type":"application/json"};i.authenticated&&this.token&&(d.Authorization=`Bearer ${this.token}`);try{const s=await fetch(t,{method:i.method,headers:d,body:i.body});if(!s.ok){if(s.status===401)throw P.warn("Unauthorized - clearing token"),this.clearToken(),window.dispatchEvent(new CustomEvent("auth:unauthorized")),new Error("Unauthorized");const n=await s.json().catch(()=>({}));throw new Error(n.message||`HTTP ${s.status}`)}return await s.json()}catch(s){throw P.error("Request failed",{endpoint:o,method:i.method,error:s}),s}}}const G=new bt,kt=()=>{const r=Ae(),[o,i]=w.useState(""),[t,d]=w.useState(!1),[s,n]=w.useState(null),c=h=>(h.replace(/[^A-Z0-9]/gi,"").toUpperCase().match(/.{1,4}/g)||[]).join("-").substring(0,19),a=h=>{const x=c(h.target.value);i(x),n(null)},l=async h=>{if(h.preventDefault(),o.length<19){n("–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π –∫–ª—é—á –ª–∏—Ü–µ–Ω–∑–∏–∏ (16 —Å–∏–º–≤–æ–ª–æ–≤)");return}d(!0),n(null);try{console.log("[LoginPage] Attempting login");const x=await G.loginWithLicense(o);console.log("[LoginPage] Login successful, redirecting to /editor"),r("/editor",{replace:!0})}catch(x){console.error("[LoginPage] Login failed:",x),n(x.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ö–æ–¥. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á –ª–∏—Ü–µ–Ω–∑–∏–∏."),d(!1)}},u=h=>{h.preventDefault();const x=h.clipboardData.getData("text"),m=c(x);i(m)};return e.jsx("div",{className:"login-page",children:e.jsxs("div",{className:"login-container",children:[e.jsxs("div",{className:"login-header",children:[e.jsx(me,{size:48,className:"login-icon"}),e.jsx("h1",{children:"Kiosk Editor"}),e.jsx("p",{children:"–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É"})]}),e.jsxs("form",{onSubmit:l,className:"login-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"licenseKey",children:"–ö–ª—é—á –ª–∏—Ü–µ–Ω–∑–∏–∏"}),e.jsx("input",{type:"text",id:"licenseKey",placeholder:"XXXX-XXXX-XXXX-XXXX",value:o,onChange:a,onPaste:u,disabled:t,autoFocus:!0,maxLength:19,className:s?"error":""}),e.jsx("span",{className:"input-hint",children:"–§–æ—Ä–º–∞—Ç: 4 –≥—Ä—É–ø–ø—ã –ø–æ 4 —Å–∏–º–≤–æ–ª–∞"})]}),s&&e.jsxs("div",{className:"error-message",children:[e.jsx(Te,{size:16}),e.jsx("span",{children:s})]}),e.jsx("button",{type:"submit",className:"login-button",disabled:t||o.length<19,children:t?e.jsxs(e.Fragment,{children:[e.jsx(We,{size:20,className:"spinner"}),e.jsx("span",{children:"–í—Ö–æ–¥..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{size:20}),e.jsx("span",{children:"–í–æ–π—Ç–∏"})]})})]}),e.jsxs("div",{className:"test-keys",children:[e.jsx("p",{children:"–¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"BASIC:"})," ",e.jsx("code",{children:"EWZA-E5LJ-Z558-9LUQ"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PRO:"})," ",e.jsx("code",{children:"3VBN-8ZQ9-1MKO-AK0R"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"MAX:"})," ",e.jsx("code",{children:"T8MH-FJE3-ETAC-YOZF"})]})]})]})]})})},St={},je=r=>{let o;const i=new Set,t=(u,h)=>{const x=typeof u=="function"?u(o):u;if(!Object.is(x,o)){const m=o;o=h??(typeof x!="object"||x===null)?x:Object.assign({},o,x),i.forEach(b=>b(o,m))}},d=()=>o,a={setState:t,getState:d,getInitialState:()=>l,subscribe:u=>(i.add(u),()=>i.delete(u)),destroy:()=>{(St?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),i.clear()}},l=o=r(t,d,a);return a},Ct=r=>r?je(r):je;var le={exports:{}},ce={},de={exports:{}},pe={};var ye;function Nt(){if(ye)return pe;ye=1;var r=ue();function o(h,x){return h===x&&(h!==0||1/h===1/x)||h!==h&&x!==x}var i=typeof Object.is=="function"?Object.is:o,t=r.useState,d=r.useEffect,s=r.useLayoutEffect,n=r.useDebugValue;function c(h,x){var m=x(),b=t({inst:{value:m,getSnapshot:x}}),j=b[0].inst,v=b[1];return s(function(){j.value=m,j.getSnapshot=x,a(j)&&v({inst:j})},[h,m,x]),d(function(){return a(j)&&v({inst:j}),h(function(){a(j)&&v({inst:j})})},[h]),n(m),m}function a(h){var x=h.getSnapshot;h=h.value;try{var m=x();return!i(h,m)}catch{return!0}}function l(h,x){return x()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:c;return pe.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:u,pe}var ve;function wt(){return ve||(ve=1,de.exports=Nt()),de.exports}var be;function zt(){if(be)return ce;be=1;var r=ue(),o=wt();function i(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var t=typeof Object.is=="function"?Object.is:i,d=o.useSyncExternalStore,s=r.useRef,n=r.useEffect,c=r.useMemo,a=r.useDebugValue;return ce.useSyncExternalStoreWithSelector=function(l,u,h,x,m){var b=s(null);if(b.current===null){var j={hasValue:!1,value:null};b.current=j}else j=b.current;b=c(function(){function k(L){if(!N){if(N=!0,E=L,L=x(L),m!==void 0&&j.hasValue){var p=j.value;if(m(p,L))return T=p}return T=L}if(p=T,t(E,L))return p;var y=x(L);return m!==void 0&&m(p,y)?(E=L,p):(E=L,T=y)}var N=!1,E,T,M=h===void 0?null:h;return[function(){return k(u())},M===null?void 0:function(){return k(M())}]},[u,h,x,m]);var v=d(l,b[0],b[1]);return n(function(){j.hasValue=!0,j.value=v},[v]),a(v),v},ce}var ke;function Et(){return ke||(ke=1,le.exports=zt()),le.exports}var Tt=Et();const Wt=Ee(Tt),Re={},{useDebugValue:Rt}=X,{useSyncExternalStoreWithSelector:It}=Wt;let Se=!1;const Pt=r=>r;function At(r,o=Pt,i){(Re?"production":void 0)!=="production"&&i&&!Se&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Se=!0);const t=It(r.subscribe,r.getState,r.getServerState||r.getInitialState,o,i);return Rt(t),t}const Ce=r=>{(Re?"production":void 0)!=="production"&&typeof r!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const o=typeof r=="function"?Ct(r):r,i=(t,d)=>At(o,t,d);return Object.assign(i,o),i},Lt=r=>r?Ce(r):Ce;let Q=null;function H(r,o=18e4){Q&&clearTimeout(Q),Q=setTimeout(async()=>{try{console.log("[Editor] Auto-saving project..."),await r(),console.log("[Editor] Auto-save completed")}catch(i){console.error("[Editor] Auto-save failed:",i)}},o)}function Ie(){Q&&(clearTimeout(Q),Q=null)}const U=Lt((r,o)=>({project:{version:"1.0.0",name:"–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç",canvas:{width:1920,height:1080,backgroundColor:"#1a1a1a"},widgets:[],metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},projectId:null,isLoading:!1,isSaving:!1,lastSaved:null,saveError:null,selectedWidgetIds:[],clipboard:[],history:{past:[],future:[]},zoom:1,gridEnabled:!0,snapToGrid:!0,gridSize:20,gridLineWidth:1,gridColor:"#e0e0e0",pendingWidget:null,createProject:async(i,t)=>{r({isLoading:!0,saveError:null});try{const d={version:"1.0",name:i,canvas:t,widgets:[],metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},s=await G.createProject({name:i,canvasWidth:t.width,canvasHeight:t.height,canvasBackground:t.backgroundColor||"#1a1a1a",projectData:d});r({project:{...d,id:s.project.id},projectId:s.project.id,isLoading:!1,lastSaved:new Date,history:{past:[],future:[]}}),console.log("[Editor] Project created:",s.project.id),H(o().saveProject)}catch(d){throw console.error("[Editor] Failed to create project:",d),r({isLoading:!1,saveError:d.message||"Failed to create project"}),d}},loadProject:async i=>{r({isLoading:!0,saveError:null});try{const t=await G.getProject(i),d={id:t.project.id,version:"1.0",name:t.project.name,canvas:{width:t.project.canvasWidth,height:t.project.canvasHeight,backgroundColor:t.project.canvasBackground},widgets:t.project.projectData?.widgets||[],metadata:{createdAt:t.project.createdAt,updatedAt:t.project.updatedAt}};r({project:d,projectId:t.project.id,isLoading:!1,lastSaved:new Date(t.project.updatedAt),history:{past:[],future:[]}}),console.log("[Editor] Project loaded:",i),H(o().saveProject)}catch(t){throw console.error("[Editor] Failed to load project:",t),r({isLoading:!1,saveError:t.message||"Failed to load project"}),t}},saveProject:async()=>{const{project:i,projectId:t,isSaving:d}=o();if(!i||!t){console.warn("[Editor] No project to save");return}if(d){console.warn("[Editor] Save already in progress");return}r({isSaving:!0,saveError:null});try{await G.updateProject(t,{name:i.name,projectData:i,canvasWidth:i.canvas.width,canvasHeight:i.canvas.height,canvasBackground:i.canvas.backgroundColor}),r({isSaving:!1,lastSaved:new Date,saveError:null}),console.log("[Editor] Project saved:",t)}catch(s){throw console.error("[Editor] Failed to save project:",s),r({isSaving:!1,saveError:s.message||"Failed to save project"}),s}},deleteProject:async i=>{try{await G.deleteProject(i),o().projectId===i&&(r({project:{version:"1.0.0",name:"–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç",canvas:{width:1920,height:1080,backgroundColor:"#1a1a1a"},widgets:[],metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},projectId:null,selectedWidgetIds:[],history:{past:[],future:[]}}),Ie()),console.log("[Editor] Project deleted:",i)}catch(t){throw console.error("[Editor] Failed to delete project:",t),t}},updateProjectMetadata:i=>{const{project:t}=o();t&&(r({project:{...t,...i,metadata:{...t.metadata,updatedAt:new Date().toISOString()}}}),H(o().saveProject))},addWidget:i=>{const{project:t}=o();t&&(o().saveToHistory(),r({project:{...t,widgets:[...t.widgets,i],metadata:{...t.metadata,updatedAt:new Date().toISOString()}}}),H(o().saveProject))},setPendingWidget:(i,t)=>{r({pendingWidget:{type:i,defaultProps:t}})},clearPendingWidget:()=>{r({pendingWidget:null})},addWidgetAtPosition:(i,t)=>{const{pendingWidget:d,project:s,snapToGrid:n,gridSize:c}=o();if(!d||!s)return;let a=i,l=t;n&&(a=Math.round(i/c)*c,l=Math.round(t/c)*c);const h={shape:{width:200,height:200},button:{width:200,height:60},text:{width:300,height:100},image:{width:300,height:200},video:{width:640,height:360},menu:{width:600,height:40}}[d.type]||{width:200,height:100},x=d.defaultProps.width||h.width,m=d.defaultProps.height||h.height;a=a-x/2,l=l-m/2;const{width:b,height:j,...v}=d.defaultProps,k={id:`widget-${Date.now()}-${Math.random()}`,type:d.type,x:Math.max(0,a),y:Math.max(0,l),width:x,height:m,zIndex:0,properties:v};o().addWidget(k),o().clearPendingWidget()},updateWidget:(i,t)=>{const{project:d}=o();d&&(r({project:{...d,widgets:d.widgets.map(s=>s.id===i?{...s,...t}:s),metadata:{...d.metadata,updatedAt:new Date().toISOString()}}}),H(o().saveProject))},deleteWidget:i=>{const{project:t}=o();t&&(o().saveToHistory(),r({project:{...t,widgets:t.widgets.filter(d=>d.id!==i),metadata:{...t.metadata,updatedAt:new Date().toISOString()}},selectedWidgetIds:o().selectedWidgetIds.filter(d=>d!==i)}),H(o().saveProject))},duplicateWidget:i=>{const{project:t}=o();if(!t)return;const d=t.widgets.find(n=>n.id===i);if(!d)return;const s={...d,id:`widget-${Date.now()}`,x:d.x+20,y:d.y+20};o().addWidget(s)},selectWidget:(i,t=!1)=>{const{selectedWidgetIds:d}=o();t?d.includes(i)?r({selectedWidgetIds:d.filter(s=>s!==i)}):r({selectedWidgetIds:[...d,i]}):r({selectedWidgetIds:[i]})},clearSelection:()=>{r({selectedWidgetIds:[]})},saveToHistory:()=>{const{project:i,history:t}=o();i&&r({history:{past:[...t.past,i],future:[]}})},undo:()=>{const{history:i,project:t}=o();if(i.past.length===0||!t)return;const d=i.past[i.past.length-1],s=i.past.slice(0,-1);r({project:d,history:{past:s,future:[t,...i.future]}}),H(o().saveProject)},redo:()=>{const{history:i,project:t}=o();if(i.future.length===0||!t)return;const d=i.future[0],s=i.future.slice(1);r({project:d,history:{past:[...i.past,t],future:s}}),H(o().saveProject)},copy:()=>{const{project:i,selectedWidgetIds:t}=o();if(!i)return;const d=i.widgets.filter(s=>t.includes(s.id));r({clipboard:d})},paste:()=>{const{clipboard:i,project:t}=o();if(!t||i.length===0)return;const d=i.map(s=>({...s,id:`widget-${Date.now()}-${Math.random()}`,x:s.x+20,y:s.y+20}));o().saveToHistory(),r({project:{...t,widgets:[...t.widgets,...d]},selectedWidgetIds:d.map(s=>s.id)}),H(o().saveProject)},cut:()=>{const{selectedWidgetIds:i}=o();o().copy(),i.forEach(t=>o().deleteWidget(t))},setZoom:i=>{r({zoom:Math.max(.1,Math.min(5,i))})},toggleGrid:()=>{r(i=>({gridEnabled:!i.gridEnabled}))},toggleSnapToGrid:()=>{r(i=>({snapToGrid:!i.snapToGrid}))},setGridSize:i=>{r({gridSize:Math.max(5,Math.min(100,i))})}}));typeof window<"u"&&window.addEventListener("beforeunload",()=>{Ie()});const Ft=()=>{const{isSaving:r,lastSaved:o,saveError:i}=U(),d=i?"error":r?"saving":o?"saved":"idle",s=c=>{const l=new Date().getTime()-c.getTime(),u=Math.floor(l/1e3),h=Math.floor(u/60);return u<10?"–¢–æ–ª—å–∫–æ —á—Ç–æ":u<60?`${u} —Å–µ–∫ –Ω–∞–∑–∞–¥`:h===1?"1 –º–∏–Ω –Ω–∞–∑–∞–¥":h<60?`${h} –º–∏–Ω –Ω–∞–∑–∞–¥`:c.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})},n=()=>{switch(d){case"saving":return e.jsxs(e.Fragment,{children:[e.jsx(We,{size:16,className:"spinner"}),e.jsx("span",{children:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ..."})]});case"saved":return e.jsxs(e.Fragment,{children:[e.jsx(Je,{size:16}),e.jsxs("span",{children:["–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ",o&&s(o)]})]});case"error":return e.jsxs(e.Fragment,{children:[e.jsx(Te,{size:16}),e.jsx("span",{title:i||void 0,children:"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è"})]});default:return e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:16}),e.jsx("span",{children:"–ù–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ"})]})}};return e.jsx("div",{className:`autosave-indicator status-${d}`,children:n()})},Mt=()=>{const{project:r,history:o,zoom:i,gridEnabled:t,snapToGrid:d,undo:s,redo:n,setZoom:c,toggleGrid:a,toggleSnapToGrid:l,saveProject:u}=U(),[h,x]=w.useState(null),[m,b]=w.useState(null);w.useEffect(()=>{const T=G.getOrganizationData();x(T.name),b(T.plan)},[]);const j=()=>{c(Math.min(i+.1,3))},v=()=>{c(Math.max(i-.1,.1))},k=()=>{confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?")&&(P.info("User initiated logout"),G.logout(),window.location.href="/login")},N=o.past.length>0,E=o.future.length>0;return e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-section",children:[e.jsx("div",{className:"toolbar-logo",children:e.jsx("span",{className:"logo-text",children:"Kiosk Editor"})}),e.jsx("div",{className:"toolbar-divider"}),e.jsx("button",{className:"toolbar-btn",onClick:()=>u(),disabled:!r,title:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å (Ctrl+S)",children:e.jsx(dt,{size:18})}),e.jsx("button",{className:"toolbar-btn",disabled:!r,title:"–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç",children:e.jsx(et,{size:18})}),e.jsx("div",{className:"toolbar-divider"}),e.jsx("button",{className:"toolbar-btn",onClick:s,disabled:!N,title:"–û—Ç–º–µ–Ω–∏—Ç—å (Ctrl+Z)",children:e.jsx(xt,{size:18})}),e.jsx("button",{className:"toolbar-btn",onClick:n,disabled:!E,title:"–í–µ—Ä–Ω—É—Ç—å (Ctrl+Shift+Z)",children:e.jsx(ct,{size:18})}),e.jsx("div",{className:"toolbar-divider"}),e.jsx("button",{className:"toolbar-btn",onClick:v,disabled:i<=.1,title:"–£–º–µ–Ω—å—à–∏—Ç—å (Ctrl+-)",children:e.jsx(yt,{size:18})}),e.jsxs("span",{className:"toolbar-zoom",children:[Math.round(i*100),"%"]}),e.jsx("button",{className:"toolbar-btn",onClick:j,disabled:i>=3,title:"–£–≤–µ–ª–∏—á–∏—Ç—å (Ctrl++)",children:e.jsx(jt,{size:18})}),e.jsx("div",{className:"toolbar-divider"}),e.jsx("button",{className:`toolbar-btn ${t?"active":""}`,onClick:a,title:"–ü–æ–∫–∞–∑–∞—Ç—å —Å–µ—Ç–∫—É",children:e.jsx(tt,{size:18})}),e.jsx("button",{className:`toolbar-btn ${d?"active":""}`,onClick:l,title:"–ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Å–µ—Ç–∫–µ",children:e.jsx(st,{size:18})})]}),e.jsxs("div",{className:"toolbar-section",children:[r&&e.jsx(Ft,{}),e.jsx("div",{className:"toolbar-divider"}),h&&e.jsxs("div",{className:"toolbar-user-info",children:[e.jsx(gt,{size:16}),e.jsx("span",{className:"user-org",children:h}),m&&e.jsx("span",{className:"user-plan",children:m})]}),e.jsx("button",{className:"toolbar-btn logout-btn",onClick:k,title:"–í—ã–π—Ç–∏",children:e.jsx(it,{size:18})}),e.jsx("div",{className:"toolbar-divider"}),e.jsxs("button",{className:"toolbar-btn preview-btn",disabled:!r,title:"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä",children:[e.jsx(lt,{size:18}),e.jsx("span",{children:"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä"})]})]})]})},Dt=({widget:r,isSelected:o,onSelect:i,onDragEnd:t,onTransformEnd:d,dragBoundFunc:s})=>{const n=w.useRef(null),c=w.useRef(null),{text:a="Button",backgroundColor:l="#2ecc71",textColor:u="#ffffff",fontSize:h=16,fontFamily:x="Arial",fontWeight:m="normal",fontStyle:b="normal",textAlign:j="center",borderRadius:v=8,borderWidth:k=0,borderColor:N="#000000",borderStyle:E="solid",paddingX:T=16,paddingY:M=8,shadowEnabled:L=!1,shadowColor:p="#000000",shadowBlur:y=10,shadowOffsetX:f=0,shadowOffsetY:z=4,shadowOpacity:B=.3}=r.properties,q=r.locked||!1,I=()=>{switch(E){case"dashed":return[10,5];case"dotted":return[3,3];default:return[]}};return e.jsxs(ee,{ref:n,id:r.id,x:r.x,y:r.y,width:r.width,height:r.height,rotation:r.rotation||0,draggable:!q,dragBoundFunc:s,opacity:q?.6:1,onClick:i,onTap:i,onDragEnd:t,onTransformEnd:d,children:[L&&e.jsx(C,{x:f,y:z,width:r.width,height:r.height,cornerRadius:v,fill:p,opacity:B,blur:y,listening:!1}),e.jsx(C,{width:r.width,height:r.height,fill:l,cornerRadius:v,stroke:k>0?N:void 0,strokeWidth:k,dash:I(),listening:!1}),e.jsx(F,{ref:c,text:a,x:T,y:0,width:r.width-T*2,height:r.height,fontSize:h,fontFamily:x,fontStyle:m==="bold"?"bold":b,fill:u,align:j,verticalAlign:"middle",listening:!1}),e.jsx(C,{width:r.width,height:r.height,fill:"transparent",listening:!0}),o&&e.jsx(C,{width:r.width,height:r.height,stroke:"#007acc",strokeWidth:2,cornerRadius:v,listening:!1})]})},Ot=({widget:r,isSelected:o,onSelect:i,onDragEnd:t,onTransformEnd:d,dragBoundFunc:s})=>{const n=w.useRef(null),{text:c="Text",fontSize:a=16,fontFamily:l="Arial",fontWeight:u="normal",fontStyle:h="normal",textAlign:x="left",verticalAlign:m="top",textColor:b="#000000",backgroundColor:j="#ffffff",lineHeight:v=1.2,padding:k=8,textDecoration:N="none"}=r.properties,E=r.locked||!1,T=()=>N==="underline"?"underline":N==="line-through"?"line-through":"";return e.jsxs(ee,{ref:n,id:r.id,x:r.x,y:r.y,width:r.width,height:r.height,rotation:r.rotation||0,draggable:!E,dragBoundFunc:s,opacity:E?.6:1,onClick:i,onTap:i,onDragEnd:t,onTransformEnd:d,children:[j!=="transparent"&&e.jsx(C,{width:r.width,height:r.height,fill:j,listening:!1}),e.jsx(F,{text:c,x:k,y:k,width:r.width-k*2,height:r.height-k*2,fontSize:a,fontFamily:l,fontStyle:u==="bold"?"bold":h,fill:b,align:x,verticalAlign:m,lineHeight:v,textDecoration:T(),listening:!1}),e.jsx(C,{width:r.width,height:r.height,fill:"transparent",listening:!0}),o&&e.jsx(C,{width:r.width,height:r.height,stroke:"#007acc",strokeWidth:2,listening:!1})]})},_t=({widget:r,isSelected:o,onSelect:i,onDragEnd:t,onTransformEnd:d,dragBoundFunc:s})=>{const n=w.useRef(null),[c,a]=w.useState(0),{sources:l=[],autoNext:u=!0,loop:h=!0}=r.properties,x=r.locked||!1;return l[c],e.jsxs(ee,{ref:n,id:r.id,x:r.x,y:r.y,width:r.width,height:r.height,rotation:r.rotation||0,draggable:!x,dragBoundFunc:s,opacity:x?.6:1,onClick:i,onTap:i,onDragEnd:t,onTransformEnd:d,children:[e.jsx(C,{width:r.width,height:r.height,fill:"transparent",listening:!0}),e.jsx(C,{width:r.width,height:r.height,fill:"#000000",listening:!1}),e.jsx(F,{x:r.width/2,y:r.height/2-30,text:"‚ñ∂",fontSize:60,fill:"#ffffff",align:"center",width:r.width,offsetX:r.width/2,listening:!1}),e.jsx(F,{x:0,y:r.height/2+40,text:"PLAYLIST",fontSize:16,fill:"#ffffff",align:"center",width:r.width,listening:!1}),o&&e.jsx(C,{width:r.width,height:r.height,stroke:"#007acc",strokeWidth:2,listening:!1}),l.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(C,{x:r.width-50,y:r.height-25,width:45,height:20,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:4,listening:!1}),e.jsx(F,{x:r.width-48,y:r.height-21,text:`üé¨ ${l.length}`,fontSize:12,fill:"#ffffff",listening:!1})]})]})},$t=({widget:r,isSelected:o,onSelect:i,onDragEnd:t,onTransformEnd:d,dragBoundFunc:s})=>{if(r.properties.playlistMode)return e.jsx(_t,{widget:r,isSelected:o,onSelect:i,onDragEnd:t,onTransformEnd:d,dragBoundFunc:s});const n=w.useRef(null),c=w.useRef(null),[a,l]=w.useState(null),u=w.useRef(),{sourceType:h="url",src:x="",rtspUrl:m="",isLocalFile:b=!1,fileName:j="",objectFit:v="contain",borderEnabled:k=!1,borderStyle:N="solid",borderWidth:E=2,borderColor:T="#000000",autoplay:M=!1,loop:L=!1,muted:p=!0,controls:y=!1}=r.properties;w.useEffect(()=>{const g=document.createElement("video");return g.crossOrigin="anonymous",g.loop=L,g.muted=p,g.playsInline=!0,h==="url"&&x?(g.src=x,g.onloadedmetadata=()=>{l(g),M&&g.play().catch(S=>{console.log("Autoplay prevented:",S)})},g.onerror=()=>{console.error("Failed to load video:",x),l(null)}):l(null),c.current=g,()=>{u.current&&cancelAnimationFrame(u.current),g.pause(),g.src="",g.load()}},[x,h,M,L,p]),w.useEffect(()=>{if(!a)return;const g=()=>{const S=n.current?.getLayer();S&&S.batchDraw(),u.current=requestAnimationFrame(g)};return u.current=requestAnimationFrame(g),()=>{u.current&&cancelAnimationFrame(u.current)}},[a]),w.useEffect(()=>{if(v!=="adaptive"||!a)return;const{updateWidget:g}=U.getState(),S=a.videoWidth/a.videoHeight||16/9,O=r.width/r.height;if(Math.abs(S-O)>.01){const _=r.width/S;g(r.id,{height:Math.round(_)})}},[v,a,r.width,r.height,r.id]);const z=(()=>{if(!a||a.videoWidth===0)return null;const{width:g,height:S}=r,O=a.videoWidth/a.videoHeight,_=g/S;let $=0,D=0,J=a.videoWidth,V=a.videoHeight,K=0,ne=0,Z=g,Y=S;switch(v){case"cover":{O>_?(J=a.videoHeight*_,$=(a.videoWidth-J)/2):(V=a.videoWidth/_,D=(a.videoHeight-V)/2);break}case"contain":{O>_?(Y=g/O,ne=(S-Y)/2):(Z=S*O,K=(g-Z)/2);break}case"scale-down":{a.videoWidth<=g&&a.videoHeight<=S?(Z=a.videoWidth,Y=a.videoHeight,K=(g-Z)/2,ne=(S-Y)/2):O>_?(Y=g/O,ne=(S-Y)/2):(Z=S*O,K=(g-Z)/2);break}}return{crop:{x:$,y:D,width:J,height:V},position:{x:K,y:ne,width:Z,height:Y}}})(),B=g=>{switch(g){case"dashed":return[10,5];case"dotted":return[2,2];case"double":return[];default:return[]}},q=g=>{n.current&&d(g)},I=g=>{i(g),y&&a&&(a.paused?a.play():a.pause())},R=r.locked||!1,W=()=>h==="rtsp"&&m?`üìπ RTSP
${m.substring(0,30)}...`:h==="url"&&x?b&&j?`üìÅ ${j}`:`üé• –í–∏–¥–µ–æ
${x.substring(0,30)}...`:`üé• –í–∏–¥–µ–æ
–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏`;return e.jsxs(ee,{ref:n,id:r.id,x:r.x,y:r.y,width:r.width,height:r.height,rotation:r.rotation||0,draggable:!R,dragBoundFunc:s,opacity:R?.6:1,onClick:I,onTap:I,onDragEnd:t,onTransformEnd:q,children:[e.jsx(C,{width:r.width,height:r.height,fill:"transparent",listening:!0}),e.jsx(C,{width:r.width,height:r.height,fill:h==="rtsp"?"#2c3e50":"#f39c12",listening:!1}),a&&z?e.jsx(Me,{image:a,x:z.position.x,y:z.position.y,width:z.position.width,height:z.position.height,crop:z.crop,listening:!1}):e.jsx(F,{text:W(),x:0,y:0,width:r.width,height:r.height,fontSize:14,fontFamily:"Arial",fill:"#ffffff",align:"center",verticalAlign:"middle",listening:!1}),h==="rtsp"&&e.jsx(C,{x:10,y:10,width:45,height:20,fill:"#ff0000",cornerRadius:4,listening:!1}),h==="rtsp"&&e.jsx(F,{text:"LIVE",x:10,y:13,width:45,fontSize:12,fontFamily:"Arial",fontWeight:"bold",fill:"#ffffff",align:"center",listening:!1}),a&&!a.paused&&e.jsx(F,{text:"‚ñ∂",x:r.width-30,y:10,fontSize:16,fontFamily:"Arial",fill:"#00ff00",listening:!1}),y&&a&&e.jsx(F,{text:a.paused?"‚è∏ –ü–∞—É–∑–∞":"‚ñ∂ –ò–≥—Ä–∞–µ—Ç",x:10,y:r.height-30,fontSize:12,fontFamily:"Arial",fill:"#ffffff",listening:!1}),o&&e.jsx(C,{width:r.width,height:r.height,stroke:"#007acc",strokeWidth:2,listening:!1}),k&&e.jsx(C,{width:r.width,height:r.height,stroke:T,strokeWidth:E,dash:B(N),listening:!1})]})},Bt=({widget:r,isSelected:o,onSelect:i,onDragEnd:t,onTransformEnd:d,dragBoundFunc:s})=>{const n=w.useRef(null),{shapeType:c="rectangle",fillColor:a="#4a90e2",strokeColor:l="#2c3e50",strokeWidth:u=0,cornerRadius:h=0,opacity:x=1}=r.properties,m=r.locked||!1,b=()=>{const j={fill:a,stroke:u>0?l:void 0,strokeWidth:u,opacity:x,listening:!1};switch(c){case"rectangle":return e.jsx(C,{x:0,y:0,width:r.width,height:r.height,cornerRadius:h,...j});case"circle":const v=Math.min(r.width,r.height)/2;return e.jsx(_e,{x:r.width/2,y:r.height/2,radius:v,...j});case"ellipse":return e.jsx(Oe,{x:r.width/2,y:r.height/2,radiusX:r.width/2,radiusY:r.height/2,...j});case"triangle":return e.jsx(se,{x:r.width/2,y:r.height/2,sides:3,radius:Math.min(r.width,r.height)/2,...j});case"pentagon":return e.jsx(se,{x:r.width/2,y:r.height/2,sides:5,radius:Math.min(r.width,r.height)/2,...j});case"hexagon":return e.jsx(se,{x:r.width/2,y:r.height/2,sides:6,radius:Math.min(r.width,r.height)/2,...j});case"star":return e.jsx(De,{x:r.width/2,y:r.height/2,numPoints:5,innerRadius:Math.min(r.width,r.height)/4,outerRadius:Math.min(r.width,r.height)/2,...j});case"diamond":return e.jsx(se,{x:r.width/2,y:r.height/2,sides:4,radius:Math.min(r.width,r.height)/2,rotation:45,...j});case"line":return e.jsx(re,{points:[0,r.height/2,r.width,r.height/2],stroke:l,strokeWidth:Math.max(u,2),opacity:x,listening:!1});case"arrow":const k=r.width,N=r.height,E=N*.6,T=N*.4;return e.jsx(re,{points:[0,N/2-T/2,k-E,N/2-T/2,k-E,0,k,N/2,k-E,N,k-E,N/2+T/2,0,N/2+T/2],closed:!0,fill:a,stroke:u>0?l:void 0,strokeWidth:u,opacity:x,listening:!1});default:return e.jsx(C,{x:0,y:0,width:r.width,height:r.height,...j})}};return e.jsxs(ee,{ref:n,id:r.id,x:r.x,y:r.y,width:r.width,height:r.height,rotation:r.rotation||0,draggable:!m,dragBoundFunc:s,opacity:m?.6:1,onClick:i,onTap:i,onDragEnd:t,onTransformEnd:d,children:[e.jsx(C,{width:r.width,height:r.height,fill:"transparent",listening:!0}),b(),o&&e.jsx(C,{width:r.width,height:r.height,stroke:"#007acc",strokeWidth:2,listening:!1})]})},Ht=({widget:r,isSelected:o,onSelect:i,onDragEnd:t,onTransformEnd:d,dragBoundFunc:s})=>{const n=w.useRef(null),[c,a]=w.useState(null),[l,u]=w.useState(null),{orientation:h="horizontal",items:x=[{id:"1",label:"–ì–ª–∞–≤–Ω–∞—è"},{id:"2",label:"–û –Ω–∞—Å"},{id:"3",label:"–£—Å–ª—É–≥–∏",children:[{id:"3-1",label:"–£—Å–ª—É–≥–∞ 1"},{id:"3-2",label:"–£—Å–ª—É–≥–∞ 2"}]},{id:"4",label:"–ö–æ–Ω—Ç–∞–∫—Ç—ã"}],backgroundColor:m="#2c3e50",textColor:b="#ffffff",hoverColor:j="#34495e",fontSize:v=16,fontFamily:k="Arial",itemPadding:N=16,submenuBackgroundColor:E="#34495e",submenuTextColor:T="#ffffff",borderWidth:M=0,borderColor:L="#000000",itemHeight:p=40}=r.properties,y=r.locked||!1,f=h==="horizontal",z=I=>I.length*(v*.6)+N*2,B=()=>{const I=[];let R=0;return x.forEach((W,g)=>{const S=z(W.label),O=c===W.id,_=l===W.id,$=W.children&&W.children.length>0;I.push(e.jsx(C,{x:R,y:0,width:S,height:p,fill:O?j:m,listening:!0,onMouseEnter:()=>a(W.id),onMouseLeave:()=>a(null),onClick:()=>{$&&u(l===W.id?null:W.id)}},`bg-${W.id}`)),I.push(e.jsx(F,{x:R,y:0,width:S,height:p,text:W.label,fontSize:v,fontFamily:k,fill:b,align:"center",verticalAlign:"middle",listening:!1},`text-${W.id}`)),$&&I.push(e.jsx(F,{x:R+S-20,y:0,width:20,height:p,text:"‚ñº",fontSize:10,fill:b,align:"center",verticalAlign:"middle",listening:!1},`arrow-${W.id}`)),g<x.length-1&&I.push(e.jsx(re,{points:[R+S,5,R+S,p-5],stroke:L,strokeWidth:1,opacity:.3,listening:!1},`divider-${W.id}`)),_&&$&&W.children.forEach((D,J)=>{const V=p+J*p,K=Math.max(S,z(D.label));I.push(e.jsx(C,{x:R,y:V,width:K,height:p,fill:E,listening:!0,onMouseEnter:()=>a(D.id),onMouseLeave:()=>a(null)},`submenu-bg-${D.id}`)),I.push(e.jsx(F,{x:R+N/2,y:V,width:K-N/2,height:p,text:D.label,fontSize:v-2,fontFamily:k,fill:T,align:"left",verticalAlign:"middle",listening:!1},`submenu-text-${D.id}`))}),R+=S}),I},q=()=>{const I=[];let R=0;const W=r.width;return x.forEach((g,S)=>{const O=c===g.id,_=l===g.id,$=g.children&&g.children.length>0;I.push(e.jsx(C,{x:0,y:R,width:W,height:p,fill:O?j:m,listening:!0,onMouseEnter:()=>a(g.id),onMouseLeave:()=>a(null),onClick:()=>{$&&u(l===g.id?null:g.id)}},`bg-${g.id}`)),I.push(e.jsx(F,{x:N,y:R,width:W-N*2-($?20:0),height:p,text:g.label,fontSize:v,fontFamily:k,fill:b,align:"left",verticalAlign:"middle",listening:!1},`text-${g.id}`)),$&&I.push(e.jsx(F,{x:W-20,y:R,width:20,height:p,text:_?"‚ñº":"‚ñ∂",fontSize:10,fill:b,align:"center",verticalAlign:"middle",listening:!1},`arrow-${g.id}`)),R+=p,S<x.length-1&&!_&&I.push(e.jsx(re,{points:[10,R,W-10,R],stroke:L,strokeWidth:1,opacity:.3,listening:!1},`divider-${g.id}`)),_&&$&&(g.children.forEach((D,J)=>{const V=c===D.id;I.push(e.jsx(C,{x:0,y:R,width:W,height:p,fill:V?j:E,listening:!0,onMouseEnter:()=>a(D.id),onMouseLeave:()=>a(null)},`submenu-bg-${D.id}`)),I.push(e.jsx(F,{x:N*2,y:R,width:W-N*3,height:p,text:D.label,fontSize:v-2,fontFamily:k,fill:T,align:"left",verticalAlign:"middle",listening:!1},`submenu-text-${D.id}`)),R+=p}),S<x.length-1&&I.push(e.jsx(re,{points:[10,R,W-10,R],stroke:L,strokeWidth:1,opacity:.3,listening:!1},`divider-after-${g.id}`)))}),I};return e.jsxs(ee,{ref:n,id:r.id,x:r.x,y:r.y,width:r.width,height:r.height,rotation:r.rotation||0,draggable:!y,dragBoundFunc:s,opacity:y?.6:1,onClick:i,onTap:i,onDragEnd:t,onTransformEnd:d,children:[e.jsx(C,{width:r.width,height:r.height,fill:"transparent",listening:!0}),e.jsx(C,{width:r.width,height:r.height,fill:m,listening:!1}),M>0&&e.jsx(C,{width:r.width,height:r.height,stroke:L,strokeWidth:M,listening:!1}),f?B():q(),o&&e.jsx(C,{width:r.width,height:r.height,stroke:"#007acc",strokeWidth:2,listening:!1})]})},Ut={shape:"#4a90e2",rectangle:"#4a90e2",button:"#2ecc71",text:"#e74c3c",image:"#9b59b6",video:"#f39c12"},qt=()=>{const{project:r,selectedWidgetIds:o,selectWidget:i,clearSelection:t,updateWidget:d,zoom:s,gridEnabled:n,snapToGrid:c,gridSize:a,gridLineWidth:l,gridColor:u,pendingWidget:h,addWidgetAtPosition:x,clearPendingWidget:m}=U(),b=w.useRef(null),j=w.useRef(null),v=p=>c?Math.round(p/a)*a:p,k=p=>({x:v(p.x),y:v(p.y)});w.useEffect(()=>{if(!j.current||!r)return;const p=b.current,y=o.map(f=>r.widgets.find(B=>B.id===f)?.locked?null:p.findOne(`#${f}`)).filter(Boolean);j.current.nodes(y),j.current.getLayer().batchDraw()},[o,r]);const N=p=>{if(h){const z=p.target.getStage().getPointerPosition();z&&x(z.x,z.y);return}(p.target===p.target.getStage()||p.target.attrs.id==="canvas-background")&&t()},E=(p,y)=>{y.cancelBubble=!0;const f=y.evt.ctrlKey||y.evt.metaKey;i(p,f)},T=(p,y)=>{const f=v(y.target.x()),z=v(y.target.y());d(p,{x:f,y:z})},M=(p,y)=>{const f=y.target,z=f.scaleX(),B=f.scaleY();f.scaleX(1),f.scaleY(1);const q=f.width?f.width():f.attrs.width||100,I=f.height?f.height():f.attrs.height||100;let R=Math.max(10,q*z),W=Math.max(10,I*B),g=f.x(),S=f.y();c&&(R=v(R),W=v(W),g=v(g),S=v(S)),d(p,{x:g,y:S,width:R,height:W,rotation:f.rotation()})},L=()=>{if(!n)return null;const p=[],{width:y,height:f}=r.canvas;for(let z=0;z<=y/a;z++)p.push(e.jsx(C,{x:z*a,y:0,width:l,height:f,fill:u},`v-${z}`));for(let z=0;z<=f/a;z++)p.push(e.jsx(C,{x:0,y:z*a,width:y,height:l,fill:u},`h-${z}`));return p};return e.jsxs("div",{className:"canvas-container",children:[e.jsx("div",{className:"canvas-scroll",children:e.jsx("div",{className:"canvas-wrapper",style:{transform:`scale(${s})`,transformOrigin:"top left",cursor:h?"crosshair":"default"},children:e.jsx($e,{ref:b,width:r.canvas.width,height:r.canvas.height,onClick:N,onTap:N,children:e.jsxs(Be,{children:[e.jsx(C,{id:"canvas-background",x:0,y:0,width:r.canvas.width,height:r.canvas.height,fill:r.canvas.backgroundColor||"#ffffff"}),L(),r.widgets.slice().sort((p,y)=>(p.zIndex||0)-(y.zIndex||0)).map(p=>{const y=p.locked||!1;return p.type==="image"?null:p.type==="button"?e.jsxs(X.Fragment,{children:[e.jsx(Dt,{widget:p,isSelected:o.includes(p.id),onSelect:f=>E(p.id,f),onDragEnd:f=>T(p.id,f),onTransformEnd:f=>M(p.id,f),dragBoundFunc:c?k:void 0}),y&&e.jsx(F,{x:p.x+5,y:p.y+5,text:"üîí",fontSize:16,listening:!1})]},p.id):p.type==="text"?e.jsxs(X.Fragment,{children:[e.jsx(Ot,{widget:p,isSelected:o.includes(p.id),onSelect:f=>E(p.id,f),onDragEnd:f=>T(p.id,f),onTransformEnd:f=>M(p.id,f),dragBoundFunc:c?k:void 0}),y&&e.jsx(F,{x:p.x+5,y:p.y+5,text:"üîí",fontSize:16,listening:!1})]},p.id):p.type==="video"?e.jsxs(X.Fragment,{children:[e.jsx($t,{widget:p,isSelected:o.includes(p.id),onSelect:f=>E(p.id,f),onDragEnd:f=>T(p.id,f),onTransformEnd:f=>M(p.id,f),dragBoundFunc:c?k:void 0}),y&&e.jsx(F,{x:p.x+5,y:p.y+5,text:"üîí",fontSize:16,listening:!1})]},p.id):p.type==="shape"||p.type==="rectangle"?e.jsxs(X.Fragment,{children:[e.jsx(Bt,{widget:p,isSelected:o.includes(p.id),onSelect:f=>E(p.id,f),onDragEnd:f=>T(p.id,f),onTransformEnd:f=>M(p.id,f),dragBoundFunc:c?k:void 0}),y&&e.jsx(F,{x:p.x+5,y:p.y+5,text:"üîí",fontSize:16,listening:!1})]},p.id):p.type==="menu"?e.jsxs(X.Fragment,{children:[e.jsx(Ht,{widget:p,isSelected:o.includes(p.id),onSelect:f=>E(p.id,f),onDragEnd:f=>T(p.id,f),onTransformEnd:f=>M(p.id,f),dragBoundFunc:c?k:void 0}),y&&e.jsx(F,{x:p.x+5,y:p.y+5,text:"üîí",fontSize:16,listening:!1})]},p.id):e.jsxs(X.Fragment,{children:[e.jsx(C,{id:p.id,x:p.x,y:p.y,width:p.width,height:p.height,rotation:p.rotation||0,fill:Ut[p.type]||"#4a90e2",stroke:o.includes(p.id)?"#007acc":void 0,strokeWidth:o.includes(p.id)?2:0,opacity:y?.6:1,draggable:!y,onClick:f=>E(p.id,f),onTap:f=>E(p.id,f),onDragEnd:f=>T(p.id,f),onTransformEnd:f=>M(p.id,f)}),y&&e.jsx(F,{x:p.x+5,y:p.y+5,text:"üîí",fontSize:16,listening:!1})]},p.id)}),e.jsx(He,{ref:j,boundBoxFunc:(p,y)=>y.width<10||y.height<10?p:y})]})})})}),e.jsxs("div",{className:"canvas-info",children:[e.jsxs("span",{children:[r.canvas.width," √ó ",r.canvas.height," px"]}),o.length>0&&e.jsxs("span",{children:["–í—ã–±—Ä–∞–Ω–æ: ",o.length]})]})]})},Vt=()=>{const{project:r,selectedWidgetIds:o,selectWidget:i,updateWidget:t,deleteWidget:d}=U();if(!r)return null;const s=a=>({shape:"üî∑",rectangle:"üî∑",text:"üìù",button:"üîò",image:"üñºÔ∏è",video:"üé¨",menu:"üçî"})[a]||"‚¨ú",n=a=>{if(a.properties.text){const l=a.properties.text.substring(0,20);return l.length<a.properties.text.length?`${l}...`:l}return a.properties.items?`–ú–µ–Ω—é (${a.properties.items.length} –ø—É–Ω–∫—Ç–æ–≤)`:a.type.charAt(0).toUpperCase()+a.type.slice(1)},c=[...r.widgets].sort((a,l)=>(l.zIndex||0)-(a.zIndex||0));return e.jsxs("div",{className:"outline-panel",children:[e.jsxs("div",{className:"outline-header",children:[e.jsx("h3",{children:"–°—Ç—Ä—É–∫—Ç—É—Ä–∞"}),e.jsxs("span",{className:"outline-count",children:[r.widgets.length," –≤–∏–¥–∂–µ—Ç–æ–≤"]})]}),e.jsx("div",{className:"outline-list",children:c.length===0?e.jsxs("div",{className:"outline-empty",children:[e.jsx("p",{children:"–ù–µ—Ç –≤–∏–¥–∂–µ—Ç–æ–≤"}),e.jsx("span",{children:"–î–æ–±–∞–≤—å—Ç–µ –≤–∏–¥–∂–µ—Ç—ã –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏"})]}):c.map(a=>{const l=o.includes(a.id),u=a.locked||!1;return e.jsxs("div",{className:`outline-item ${l?"selected":""} ${u?"locked":""}`,onClick:()=>i(a.id,!1),children:[e.jsxs("div",{className:"outline-item-main",children:[e.jsx("span",{className:"outline-icon",children:s(a.type)}),e.jsxs("div",{className:"outline-info",children:[e.jsx("span",{className:"outline-label",children:n(a)}),e.jsxs("span",{className:"outline-meta",children:[a.width,"√ó",a.height," ‚Ä¢ z:",a.zIndex||0]})]})]}),e.jsxs("div",{className:"outline-actions",onClick:h=>h.stopPropagation(),children:[e.jsx("button",{className:"outline-action-btn",onClick:()=>{t(a.id,{locked:!u})},title:u?"–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å":"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å",children:u?e.jsx(nt,{size:14}):e.jsx(ft,{size:14})}),e.jsx("button",{className:"outline-action-btn delete",onClick:()=>{window.confirm(`–£–¥–∞–ª–∏—Ç—å –≤–∏–¥–∂–µ—Ç "${n(a)}"?`)&&d(a.id)},title:"–£–¥–∞–ª–∏—Ç—å",children:e.jsx(ht,{size:14})})]})]},a.id)})})]})},Xt=()=>{const{addWidget:r,project:o}=U(),i=[{type:"shape",name:"–§–∏–≥—É—Ä–∞",icon:pt,defaultProps:{shapeType:"rectangle",fillColor:"#4a90e2",strokeColor:"#2c3e50",strokeWidth:0,cornerRadius:0,opacity:1}},{type:"button",name:"–ö–Ω–æ–ø–∫–∞",icon:at,defaultProps:{text:"–ù–∞–∂–º–∏ –º–µ–Ω—è",backgroundColor:"#4a90e2",textColor:"#ffffff"}},{type:"text",name:"–¢–µ–∫—Å—Ç",icon:ut,defaultProps:{text:"–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç",fontSize:24,color:"#000000"}},{type:"image",name:"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",icon:rt,defaultProps:{src:""}},{type:"video",name:"–í–∏–¥–µ–æ",icon:mt,defaultProps:{src:"",autoplay:!1,loop:!1}},{type:"menu",name:"–ú–µ–Ω—é",icon:ot,defaultProps:{orientation:"horizontal",items:[{id:"1",label:"–ì–ª–∞–≤–Ω–∞—è"},{id:"2",label:"–û –Ω–∞—Å"},{id:"3",label:"–£—Å–ª—É–≥–∏",children:[{id:"3-1",label:"–£—Å–ª—É–≥–∞ 1"},{id:"3-2",label:"–£—Å–ª—É–≥–∞ 2"}]},{id:"4",label:"–ö–æ–Ω—Ç–∞–∫—Ç—ã"}],backgroundColor:"#2c3e50",textColor:"#ffffff",hoverColor:"#34495e",fontSize:16,fontFamily:"Arial",itemPadding:16,submenuBackgroundColor:"#34495e",submenuTextColor:"#ffffff",borderWidth:0,borderColor:"#000000",itemHeight:40}}],t=(d,s)=>{if(!o)return;const{setPendingWidget:n}=U.getState();n(d,s)};return e.jsxs("div",{className:"widget-library panel",children:[e.jsx("div",{className:"widget-library-header",children:e.jsx("h3",{children:"–í–∏–¥–∂–µ—Ç—ã"})}),e.jsx("div",{className:"widget-library-content",children:i.map(d=>{const s=d.icon;return e.jsxs("button",{className:"widget-item",onClick:()=>t(d.type,d.defaultProps),title:`–î–æ–±–∞–≤–∏—Ç—å ${d.name}`,children:[e.jsx(s,{size:24}),e.jsx("span",{children:d.name})]},d.type)})}),e.jsx("div",{className:"widget-library-footer",children:e.jsx("button",{className:"btn-secondary",style:{width:"100%",fontSize:"12px"},children:"+ –ò–º–ø–æ—Ä—Ç –≤–∏–¥–∂–µ—Ç–∞"})}),e.jsx(Vt,{})]})},Gt="modulepreload",Kt=function(r){return"/"+r},Ne={},we=function(o,i,t){let d=Promise.resolve();if(i&&i.length>0){let a=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),c=n?.nonce||n?.getAttribute("nonce");d=a(i.map(l=>{if(l=Kt(l),l in Ne)return;Ne[l]=!0;const u=l.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const x=document.createElement("link");if(x.rel=u?"stylesheet":Gt,u||(x.as="script"),x.crossOrigin="",x.href=l,c&&x.setAttribute("nonce",c),document.head.appendChild(x),u)return new Promise((m,b)=>{x.addEventListener("load",m),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(n){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=n,window.dispatchEvent(c),!c.defaultPrevented)throw n}return d.then(n=>{for(const c of n||[])c.status==="rejected"&&s(c.reason);return o().catch(s)})},ze=({widget:r,onUpdate:o,allWidgets:i})=>{const t=r.properties.actions||[],d=()=>{const c={type:"url",url:""};o([...t,c])},s=(c,a)=>{const l=[...t];l[c]={...l[c],...a},o(l)},n=c=>{const a=t.filter((l,u)=>u!==c);o(a)};return e.jsxs("div",{className:"action-editor",children:[e.jsx("h4",{style:{marginBottom:"12px",fontSize:"12px",color:"#aaa"},children:"–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ"}),t.length===0&&e.jsx("div",{style:{padding:"16px",background:"#252525",borderRadius:"6px",textAlign:"center",color:"#888",fontSize:"13px",marginBottom:"12px"},children:"–ù–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π. –î–æ–±–∞–≤—å—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∏–∂–µ."}),t.map((c,a)=>e.jsxs("div",{className:"action-item",children:[e.jsxs("div",{className:"action-header",children:[e.jsxs("span",{className:"action-number",children:["#",a+1]}),e.jsx("button",{className:"btn-danger-small",onClick:()=>n(a),title:"–£–¥–∞–ª–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ",children:"üóëÔ∏è"})]}),e.jsxs("div",{className:"action-body",children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è"}),e.jsxs("select",{value:c.type,onChange:l=>s(a,{type:l.target.value}),children:[e.jsx("option",{value:"url",children:"üîó –û—Ç–∫—Ä—ã—Ç—å URL"}),e.jsx("option",{value:"page",children:"üìÑ –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É"}),e.jsx("option",{value:"popup",children:"üí¨ –ü–æ–∫–∞–∑–∞—Ç—å popup"}),e.jsx("option",{value:"widget_show",children:"üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å –≤–∏–¥–∂–µ—Ç"}),e.jsx("option",{value:"widget_hide",children:"üôà –°–∫—Ä—ã—Ç—å –≤–∏–¥–∂–µ—Ç"}),e.jsx("option",{value:"video_play",children:"‚ñ∂Ô∏è –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤–∏–¥–µ–æ"}),e.jsx("option",{value:"video_stop",children:"‚è∏Ô∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–∏–¥–µ–æ"})]})]}),c.type==="url"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"URL –∞–¥—Ä–µ—Å"}),e.jsx("input",{type:"text",value:c.url||"",onChange:l=>s(a,{url:l.target.value}),placeholder:"https://example.com"})]}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:c.openInNewTab||!1,onChange:l=>s(a,{openInNewTab:l.target.checked})}),"–û—Ç–∫—Ä—ã—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ"]})})]}),c.type==="page"&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"ID —Å—Ç—Ä–∞–Ω–∏—Ü—ã"}),e.jsx("input",{type:"text",value:c.pageId||"",onChange:l=>s(a,{pageId:l.target.value}),placeholder:"page-1"}),e.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:"–£–∫–∞–∂–∏—Ç–µ ID —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞"})]}),c.type==="popup"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ó–∞–≥–æ–ª–æ–≤–æ–∫ popup"}),e.jsx("input",{type:"text",value:c.popupTitle||"",onChange:l=>s(a,{popupTitle:l.target.value}),placeholder:"–ó–∞–≥–æ–ª–æ–≤–æ–∫"})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–æ–¥–µ—Ä–∂–∏–º–æ–µ popup"}),e.jsx("textarea",{value:c.popupContent||"",onChange:l=>s(a,{popupContent:l.target.value}),rows:4,placeholder:"–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è..."})]}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs("div",{className:"property-field",style:{flex:1},children:[e.jsx("label",{children:"–®–∏—Ä–∏–Ω–∞ (px)"}),e.jsx("input",{type:"number",value:c.popupWidth||400,onChange:l=>s(a,{popupWidth:parseInt(l.target.value)}),min:200,max:1e3})]}),e.jsxs("div",{className:"property-field",style:{flex:1},children:[e.jsx("label",{children:"–í—ã—Å–æ—Ç–∞ (px)"}),e.jsx("input",{type:"number",value:c.popupHeight||300,onChange:l=>s(a,{popupHeight:parseInt(l.target.value)}),min:150,max:800})]})]})]}),(c.type==="widget_show"||c.type==="widget_hide")&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–µ–ª–µ–≤–æ–π –≤–∏–¥–∂–µ—Ç"}),e.jsxs("select",{value:c.targetWidgetId||"",onChange:l=>s(a,{targetWidgetId:l.target.value}),children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–∂–µ—Ç..."}),i.filter(l=>l.id!==r.id).map(l=>e.jsxs("option",{value:l.id,children:[l.type," - ",l.id]},l.id))]})]}),(c.type==="video_play"||c.type==="video_stop")&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–í–∏–¥–µ–æ –≤–∏–¥–∂–µ—Ç"}),e.jsxs("select",{value:c.targetWidgetId||"",onChange:l=>s(a,{targetWidgetId:l.target.value}),children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–µ–æ..."}),i.filter(l=>l.type==="video").map(l=>e.jsxs("option",{value:l.id,children:["Video - ",l.id]},l.id))]})]})]})]},a)),e.jsx("button",{className:"btn-secondary",onClick:d,style:{width:"100%",marginTop:"8px"},children:"‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ"})]})},Zt=()=>{const{project:r,selectedWidgetIds:o,updateWidget:i}=U();if(!r)return null;const t=o.length===1?r.widgets.find(n=>n.id===o[0]):null,d=(n,c)=>{t&&i(t.id,{[n]:c})},s=(n,c)=>{t&&i(t.id,{properties:{...t.properties,[n]:c}})};return t?e.jsxs("div",{className:"properties-panel panel",children:[e.jsxs("div",{className:"properties-header",children:[e.jsx("h3",{children:"–°–≤–æ–π—Å—Ç–≤–∞"}),e.jsx("span",{className:"widget-type-badge",children:t.type})]}),e.jsxs("div",{className:"properties-content",children:[e.jsxs("div",{className:"property-section",children:[e.jsx("h4",{children:"–ü–æ–∑–∏—Ü–∏—è –∏ —Ä–∞–∑–º–µ—Ä"}),e.jsxs("div",{className:"property-row",children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"X"}),e.jsx("input",{type:"number",value:Math.round(t.x),onChange:n=>d("x",parseFloat(n.target.value))})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"Y"}),e.jsx("input",{type:"number",value:Math.round(t.y),onChange:n=>d("y",parseFloat(n.target.value))})]})]}),e.jsxs("div",{className:"property-row",children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–®–∏—Ä–∏–Ω–∞"}),e.jsx("input",{type:"number",value:Math.round(t.width),onChange:n=>d("width",parseFloat(n.target.value)),min:1})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–í—ã—Å–æ—Ç–∞"}),e.jsx("input",{type:"number",value:Math.round(t.height),onChange:n=>d("height",parseFloat(n.target.value)),min:1})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü–æ–≤–æ—Ä–æ—Ç (–≥—Ä–∞–¥—É—Å—ã)"}),e.jsx("input",{type:"number",value:Math.round(t.rotation||0),onChange:n=>d("rotation",parseFloat(n.target.value))})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"Z-Index (–ø–æ—Ä—è–¥–æ–∫)"}),e.jsx("input",{type:"number",min:"0",value:t.zIndex||0,onChange:n=>d("zIndex",Math.max(0,parseInt(n.target.value)||0))}),e.jsxs("div",{style:{marginTop:"8px",display:"flex",gap:"4px"},children:[e.jsx("button",{className:"btn-secondary",onClick:()=>{},style:{flex:1,fontSize:"11px",padding:"4px"},title:"–ù–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω",children:"‚¨ÜÔ∏è –ù–∞–≤–µ—Ä—Ö"}),e.jsx("button",{className:"btn-secondary",onClick:()=>{},style:{flex:1,fontSize:"11px",padding:"4px"},title:"–ù–∞ –∑–∞–¥–Ω–∏–π –ø–ª–∞–Ω",children:"‚¨áÔ∏è –í–Ω–∏–∑"})]})]}),e.jsxs("div",{className:"property-field",style:{marginTop:"12px"},children:[e.jsx("button",{className:t.locked?"btn-danger":"btn-secondary",onClick:()=>{},style:{width:"100%"},children:t.locked?"üîí –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å":"üîì –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å"}),t.locked&&e.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–∏–¥–∂–µ—Ç –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å —Ä–∞–∑–º–µ—Ä"})]})]}),e.jsxs("div",{className:"property-section",children:[e.jsx("h4",{children:"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∏–¥–∂–µ—Ç–∞"}),t.type==="shape"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø —Ñ–∏–≥—É—Ä—ã"}),e.jsxs("select",{value:t.properties.shapeType||"rectangle",onChange:n=>s("shapeType",n.target.value),children:[e.jsx("option",{value:"rectangle",children:"–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"circle",children:"–ö—Ä—É–≥"}),e.jsx("option",{value:"ellipse",children:"–≠–ª–ª–∏–ø—Å"}),e.jsx("option",{value:"triangle",children:"–¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"pentagon",children:"–ü—è—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"hexagon",children:"–®–µ—Å—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"star",children:"–ó–≤–µ–∑–¥–∞"}),e.jsx("option",{value:"diamond",children:"–†–æ–º–±"}),e.jsx("option",{value:"line",children:"–õ–∏–Ω–∏—è"}),e.jsx("option",{value:"arrow",children:"–°—Ç—Ä–µ–ª–∫–∞"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ó–∞–ª–∏–≤–∫–∞"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç –∑–∞–ª–∏–≤–∫–∏"}),e.jsx("input",{type:"color",value:t.properties.fillColor||"#4a90e2",onChange:n=>s("fillColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å"}),e.jsx("input",{type:"range",value:(t.properties.opacity||1)*100,onChange:n=>s("opacity",parseInt(n.target.value)/100),min:0,max:100}),e.jsxs("span",{style:{fontSize:"11px",color:"#888"},children:[Math.round((t.properties.opacity||1)*100),"%"]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ö–æ–Ω—Ç—É—Ä"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ –∫–æ–Ω—Ç—É—Ä–∞"}),e.jsx("input",{type:"number",value:t.properties.strokeWidth||0,onChange:n=>s("strokeWidth",parseInt(n.target.value)),min:0,max:20})]}),t.properties.strokeWidth>0&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç –∫–æ–Ω—Ç—É—Ä–∞"}),e.jsx("input",{type:"color",value:t.properties.strokeColor||"#2c3e50",onChange:n=>s("strokeColor",n.target.value)})]}),t.properties.shapeType==="rectangle"&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤"}),e.jsx("input",{type:"number",value:t.properties.cornerRadius||0,onChange:n=>s("cornerRadius",parseInt(n.target.value)),min:0,max:100})]})]}),t.type==="button"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°—Ç–∏–ª—å –∫–Ω–æ–ø–∫–∏"}),e.jsxs("select",{onChange:n=>{const c=n.target.value;c!=="custom"&&we(async()=>{const{buttonStyles:a}=await import("./buttonStyles-VsZJSFTR.js");return{buttonStyles:a}},[]).then(({buttonStyles:a})=>{const l=a.find(u=>u.name===c);l&&i(t.id,{properties:{...t.properties,...l.properties}})})},children:[e.jsx("option",{value:"custom",children:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π"}),e.jsx("option",{value:"–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é",children:"–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é"}),e.jsx("option",{value:"–û—Å–Ω–æ–≤–Ω–∞—è",children:"–û—Å–Ω–æ–≤–Ω–∞—è (—Å–∏–Ω—è—è —Å —Ç–µ–Ω—å—é)"}),e.jsx("option",{value:"–£—Å–ø–µ—Ö",children:"–£—Å–ø–µ—Ö (–∑–µ–ª—ë–Ω–∞—è)"}),e.jsx("option",{value:"–û–ø–∞—Å–Ω–æ—Å—Ç—å",children:"–û–ø–∞—Å–Ω–æ—Å—Ç—å (–∫—Ä–∞—Å–Ω–∞—è)"}),e.jsx("option",{value:"–ö–æ–Ω—Ç—É—Ä–Ω–∞—è",children:"–ö–æ–Ω—Ç—É—Ä–Ω–∞—è"}),e.jsx("option",{value:"–ü—Ä–∏–∑—Ä–∞–∫",children:"–ü—Ä–∏–∑—Ä–∞–∫"}),e.jsx("option",{value:"–ì—Ä–∞–¥–∏–µ–Ω—Ç",children:"–ì—Ä–∞–¥–∏–µ–Ω—Ç"}),e.jsx("option",{value:"–ú–∏–Ω–∏–º–∞–ª–∏–∑–º",children:"–ú–∏–Ω–∏–º–∞–ª–∏–∑–º"}),e.jsx("option",{value:"–ù–µ–æ–Ω",children:"–ù–µ–æ–Ω"}),e.jsx("option",{value:"–ö–ª–∞—Å—Å–∏–∫–∞",children:"–ö–ª–∞—Å—Å–∏–∫–∞"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–¢–µ–∫—Å—Ç"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏"}),e.jsx("input",{type:"text",value:t.properties.text||"Button",onChange:n=>s("text",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞"}),e.jsx("input",{type:"number",value:t.properties.fontSize||16,onChange:n=>s("fontSize",parseInt(n.target.value)),min:8,max:72})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–®—Ä–∏—Ñ—Ç"}),e.jsxs("select",{value:t.properties.fontFamily||"Arial",onChange:n=>s("fontFamily",n.target.value),children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Helvetica",children:"Helvetica"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Courier New",children:"Courier New"}),e.jsx("option",{value:"Verdana",children:"Verdana"}),e.jsx("option",{value:"Georgia",children:"Georgia"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ù–∞—á–µ—Ä—Ç–∞–Ω–∏–µ"}),e.jsxs("select",{value:t.properties.fontWeight||"normal",onChange:n=>s("fontWeight",n.target.value),children:[e.jsx("option",{value:"normal",children:"–û–±—ã—á–Ω—ã–π"}),e.jsx("option",{value:"bold",children:"–ñ–∏—Ä–Ω—ã–π"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ"}),e.jsxs("select",{value:t.properties.textAlign||"center",onChange:n=>s("textAlign",n.target.value),children:[e.jsx("option",{value:"left",children:"–ü–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é"}),e.jsx("option",{value:"center",children:"–ü–æ —Ü–µ–Ω—Ç—Ä—É"}),e.jsx("option",{value:"right",children:"–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞"}),e.jsx("input",{type:"color",value:t.properties.textColor||"#ffffff",onChange:n=>s("textColor",n.target.value)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–§–æ–Ω"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ñ–æ–Ω–∞"}),e.jsx("input",{type:"color",value:t.properties.backgroundColor||"#2ecc71",onChange:n=>s("backgroundColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤"}),e.jsx("input",{type:"number",value:t.properties.borderRadius||8,onChange:n=>s("borderRadius",parseInt(n.target.value)),min:0,max:50})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–º–∫–∞"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"number",value:t.properties.borderWidth||0,onChange:n=>s("borderWidth",parseInt(n.target.value)),min:0,max:10})]}),t.properties.borderWidth>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"color",value:t.properties.borderColor||"#000000",onChange:n=>s("borderColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°—Ç–∏–ª—å —Ä–∞–º–∫–∏"}),e.jsxs("select",{value:t.properties.borderStyle||"solid",onChange:n=>s("borderStyle",n.target.value),children:[e.jsx("option",{value:"solid",children:"–°–ø–ª–æ—à–Ω–∞—è"}),e.jsx("option",{value:"dashed",children:"–®—Ç—Ä–∏—Ö–æ–≤–∞—è"}),e.jsx("option",{value:"dotted",children:"–ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è"})]})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–¢–µ–Ω—å"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.shadowEnabled||!1,onChange:n=>s("shadowEnabled",n.target.checked)}),"–í–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω—å"]})}),t.properties.shadowEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–Ω–∏"}),e.jsx("input",{type:"color",value:t.properties.shadowColor||"#000000",onChange:n=>s("shadowColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–∑–º—ã—Ç–∏–µ"}),e.jsx("input",{type:"number",value:t.properties.shadowBlur||10,onChange:n=>s("shadowBlur",parseInt(n.target.value)),min:0,max:50})]}),e.jsxs("div",{className:"property-row",children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–º–µ—â–µ–Ω–∏–µ X"}),e.jsx("input",{type:"number",value:t.properties.shadowOffsetX||0,onChange:n=>s("shadowOffsetX",parseInt(n.target.value)),min:-50,max:50})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–º–µ—â–µ–Ω–∏–µ Y"}),e.jsx("input",{type:"number",value:t.properties.shadowOffsetY||4,onChange:n=>s("shadowOffsetY",parseInt(n.target.value)),min:-50,max:50})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å"}),e.jsx("input",{type:"range",value:(t.properties.shadowOpacity||.3)*100,onChange:n=>s("shadowOpacity",parseInt(n.target.value)/100),min:0,max:100}),e.jsxs("span",{style:{fontSize:"11px",color:"#888"},children:[Math.round((t.properties.shadowOpacity||.3)*100),"%"]})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–î–µ–π—Å—Ç–≤–∏—è"}),e.jsx(ze,{widget:t,onUpdate:n=>{i(t.id,{properties:{...t.properties,actions:n}})},allWidgets:r.widgets})]}),t.type==="text"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–µ–∫—Å—Ç"}),e.jsx("textarea",{value:t.properties.text||"Text",onChange:n=>s("text",n.target.value),rows:6})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª"}),e.jsx("input",{type:"file",accept:".txt,.pdf,.odt,.docx",onChange:async n=>{const c=n.target.files?.[0];if(c)try{const{extractTextFromFile:a,loadRequiredLibraries:l}=await we(async()=>{const{extractTextFromFile:h,loadRequiredLibraries:x}=await import("./fileTextExtractor-HZqzU4jo.js");return{extractTextFromFile:h,loadRequiredLibraries:x}},[]);l(),s("text","–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...");const u=await a(c);i(t.id,{properties:{...t.properties,text:u,sourceFile:c.name}})}catch(a){console.error("Error loading file:",a),alert(`–û—à–∏–±–∫–∞: ${a instanceof Error?a.message:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª"}`),s("text","Text")}n.target.value=""}}),e.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:"–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: TXT, PDF, ODT, DOCX"}),t.properties.sourceFile&&e.jsxs("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:["üìÑ ",t.properties.sourceFile]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–®—Ä–∏—Ñ—Ç"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞"}),e.jsx("input",{type:"number",value:t.properties.fontSize||16,onChange:n=>s("fontSize",parseInt(n.target.value)),min:8,max:144})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–µ–º–µ–π—Å—Ç–≤–æ —à—Ä–∏—Ñ—Ç–∞"}),e.jsxs("select",{value:t.properties.fontFamily||"Arial",onChange:n=>s("fontFamily",n.target.value),children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Helvetica",children:"Helvetica"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Courier New",children:"Courier New"}),e.jsx("option",{value:"Verdana",children:"Verdana"}),e.jsx("option",{value:"Georgia",children:"Georgia"}),e.jsx("option",{value:"Comic Sans MS",children:"Comic Sans MS"}),e.jsx("option",{value:"Impact",children:"Impact"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ù–∞—á–µ—Ä—Ç–∞–Ω–∏–µ"}),e.jsxs("select",{value:t.properties.fontWeight||"normal",onChange:n=>s("fontWeight",n.target.value),children:[e.jsx("option",{value:"normal",children:"–û–±—ã—á–Ω—ã–π"}),e.jsx("option",{value:"bold",children:"–ñ–∏—Ä–Ω—ã–π"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°—Ç–∏–ª—å"}),e.jsxs("select",{value:t.properties.fontStyle||"normal",onChange:n=>s("fontStyle",n.target.value),children:[e.jsx("option",{value:"normal",children:"–û–±—ã—á–Ω—ã–π"}),e.jsx("option",{value:"italic",children:"–ö—É—Ä—Å–∏–≤"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–î–µ–∫–æ—Ä–∞—Ü–∏—è"}),e.jsxs("select",{value:t.properties.textDecoration||"none",onChange:n=>s("textDecoration",n.target.value),children:[e.jsx("option",{value:"none",children:"–ù–µ—Ç"}),e.jsx("option",{value:"underline",children:"–ü–æ–¥—á—ë—Ä–∫–Ω—É—Ç—ã–π"}),e.jsx("option",{value:"line-through",children:"–ó–∞—á—ë—Ä–∫–Ω—É—Ç—ã–π"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏"}),e.jsxs("select",{value:t.properties.textAlign||"left",onChange:n=>s("textAlign",n.target.value),children:[e.jsx("option",{value:"left",children:"–ü–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é"}),e.jsx("option",{value:"center",children:"–ü–æ —Ü–µ–Ω—Ç—Ä—É"}),e.jsx("option",{value:"right",children:"–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏"}),e.jsxs("select",{value:t.properties.verticalAlign||"top",onChange:n=>s("verticalAlign",n.target.value),children:[e.jsx("option",{value:"top",children:"–°–≤–µ—Ä—Ö—É"}),e.jsx("option",{value:"middle",children:"–ü–æ —Ü–µ–Ω—Ç—Ä—É"}),e.jsx("option",{value:"bottom",children:"–°–Ω–∏–∑—É"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–¶–≤–µ—Ç–∞ –∏ —Ñ–æ–Ω"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞"}),e.jsx("input",{type:"color",value:t.properties.textColor||"#000000",onChange:n=>s("textColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ñ–æ–Ω–∞"}),e.jsx("input",{type:"color",value:t.properties.backgroundColor||"#ffffff",onChange:n=>s("backgroundColor",n.target.value)}),e.jsxs("label",{style:{marginTop:"4px",fontSize:"11px"},children:[e.jsx("input",{type:"checkbox",checked:t.properties.backgroundColor==="transparent",onChange:n=>s("backgroundColor",n.target.checked?"transparent":"#ffffff")}),"–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω"]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ú–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª"}),e.jsx("input",{type:"number",value:t.properties.lineHeight||1.2,onChange:n=>s("lineHeight",parseFloat(n.target.value)),min:.5,max:3,step:.1})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–û—Ç—Å—Ç—É–ø –æ—Ç –∫—Ä–∞—è"}),e.jsx("input",{type:"number",value:t.properties.padding||8,onChange:n=>s("padding",parseInt(n.target.value)),min:0,max:50})]})]}),t.type==="image"&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginTop:"0",marginBottom:"12px",fontSize:"13px",fontWeight:"bold"},children:"–†–µ–∂–∏–º"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"imageMode",checked:!t.properties.galleryMode,onChange:()=>s("galleryMode",!1)})," ","–û–¥–∏–Ω–æ—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"imageMode",checked:t.properties.galleryMode||!1,onChange:()=>{s("galleryMode",!0),t.properties.sources||s("sources",[])}})," ","–ì–∞–ª–µ—Ä–µ—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"]})}),!t.properties.galleryMode&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"}),e.jsx("input",{type:"text",value:t.properties.src||"",onChange:n=>s("src",n.target.value),placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª"}),e.jsx("input",{type:"file",accept:"image/*",onChange:n=>{const c=n.target.files?.[0];if(c){const a=new FileReader;a.onload=l=>{const u=l.target?.result;u&&i(t.id,{properties:{...t.properties,src:u,isLocalFile:!0,fileName:c.name}})},a.readAsDataURL(c)}n.target.value=""}}),t.properties.isLocalFile&&t.properties.fileName&&e.jsxs("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:["üìÅ ",t.properties.fileName]})]})]}),t.properties.galleryMode&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ò—Å—Ç–æ—á–Ω–∏–∫–∏ (–º–∞–∫—Å. 50)"}),e.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid #ddd",borderRadius:"4px",padding:"8px",marginBottom:"8px",backgroundColor:"#fafafa"},children:[(t.properties.sources||[]).map((n,c)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",padding:"6px",backgroundColor:"#fff",borderRadius:"4px",border:"1px solid #e0e0e0"},children:[e.jsxs("span",{style:{fontSize:"11px",color:"#666",minWidth:"20px"},children:[c+1,"."]}),e.jsx("span",{style:{fontSize:"11px",color:n.type==="url"?"#007acc":"#2ecc71"},children:n.type==="url"?"üåê":"üì∑"}),e.jsx("span",{style:{flex:1,fontSize:"11px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.value.length>40?n.value.substring(0,40)+"...":n.value}),e.jsx("button",{onClick:()=>{const a=(t.properties.sources||[]).filter((l,u)=>u!==c);s("sources",a)},style:{padding:"2px 6px",fontSize:"10px",border:"none",background:"#e74c3c",color:"#fff",borderRadius:"3px",cursor:"pointer"},children:"‚úï"})]},n.id)),(!t.properties.sources||t.properties.sources.length===0)&&e.jsx("div",{style:{textAlign:"center",color:"#999",fontSize:"11px",padding:"20px"},children:"–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≥–∞–ª–µ—Ä–µ–µ"})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,id:`gallery-upload-${t.id}`,style:{display:"none"},onChange:n=>{const c=Array.from(n.target.files||[]),a=t.properties.sources||[];if(a.length+c.length>50){alert("–ú–∞–∫—Å–∏–º—É–º 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≥–∞–ª–µ—Ä–µ–µ"),n.target.value="";return}let l=0;const u=[];c.forEach(h=>{const x=new FileReader;x.onload=m=>{const b=m.target?.result;b&&u.push({id:`img-${Date.now()}-${Math.random()}`,type:"local",value:b}),l++,l===c.length&&s("sources",[...a,...u])},x.readAsDataURL(h)}),n.target.value=""}}),e.jsx("button",{onClick:()=>{document.getElementById(`gallery-upload-${t.id}`)?.click()},className:"btn-secondary",style:{flex:1,fontSize:"11px",padding:"6px"},children:"üì∑ –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã"}),e.jsx("button",{onClick:()=>{const n=prompt("–í–≤–µ–¥–∏—Ç–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:");if(n){const c=t.properties.sources||[];if(c.length>=50){alert("–ú–∞–∫—Å–∏–º—É–º 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≥–∞–ª–µ—Ä–µ–µ");return}s("sources",[...c,{id:`img-${Date.now()}-${Math.random()}`,type:"url",value:n}])}},className:"btn-secondary",style:{flex:1,fontSize:"11px",padding:"6px"},children:"üåê –î–æ–±–∞–≤–∏—Ç—å URL"})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ê–≤—Ç–æ–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.autoSwitch||!1,onChange:n=>s("autoSwitch",n.target.checked)})," ","–í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ"]})}),t.properties.autoSwitch&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ò–Ω—Ç–µ—Ä–≤–∞–ª (—Å–µ–∫—É–Ω–¥—ã)"}),e.jsx("input",{type:"number",min:"1",max:"60",value:t.properties.switchInterval||3,onChange:n=>s("switchInterval",parseInt(n.target.value)||3)})]})}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–≠—Ñ—Ñ–µ–∫—Ç—ã –ø–µ—Ä–µ—Ö–æ–¥–∞"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–≠—Ñ—Ñ–µ–∫—Ç"}),e.jsxs("select",{value:t.properties.transition||"fade",onChange:n=>s("transition",n.target.value),children:[e.jsx("option",{value:"none",children:"–ù–µ—Ç (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)"}),e.jsx("option",{value:"fade",children:"–ó–∞—Ç—É—Ö–∞–Ω–∏–µ"}),e.jsx("option",{value:"slide",children:"–°–∫–æ–ª—å–∂–µ–Ω–∏–µ"}),e.jsx("option",{value:"zoom",children:"–£–≤–µ–ª–∏—á–µ–Ω–∏–µ"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º—Å)"}),e.jsx("input",{type:"number",min:"100",max:"2000",step:"100",value:t.properties.transitionDuration||500,onChange:n=>s("transitionDuration",parseInt(n.target.value)||500)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ö–æ–Ω—Ç—Ä–æ–ª—ã"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.showControls!==!1,onChange:n=>s("showControls",n.target.checked)})," ","–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–µ–ª–∫–∏"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.showIndicators!==!1,onChange:n=>s("showIndicators",n.target.checked)})," ","–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.loop!==!1,onChange:n=>s("loop",n.target.checked)})," ","–ó–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ"]})})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"}),e.jsxs("select",{value:t.properties.objectFit||"contain",onChange:n=>s("objectFit",n.target.value),children:[e.jsx("option",{value:"contain",children:"–ü—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–≤–ø–∏—Å–∞—Ç—å)"}),e.jsx("option",{value:"cover",children:"–ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤–µ—Å—å –≤–∏–¥–∂–µ—Ç"}),e.jsx("option",{value:"fill",children:"–†–∞—Å—Ç—è–Ω—É—Ç—å"}),e.jsx("option",{value:"scale-down",children:"–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä"}),e.jsx("option",{value:"adaptive",children:"–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π (–∏–∑–º–µ–Ω–∏—Ç—å –≤–∏–¥–∂–µ—Ç)"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–§–æ—Ä–º–∞ –æ–±—Ä–µ–∑–∫–∏"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–§–æ—Ä–º–∞"}),e.jsxs("select",{value:t.properties.clipShape||"rectangle",onChange:n=>s("clipShape",n.target.value),children:[e.jsx("option",{value:"rectangle",children:"‚¨ú –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"circle",children:"‚ö´ –ö—Ä—É–≥"}),e.jsx("option",{value:"ellipse",children:"üî¥ –≠–ª–ª–∏–ø—Å"}),e.jsx("option",{value:"triangle",children:"üî∫ –¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"diamond",children:"üî∂ –†–æ–º–±"}),e.jsx("option",{value:"pentagon",children:"‚¨¢ –ü—è—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"hexagon",children:"‚¨° –®–µ—Å—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"octagon",children:"‚≠ê –í–æ—Å—å–º–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"rounded-rectangle",children:"üè∑Ô∏è –ó–∞–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫"})]})]}),t.properties.clipShape==="rounded-rectangle"&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–¥–∏—É—Å —É–≥–ª–æ–≤ (px)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:t.properties.cornerRadius||20,onChange:n=>s("cornerRadius",parseInt(n.target.value)||20)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–º–∫–∞"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.borderEnabled||!1,onChange:n=>s("borderEnabled",n.target.checked)}),"–í–∫–ª—é—á–∏—Ç—å —Ä–∞–º–∫—É"]})}),t.properties.borderEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø —Ä–∞–º–∫–∏"}),e.jsxs("select",{value:t.properties.borderStyle||"solid",onChange:n=>s("borderStyle",n.target.value),children:[e.jsx("option",{value:"solid",children:"–°–ø–ª–æ—à–Ω–∞—è"}),e.jsx("option",{value:"dashed",children:"–®—Ç—Ä–∏—Ö–æ–≤–∞—è"}),e.jsx("option",{value:"dotted",children:"–ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è"}),e.jsx("option",{value:"double",children:"–î–≤–æ–π–Ω–∞—è"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–∫–∏ (px)"}),e.jsx("input",{type:"number",value:t.properties.borderWidth||2,onChange:n=>s("borderWidth",parseFloat(n.target.value)),min:1,max:20})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"color",value:t.properties.borderColor||"#000000",onChange:n=>s("borderColor",n.target.value)})]})]})]}),t.type==="video"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞"}),e.jsxs("select",{value:t.properties.sourceType||"url",onChange:n=>s("sourceType",n.target.value),children:[e.jsx("option",{value:"url",children:"URL / –§–∞–π–ª"}),e.jsx("option",{value:"rtsp",children:"RTSP –ø–æ—Ç–æ–∫"})]})]}),t.properties.sourceType==="rtsp"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"RTSP URL"}),e.jsx("input",{type:"text",value:t.properties.rtspUrl||"",onChange:n=>s("rtspUrl",n.target.value),placeholder:"rtsp://username:password@host:554/stream"}),e.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:"–ü—Ä–∏–º–µ—Ä: rtsp://admin:12345@192.168.1.100:554/live"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"URL –≤–∏–¥–µ–æ"}),e.jsx("input",{type:"text",value:t.properties.src||"",onChange:n=>s("src",n.target.value),placeholder:"https://example.com/video.mp4"})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª"}),e.jsx("input",{type:"file",accept:"video/*",onChange:n=>{const c=n.target.files?.[0];if(c){const a=new FileReader;a.onload=l=>{const u=l.target?.result;u&&i(t.id,{properties:{...t.properties,src:u,isLocalFile:!0,fileName:c.name}})},a.readAsDataURL(c)}n.target.value=""}}),t.properties.isLocalFile&&t.properties.fileName&&e.jsxs("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:["üìÅ ",t.properties.fileName]})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"}),e.jsxs("select",{value:t.properties.objectFit||"contain",onChange:n=>s("objectFit",n.target.value),children:[e.jsx("option",{value:"contain",children:"–ü—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–≤–ø–∏—Å–∞—Ç—å)"}),e.jsx("option",{value:"cover",children:"–ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤–µ—Å—å –≤–∏–¥–∂–µ—Ç"}),e.jsx("option",{value:"fill",children:"–†–∞—Å—Ç—è–Ω—É—Ç—å"}),e.jsx("option",{value:"scale-down",children:"–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä"}),e.jsx("option",{value:"adaptive",children:"–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π (–∏–∑–º–µ–Ω–∏—Ç—å –≤–∏–¥–∂–µ—Ç)"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.autoplay||!1,onChange:n=>s("autoplay",n.target.checked)}),"–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.loop||!1,onChange:n=>s("loop",n.target.checked)}),"–ü–æ–≤—Ç–æ—Ä (loop)"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.muted!==!1,onChange:n=>s("muted",n.target.checked)}),"–ë–µ–∑ –∑–≤—É–∫–∞ (muted)"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.controls!==!1,onChange:n=>s("controls",n.target.checked)}),"–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è"]})}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–º–∫–∞"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:t.properties.borderEnabled||!1,onChange:n=>s("borderEnabled",n.target.checked)}),"–í–∫–ª—é—á–∏—Ç—å —Ä–∞–º–∫—É"]})}),t.properties.borderEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°—Ç–∏–ª—å —Ä–∞–º–∫–∏"}),e.jsxs("select",{value:t.properties.borderStyle||"solid",onChange:n=>s("borderStyle",n.target.value),children:[e.jsx("option",{value:"solid",children:"–°–ø–ª–æ—à–Ω–∞—è"}),e.jsx("option",{value:"dashed",children:"–®—Ç—Ä–∏—Ö–æ–≤–∞—è"}),e.jsx("option",{value:"dotted",children:"–ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è"}),e.jsx("option",{value:"double",children:"–î–≤–æ–π–Ω–∞—è"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"number",value:t.properties.borderWidth||2,onChange:n=>s("borderWidth",parseInt(n.target.value)),min:1,max:20})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"color",value:t.properties.borderColor||"#000000",onChange:n=>s("borderColor",n.target.value)})]})]})]}),t.type==="menu"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è"}),e.jsxs("select",{value:t.properties.orientation||"horizontal",onChange:n=>s("orientation",n.target.value),children:[e.jsx("option",{value:"horizontal",children:"–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è"}),e.jsx("option",{value:"vertical",children:"–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–í–Ω–µ—à–Ω–∏–π –≤–∏–¥"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ñ–æ–Ω–∞"}),e.jsx("input",{type:"color",value:t.properties.backgroundColor||"#2c3e50",onChange:n=>s("backgroundColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞"}),e.jsx("input",{type:"color",value:t.properties.textColor||"#ffffff",onChange:n=>s("textColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏"}),e.jsx("input",{type:"color",value:t.properties.hoverColor||"#34495e",onChange:n=>s("hoverColor",n.target.value)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–®—Ä–∏—Ñ—Ç"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞"}),e.jsx("input",{type:"number",value:t.properties.fontSize||16,onChange:n=>s("fontSize",parseInt(n.target.value)),min:10,max:32})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–µ–º–µ–π—Å—Ç–≤–æ —à—Ä–∏—Ñ—Ç–∞"}),e.jsxs("select",{value:t.properties.fontFamily||"Arial",onChange:n=>s("fontFamily",n.target.value),children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Helvetica",children:"Helvetica"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Verdana",children:"Verdana"}),e.jsx("option",{value:"Georgia",children:"Georgia"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–∑–º–µ—Ä—ã"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–í—ã—Å–æ—Ç–∞ –ø—É–Ω–∫—Ç–∞"}),e.jsx("input",{type:"number",value:t.properties.itemHeight||40,onChange:n=>s("itemHeight",parseInt(n.target.value)),min:30,max:100})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–û—Ç—Å—Ç—É–ø –ø—É–Ω–∫—Ç–∞"}),e.jsx("input",{type:"number",value:t.properties.itemPadding||16,onChange:n=>s("itemPadding",parseInt(n.target.value)),min:8,max:40})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ü–æ–¥–º–µ–Ω—é"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ñ–æ–Ω–∞ –ø–æ–¥–º–µ–Ω—é"}),e.jsx("input",{type:"color",value:t.properties.submenuBackgroundColor||"#34495e",onChange:n=>s("submenuBackgroundColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –ø–æ–¥–º–µ–Ω—é"}),e.jsx("input",{type:"color",value:t.properties.submenuTextColor||"#ffffff",onChange:n=>s("submenuTextColor",n.target.value)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–º–∫–∞"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"number",value:t.properties.borderWidth||0,onChange:n=>s("borderWidth",parseInt(n.target.value)),min:0,max:10})]}),t.properties.borderWidth>0&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"color",value:t.properties.borderColor||"#000000",onChange:n=>s("borderColor",n.target.value)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ü—É–Ω–∫—Ç—ã –º–µ–Ω—é"}),e.jsx("div",{className:"property-field",children:e.jsx("button",{className:"btn-secondary",onClick:()=>{const n=t.properties.items||[],c={id:`item-${Date.now()}`,label:"–ù–æ–≤—ã–π –ø—É–Ω–∫—Ç"};i(t.id,{properties:{...t.properties,items:[...n,c]}})},style:{width:"100%"},children:"‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç"})}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:(t.properties.items||[]).map((n,c)=>e.jsxs("div",{style:{background:"#252525",padding:"12px",marginBottom:"8px",borderRadius:"6px",border:"1px solid #333"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[e.jsxs("strong",{style:{fontSize:"12px",color:"#aaa"},children:["–ü—É–Ω–∫—Ç ",c+1]}),e.jsx("button",{className:"btn-danger",onClick:()=>{const a=t.properties.items||[];i(t.id,{properties:{...t.properties,items:a.filter(l=>l.id!==n.id)}})},style:{fontSize:"11px",padding:"4px 8px"},children:"üóëÔ∏è –£–¥–∞–ª–∏—Ç—å"})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ù–∞–∑–≤–∞–Ω–∏–µ"}),e.jsx("input",{type:"text",value:n.label,onChange:a=>{const l=[...t.properties.items||[]];l[c]={...l[c],label:a.target.value},i(t.id,{properties:{...t.properties,items:l}})}})]}),e.jsxs("div",{style:{marginTop:"12px"},children:[e.jsx("div",{style:{fontSize:"11px",color:"#888",marginBottom:"8px"},children:"–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ"}),e.jsx(ze,{widget:{...t,id:n.id,properties:n},onUpdate:a=>{const l=[...t.properties.items||[]];l[c]={...l[c],actions:a},i(t.id,{properties:{...t.properties,items:l}})},allWidgets:r.widgets})]}),e.jsxs("div",{style:{marginTop:"12px",paddingLeft:"12px",borderLeft:"2px solid #444"},children:[e.jsx("div",{style:{fontSize:"11px",color:"#888",marginBottom:"8px"},children:"–ü–æ–¥–ø—É–Ω–∫—Ç—ã"}),e.jsx("button",{className:"btn-secondary",onClick:()=>{const a=[...t.properties.items||[]],l=a[c].children||[];a[c]={...a[c],children:[...l,{id:`subitem-${Date.now()}`,label:"–ü–æ–¥–ø—É–Ω–∫—Ç"}]},i(t.id,{properties:{...t.properties,items:a}})},style:{width:"100%",fontSize:"11px",padding:"6px",marginBottom:"8px"},children:"‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø—É–Ω–∫—Ç"}),(n.children||[]).map((a,l)=>e.jsx("div",{style:{background:"#1e1e1e",padding:"8px",marginBottom:"6px",borderRadius:"4px",border:"1px solid #2a2a2a"},children:e.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[e.jsx("input",{type:"text",value:a.label,onChange:u=>{const h=[...t.properties.items||[]],x=[...h[c].children||[]];x[l]={...x[l],label:u.target.value},h[c]={...h[c],children:x},i(t.id,{properties:{...t.properties,items:h}})},style:{flex:1,fontSize:"12px",padding:"4px 8px"}}),e.jsx("button",{className:"btn-danger",onClick:()=>{const u=[...t.properties.items||[]],h=u[c].children?.filter(x=>x.id!==a.id)||[];u[c]={...u[c],children:h},i(t.id,{properties:{...t.properties,items:u}})},style:{fontSize:"11px",padding:"4px 8px"},children:"üóëÔ∏è"})]})},a.id))]})]},n.id))})]})]}),e.jsx("div",{className:"property-section",children:e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"ID"}),e.jsx("input",{type:"text",value:t.id,disabled:!0,style:{opacity:.5,cursor:"not-allowed"}})]})})]})]}):e.jsxs("div",{className:"properties-panel panel",children:[e.jsx("div",{className:"properties-header",children:e.jsx("h3",{children:"–°–≤–æ–π—Å—Ç–≤–∞"})}),e.jsx("div",{className:"properties-empty",children:e.jsx("p",{children:"–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–∂–µ—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"})})]})},Yt=()=>{const[r,o]=w.useState(0),{project:i,selectedWidgetIds:t,copy:d,paste:s,cut:n,deleteWidget:c,undo:a,redo:l}=U();return w.useEffect(()=>{const u=h=>{(h.ctrlKey||h.metaKey)&&h.key==="z"&&!h.shiftKey&&(h.preventDefault(),a()),(h.ctrlKey||h.metaKey)&&h.key==="z"&&h.shiftKey&&(h.preventDefault(),l()),(h.ctrlKey||h.metaKey)&&h.key==="c"&&(h.preventDefault(),d()),(h.ctrlKey||h.metaKey)&&h.key==="v"&&(h.preventDefault(),s()),(h.ctrlKey||h.metaKey)&&h.key==="x"&&(h.preventDefault(),n()),h.key==="Delete"&&(h.preventDefault(),t.forEach(x=>c(x)))};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[]),w.useEffect(()=>{const u=()=>{o(h=>h+1)};return window.addEventListener("auth:login",u),()=>window.removeEventListener("auth:login",u)},[]),e.jsxs("div",{className:"editor",children:[e.jsx(Mt,{}),e.jsxs("div",{className:"editor-main",children:[e.jsx(Xt,{}),e.jsx(qt,{}),e.jsx(Zt,{})]})]})},Jt=({children:r})=>G.isAuthenticated()?e.jsx(e.Fragment,{children:r}):(console.log("[ProtectedRoute] Not authenticated, redirecting to /login"),e.jsx(he,{to:"/login",replace:!0})),Qt=()=>(console.log("[App.tsx] App component rendering with Router"),e.jsx(Le,{children:e.jsxs(Fe,{children:[e.jsx(ie,{path:"/",element:e.jsx(he,{to:"/login",replace:!0})}),e.jsx(ie,{path:"/login",element:e.jsx(kt,{})}),e.jsx(ie,{path:"/editor",element:e.jsx(Jt,{children:e.jsx(Yt,{})})}),e.jsx(ie,{path:"*",element:e.jsx(he,{to:"/login",replace:!0})})]})}));try{const r=document.getElementById("root");if(!r)throw new Error("Root element not found");Ge.createRoot(r).render(e.jsx(X.StrictMode,{children:e.jsx(Qt,{})}))}catch(r){console.error("Failed to mount React app:",r),document.body.innerHTML=`
    <div style="
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background: #1e1e1e;
      color: #ff6b6b;
      font-family: Arial, sans-serif;
      padding: 20px;
    ">
      <div style="text-align: center; max-width: 600px;">
        <h1>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</h1>
        <p style="color: #cccccc;">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.</p>
        <pre style="
          text-align: left;
          background: #2a2a2a;
          padding: 15px;
          border-radius: 5px;
          overflow-x: auto;
          color: #ff6b6b;
        ">${r}</pre>
        <button onclick="location.reload()" style="
          margin-top: 20px;
          padding: 10px 20px;
          background: #4a90e2;
          color: white;
          border: none;
          border-radius: 5px;
          cursor: pointer;
          font-size: 14px;
        ">
          –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
        </button>
      </div>
    </div>
  `}
//# sourceMappingURL=index-DOcnOijB.js.map
