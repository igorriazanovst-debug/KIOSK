import{r as ue,b as Pe,g as Ee}from"./vendor-BTI42rwv.js";import{R as X,r as C,I as re,G,a as E,T as F,L as te,b as ie,S as Ae,E as Le,C as Fe,c as Me,d as De,e as Oe}from"./konva-CBotBK3N.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))r(d);new MutationObserver(d=>{for(const o of d)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function i(d){const o={};return d.integrity&&(o.integrity=d.integrity),d.referrerPolicy&&(o.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?o.credentials="include":d.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(d){if(d.ep)return;d.ep=!0;const o=i(d);fetch(d.href,o)}})();var oe={exports:{}},ee={};var xe;function $e(){if(xe)return ee;xe=1;var t=ue(),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,d=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function n(l,s,c){var p,u={},x=null,g=null;c!==void 0&&(x=""+c),s.key!==void 0&&(x=""+s.key),s.ref!==void 0&&(g=s.ref);for(p in s)r.call(s,p)&&!o.hasOwnProperty(p)&&(u[p]=s[p]);if(l&&l.defaultProps)for(p in s=l.defaultProps,s)u[p]===void 0&&(u[p]=s[p]);return{$$typeof:a,type:l,key:x,ref:g,props:u,_owner:d.current}}return ee.Fragment=i,ee.jsx=n,ee.jsxs=n,ee}var fe;function Be(){return fe||(fe=1,oe.exports=$e()),oe.exports}var e=Be(),se={},ge;function _e(){if(ge)return se;ge=1;var t=Pe();return se.createRoot=t.createRoot,se.hydrateRoot=t.hydrateRoot,se}var He=_e();const qe=Ee(He),Ue={},me=t=>{let a;const i=new Set,r=(p,u)=>{const x=typeof p=="function"?p(a):p;if(!Object.is(x,a)){const g=a;a=u??(typeof x!="object"||x===null)?x:Object.assign({},a,x),i.forEach(m=>m(a,g))}},d=()=>a,s={setState:r,getState:d,getInitialState:()=>c,subscribe:p=>(i.add(p),()=>i.delete(p)),destroy:()=>{(Ue?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),i.clear()}},c=a=t(r,d,s);return s},Xe=t=>t?me(t):me;var ae={exports:{}},le={},ce={exports:{}},de={};var je;function Ve(){if(je)return de;je=1;var t=ue();function a(u,x){return u===x&&(u!==0||1/u===1/x)||u!==u&&x!==x}var i=typeof Object.is=="function"?Object.is:a,r=t.useState,d=t.useEffect,o=t.useLayoutEffect,n=t.useDebugValue;function l(u,x){var g=x(),m=r({inst:{value:g,getSnapshot:x}}),y=m[0].inst,b=m[1];return o(function(){y.value=g,y.getSnapshot=x,s(y)&&b({inst:y})},[u,g,x]),d(function(){return s(y)&&b({inst:y}),u(function(){s(y)&&b({inst:y})})},[u]),n(g),g}function s(u){var x=u.getSnapshot;u=u.value;try{var g=x();return!i(u,g)}catch{return!0}}function c(u,x){return x()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:l;return de.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,de}var ye;function Ge(){return ye||(ye=1,ce.exports=Ve()),ce.exports}var ve;function Ke(){if(ve)return le;ve=1;var t=ue(),a=Ge();function i(c,p){return c===p&&(c!==0||1/c===1/p)||c!==c&&p!==p}var r=typeof Object.is=="function"?Object.is:i,d=a.useSyncExternalStore,o=t.useRef,n=t.useEffect,l=t.useMemo,s=t.useDebugValue;return le.useSyncExternalStoreWithSelector=function(c,p,u,x,g){var m=o(null);if(m.current===null){var y={hasValue:!1,value:null};m.current=y}else y=m.current;m=l(function(){function T(I){if(!N){if(N=!0,k=I,I=x(I),g!==void 0&&y.hasValue){var h=y.value;if(g(h,I))return w=h}return w=I}if(h=w,r(k,I))return h;var j=x(I);return g!==void 0&&g(h,j)?(k=I,h):(k=I,w=j)}var N=!1,k,w,P=u===void 0?null:u;return[function(){return T(p())},P===null?void 0:function(){return T(P())}]},[p,u,x,g]);var b=d(c,m[0],m[1]);return n(function(){y.hasValue=!0,y.value=b},[b]),s(b),b},le}var be;function Ye(){return be||(be=1,ae.exports=Ke()),ae.exports}var Ze=Ye();const Je=Ee(Ze),we={},{useDebugValue:Qe}=X,{useSyncExternalStoreWithSelector:et}=Je;let ke=!1;const tt=t=>t;function rt(t,a=tt,i){(we?"production":void 0)!=="production"&&i&&!ke&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ke=!0);const r=et(t.subscribe,t.getState,t.getServerState||t.getInitialState,a,i);return Qe(r),r}const Se=t=>{(we?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof t=="function"?Xe(t):t,i=(r,d)=>rt(a,r,d);return Object.assign(i,a),i},nt=t=>t?Se(t):Se;class it{baseUrl="";token=null;lastActivity=Date.now();inactivityTimer=null;INACTIVITY_TIMEOUT=1800*1e3;constructor(){this.loadToken(),this.startActivityMonitoring()}loadToken(){const a=localStorage.getItem("kiosk_auth_token");if(a)try{const i=JSON.parse(a);new Date(i.expiresAt)>new Date?this.token=i.token:this.clearToken()}catch(i){console.error("[API] Failed to parse stored token:",i),this.clearToken()}}saveToken(a,i){localStorage.setItem("kiosk_auth_token",JSON.stringify({token:a,expiresAt:i})),this.token=a}clearToken(){localStorage.removeItem("kiosk_auth_token"),this.token=null}isAuthenticated(){return this.token!==null}getToken(){return this.token}async loginWithLicense(a){const i=await this.request("/api/auth/license",{method:"POST",body:JSON.stringify({licenseKey:a})});if(i.token){const r=new Date(Date.now()+i.expiresIn*1e3).toISOString();this.saveToken(i.token,r)}return i}async refreshToken(){const a=await this.request("/api/auth/refresh",{method:"POST",authenticated:!0});if(a.token){const i=new Date(Date.now()+a.expiresIn*1e3).toISOString();this.saveToken(a.token,i)}return a}async verifyToken(){try{return await this.request("/api/auth/verify",{method:"GET",authenticated:!0}),!0}catch{return this.clearToken(),!1}}logout(){this.clearToken(),this.stopActivityMonitoring()}async getProjects(a){const i=new URLSearchParams;a?.search&&i.append("search",a.search),a?.tags&&i.append("tags",a.tags.join(",")),a?.isPublished!==void 0&&i.append("isPublished",String(a.isPublished)),a?.page&&i.append("page",String(a.page)),a?.limit&&i.append("limit",String(a.limit));const r=i.toString(),d=r?`/api/projects?${r}`:"/api/projects";return this.request(d,{method:"GET",authenticated:!0})}async createProject(a){return this.request("/api/projects",{method:"POST",authenticated:!0,body:JSON.stringify(a)})}async getProject(a){return this.request(`/api/projects/${a}`,{method:"GET",authenticated:!0})}async updateProject(a,i){return this.request(`/api/projects/${a}`,{method:"PUT",authenticated:!0,body:JSON.stringify(i)})}async deleteProject(a){await this.request(`/api/projects/${a}`,{method:"DELETE",authenticated:!0})}async getProjectFiles(a){return this.request(`/api/projects/${a}/files`,{method:"GET",authenticated:!0})}async uploadFile(a,i,r){const d=new FormData;return d.append("file",i),new Promise((o,n)=>{const l=new XMLHttpRequest;r&&l.upload.addEventListener("progress",s=>{if(s.lengthComputable){const c=s.loaded/s.total*100;r(c)}}),l.addEventListener("load",()=>{if(l.status===200||l.status===201)try{const s=JSON.parse(l.responseText);o(s.file||s)}catch{n(new Error("Failed to parse response"))}else try{const s=JSON.parse(l.responseText);n(new Error(s.message||`Upload failed: ${l.status}`))}catch{n(new Error(`Upload failed: ${l.status}`))}}),l.addEventListener("error",()=>{n(new Error("Network error"))}),l.open("POST",`/api/projects/${a}/files`),this.token&&l.setRequestHeader("Authorization",`Bearer ${this.token}`),l.send(d)})}async downloadFile(a,i){const r=await fetch(`/api/projects/${a}/files/${i}`,{method:"GET",headers:this.token?{Authorization:`Bearer ${this.token}`}:{}});if(!r.ok)throw new Error(`Download failed: ${r.status}`);return r.blob()}async deleteFile(a,i){await this.request(`/api/projects/${a}/files/${i}`,{method:"DELETE",authenticated:!0})}async getStorageStats(){return this.request("/api/storage/stats",{method:"GET",authenticated:!0})}updateActivity(){this.lastActivity=Date.now()}startActivityMonitoring(){["mousemove","keypress","click","scroll","touchstart"].forEach(i=>{window.addEventListener(i,()=>this.updateActivity(),{passive:!0})}),this.inactivityTimer=setInterval(()=>{if(!this.isAuthenticated())return;Date.now()-this.lastActivity>this.INACTIVITY_TIMEOUT&&(console.warn("[API] Session expired due to inactivity"),this.logout(),window.dispatchEvent(new CustomEvent("auth:logout",{detail:{reason:"inactivity"}})))},60*1e3)}stopActivityMonitoring(){this.inactivityTimer&&(clearInterval(this.inactivityTimer),this.inactivityTimer=null)}async request(a,i){const r=`${this.baseUrl}${a}`,d={"Content-Type":"application/json"};i.authenticated&&this.token&&(d.Authorization=`Bearer ${this.token}`);try{const o=await fetch(r,{method:i.method,headers:d,body:i.body});i.authenticated&&this.updateActivity();const n=await o.json();if(!o.ok)throw o.status===401&&i.authenticated&&(this.clearToken(),window.dispatchEvent(new CustomEvent("auth:unauthorized"))),new Error(n.message||n.error||`HTTP ${o.status}`);return n}catch(o){throw console.error(`[API] ${i.method} ${a} failed:`,o),o}}}const q=new it;let Q=null;function U(t,a=18e4){Q&&clearTimeout(Q),Q=setTimeout(async()=>{try{console.log("[Editor] Auto-saving project..."),await t(),console.log("[Editor] Auto-save completed")}catch(i){console.error("[Editor] Auto-save failed:",i)}},a)}function Ie(){Q&&(clearTimeout(Q),Q=null)}const O=nt((t,a)=>({project:null,projectId:null,isLoading:!1,isSaving:!1,lastSaved:null,saveError:null,selectedWidgetIds:[],clipboard:[],history:{past:[],future:[]},zoom:1,gridEnabled:!0,snapToGrid:!0,gridSize:20,gridLineWidth:1,gridColor:"#e0e0e0",pendingWidget:null,createProject:async(i,r)=>{t({isLoading:!0,saveError:null});try{const d={version:"1.0",name:i,canvas:r,widgets:[],metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},o=await q.createProject({name:i,canvasWidth:r.width,canvasHeight:r.height,canvasBackground:r.backgroundColor||"#1a1a1a",projectData:d});t({project:{...d,id:o.id},projectId:o.id,isLoading:!1,lastSaved:new Date,history:{past:[],future:[]}}),console.log("[Editor] Project created:",o.id),U(a().saveProject)}catch(d){throw console.error("[Editor] Failed to create project:",d),t({isLoading:!1,saveError:d.message||"Failed to create project"}),d}},loadProject:async i=>{t({isLoading:!0,saveError:null});try{const r=await q.getProject(i),d={id:r.id,version:"1.0",name:r.name,canvas:{width:r.canvasWidth,height:r.canvasHeight,backgroundColor:r.canvasBackground},widgets:r.projectData?.widgets||[],metadata:{createdAt:r.createdAt,updatedAt:r.updatedAt}};t({project:d,projectId:r.id,isLoading:!1,lastSaved:new Date(r.updatedAt),history:{past:[],future:[]}}),console.log("[Editor] Project loaded:",i),U(a().saveProject)}catch(r){throw console.error("[Editor] Failed to load project:",r),t({isLoading:!1,saveError:r.message||"Failed to load project"}),r}},saveProject:async()=>{const{project:i,projectId:r,isSaving:d}=a();if(!i||!r){console.warn("[Editor] No project to save");return}if(d){console.warn("[Editor] Save already in progress");return}t({isSaving:!0,saveError:null});try{await q.updateProject(r,{name:i.name,projectData:i,canvasWidth:i.canvas.width,canvasHeight:i.canvas.height,canvasBackground:i.canvas.backgroundColor}),t({isSaving:!1,lastSaved:new Date,saveError:null}),console.log("[Editor] Project saved:",r)}catch(o){throw console.error("[Editor] Failed to save project:",o),t({isSaving:!1,saveError:o.message||"Failed to save project"}),o}},deleteProject:async i=>{try{await q.deleteProject(i),a().projectId===i&&(t({project:null,projectId:null,selectedWidgetIds:[],history:{past:[],future:[]}}),Ie()),console.log("[Editor] Project deleted:",i)}catch(r){throw console.error("[Editor] Failed to delete project:",r),r}},updateProjectMetadata:i=>{const{project:r}=a();r&&(t({project:{...r,...i,metadata:{...r.metadata,updatedAt:new Date().toISOString()}}}),U(a().saveProject))},addWidget:i=>{const{project:r}=a();r&&(a().saveToHistory(),t({project:{...r,widgets:[...r.widgets,i],metadata:{...r.metadata,updatedAt:new Date().toISOString()}}}),U(a().saveProject))},setPendingWidget:(i,r)=>{t({pendingWidget:{type:i,defaultProps:r}})},clearPendingWidget:()=>{t({pendingWidget:null})},addWidgetAtPosition:(i,r)=>{const{pendingWidget:d,project:o,snapToGrid:n,gridSize:l}=a();if(!d||!o)return;let s=i,c=r;n&&(s=Math.round(i/l)*l,c=Math.round(r/l)*l);const u={shape:{width:200,height:200},button:{width:200,height:60},text:{width:300,height:100},image:{width:300,height:200},video:{width:640,height:360},menu:{width:600,height:40}}[d.type]||{width:200,height:100},x=d.defaultProps.width||u.width,g=d.defaultProps.height||u.height;s=s-x/2,c=c-g/2;const{width:m,height:y,...b}=d.defaultProps,T={id:`widget-${Date.now()}-${Math.random()}`,type:d.type,x:Math.max(0,s),y:Math.max(0,c),width:x,height:g,zIndex:0,properties:b};a().addWidget(T),a().clearPendingWidget()},updateWidget:(i,r)=>{const{project:d}=a();d&&(t({project:{...d,widgets:d.widgets.map(o=>o.id===i?{...o,...r}:o),metadata:{...d.metadata,updatedAt:new Date().toISOString()}}}),U(a().saveProject))},deleteWidget:i=>{const{project:r}=a();r&&(a().saveToHistory(),t({project:{...r,widgets:r.widgets.filter(d=>d.id!==i),metadata:{...r.metadata,updatedAt:new Date().toISOString()}},selectedWidgetIds:a().selectedWidgetIds.filter(d=>d!==i)}),U(a().saveProject))},duplicateWidget:i=>{const{project:r}=a();if(!r)return;const d=r.widgets.find(n=>n.id===i);if(!d)return;const o={...d,id:`widget-${Date.now()}`,x:d.x+20,y:d.y+20};a().addWidget(o)},selectWidget:(i,r=!1)=>{const{selectedWidgetIds:d}=a();r?d.includes(i)?t({selectedWidgetIds:d.filter(o=>o!==i)}):t({selectedWidgetIds:[...d,i]}):t({selectedWidgetIds:[i]})},clearSelection:()=>{t({selectedWidgetIds:[]})},saveToHistory:()=>{const{project:i,history:r}=a();i&&t({history:{past:[...r.past,i],future:[]}})},undo:()=>{const{history:i,project:r}=a();if(i.past.length===0||!r)return;const d=i.past[i.past.length-1],o=i.past.slice(0,-1);t({project:d,history:{past:o,future:[r,...i.future]}}),U(a().saveProject)},redo:()=>{const{history:i,project:r}=a();if(i.future.length===0||!r)return;const d=i.future[0],o=i.future.slice(1);t({project:d,history:{past:[...i.past,r],future:o}}),U(a().saveProject)},copy:()=>{const{project:i,selectedWidgetIds:r}=a();if(!i)return;const d=i.widgets.filter(o=>r.includes(o.id));t({clipboard:d})},paste:()=>{const{clipboard:i,project:r}=a();if(!r||i.length===0)return;const d=i.map(o=>({...o,id:`widget-${Date.now()}-${Math.random()}`,x:o.x+20,y:o.y+20}));a().saveToHistory(),t({project:{...r,widgets:[...r.widgets,...d]},selectedWidgetIds:d.map(o=>o.id)}),U(a().saveProject)},cut:()=>{const{selectedWidgetIds:i}=a();a().copy(),i.forEach(r=>a().deleteWidget(r))},setZoom:i=>{t({zoom:Math.max(.1,Math.min(5,i))})},toggleGrid:()=>{t(i=>({gridEnabled:!i.gridEnabled}))},toggleSnapToGrid:()=>{t(i=>({snapToGrid:!i.snapToGrid}))},setGridSize:i=>{t({gridSize:Math.max(5,Math.min(100,i))})}}));typeof window<"u"&&window.addEventListener("beforeunload",()=>{Ie()});var st={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ot=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),at=(t,a)=>{const i=C.forwardRef(({color:r="currentColor",size:d=24,strokeWidth:o=2,absoluteStrokeWidth:n,children:l,...s},c)=>C.createElement("svg",{ref:c,...st,width:d,height:d,stroke:r,strokeWidth:n?Number(o)*24/Number(d):o,className:`lucide lucide-${ot(t)}`,...s},[...a.map(([p,u])=>C.createElement(p,u)),...(Array.isArray(l)?l:[l])||[]]));return i.displayName=`${t}`,i};var A=at;const ze=A("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),lt=A("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),ct=A("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),dt=A("FolderOpen",[["path",{d:"m6 14 1.45-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.55 6a2 2 0 0 1-1.94 1.5H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H18a2 2 0 0 1 2 2v2",key:"1nmvlm"}]]),ht=A("Grid",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}]]),pt=A("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),pe=A("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),We=A("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),ut=A("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),xt=A("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ft=A("Magnet",[["path",{d:"m6 15-4-4 6.75-6.77a7.79 7.79 0 0 1 11 11L13 22l-4-4 6.39-6.36a2.14 2.14 0 0 0-3-3L6 15",key:"1i3lhw"}],["path",{d:"m5 8 4 4",key:"j6kj7e"}],["path",{d:"m12 15 4 4",key:"lnac28"}]]),gt=A("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),mt=A("MousePointer",[["path",{d:"m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z",key:"y2ucgo"}],["path",{d:"m13 13 6 6",key:"1nhxnf"}]]),jt=A("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),yt=A("Redo2",[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5v0A5.5 5.5 0 0 0 9.5 20H13",key:"19mnr4"}]]),vt=A("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),bt=A("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),kt=A("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),St=A("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),Ct=A("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]),Nt=A("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Tt=A("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Et=A("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),wt=A("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),It=A("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),zt=A("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Wt=({onClose:t,onSuccess:a})=>{const[i,r]=C.useState(""),[d,o]=C.useState(!1),[n,l]=C.useState(null),s=x=>(x.replace(/[^A-Z0-9]/gi,"").toUpperCase().match(/.{1,4}/g)||[]).join("-").substring(0,19),c=x=>{const g=s(x.target.value);r(g),l(null)},p=async x=>{if(x.preventDefault(),i.length<19){l("–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π –∫–ª—é—á –ª–∏—Ü–µ–Ω–∑–∏–∏ (16 —Å–∏–º–≤–æ–ª–æ–≤)");return}o(!0),l(null);try{const g=await q.loginWithLicense(i);console.log("[Auth] Login successful:",g),a(g.license.organization.name,g.license.plan),t()}catch(g){console.error("[Auth] Login failed:",g),l(g.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ö–æ–¥. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á –ª–∏—Ü–µ–Ω–∑–∏–∏.")}finally{o(!1)}},u=x=>{x.preventDefault();const g=x.clipboardData.getData("text"),m=s(g);r(m)};return e.jsx("div",{className:"login-dialog-overlay",onClick:t,children:e.jsxs("div",{className:"login-dialog",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"login-dialog-header",children:[e.jsxs("div",{className:"login-dialog-title",children:[e.jsx(pe,{size:24}),e.jsx("h2",{children:"–í—Ö–æ–¥ –≤ Kiosk Editor"})]}),e.jsx("button",{className:"close-btn",onClick:t,title:"–ó–∞–∫—Ä—ã—Ç—å",children:e.jsx(wt,{size:20})})]}),e.jsxs("div",{className:"login-dialog-content",children:[e.jsx("p",{className:"login-description",children:"–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –ª–∏—Ü–µ–Ω–∑–∏–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä—É"}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"licenseKey",children:"–ö–ª—é—á –ª–∏—Ü–µ–Ω–∑–∏–∏"}),e.jsx("input",{type:"text",id:"licenseKey",placeholder:"XXXX-XXXX-XXXX-XXXX",value:i,onChange:c,onPaste:u,disabled:d,autoFocus:!0,maxLength:19,className:n?"error":""}),e.jsx("span",{className:"input-hint",children:"–§–æ—Ä–º–∞—Ç: 4 –≥—Ä—É–ø–ø—ã –ø–æ 4 —Å–∏–º–≤–æ–ª–∞"})]}),n&&e.jsxs("div",{className:"error-message",children:[e.jsx(ze,{size:16}),e.jsx("span",{children:n})]}),e.jsx("button",{type:"submit",className:"login-btn",disabled:d||i.length<19,children:d?e.jsxs(e.Fragment,{children:[e.jsx(We,{size:18,className:"spinner"}),e.jsx("span",{children:"–í—Ö–æ–¥..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{size:18}),e.jsx("span",{children:"–í–æ–π—Ç–∏"})]})})]}),e.jsxs("div",{className:"test-keys-hint",children:[e.jsx("p",{children:"–¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"BASIC:"})," ",e.jsx("code",{children:"EWZA-E5LJ-Z558-9LUQ"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PRO:"})," ",e.jsx("code",{children:"3VBN-8ZQ9-1MKO-AK0R"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"MAX:"})," ",e.jsx("code",{children:"T8MH-FJE3-ETAC-YOZF"})]})]})]})]})]})})},Rt=()=>{const{isSaving:t,lastSaved:a,saveError:i}=O(),d=i?"error":t?"saving":a?"saved":"idle",o=l=>{const c=new Date().getTime()-l.getTime(),p=Math.floor(c/1e3),u=Math.floor(p/60);return p<10?"–¢–æ–ª—å–∫–æ —á—Ç–æ":p<60?`${p} —Å–µ–∫ –Ω–∞–∑–∞–¥`:u===1?"1 –º–∏–Ω –Ω–∞–∑–∞–¥":u<60?`${u} –º–∏–Ω –Ω–∞–∑–∞–¥`:l.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})},n=()=>{switch(d){case"saving":return e.jsxs(e.Fragment,{children:[e.jsx(We,{size:16,className:"spinner"}),e.jsx("span",{children:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ..."})]});case"saved":return e.jsxs(e.Fragment,{children:[e.jsx(lt,{size:16}),e.jsxs("span",{children:["–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ",a&&o(a)]})]});case"error":return e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:16}),e.jsx("span",{title:i||void 0,children:"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è"})]});default:return e.jsxs(e.Fragment,{children:[e.jsx(ct,{size:16}),e.jsx("span",{children:"–ù–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ"})]})}};return e.jsx("div",{className:`autosave-indicator status-${d}`,children:n()})},Pt=()=>{const{project:t,history:a,zoom:i,gridEnabled:r,snapToGrid:d,undo:o,redo:n,setZoom:l,toggleGrid:s,toggleSnapToGrid:c,saveProject:p}=O(),[u,x]=C.useState(!1),[g,m]=C.useState(null),[y,b]=C.useState(null),[T,N]=C.useState(!1);C.useEffect(()=>{(async()=>{if(q.isAuthenticated())try{const _=await q.verifyToken();x(!!_)}catch{x(!1)}else N(!0)})();const S=()=>{x(!1),m(null),b(null),N(!0)};return window.addEventListener("auth:logout",S),window.addEventListener("auth:unauthorized",S),()=>{window.removeEventListener("auth:logout",S),window.removeEventListener("auth:unauthorized",S)}},[]);const k=(f,S)=>{x(!0),m(f),b(S),console.log("[Toolbar] Login successful:",f,S)},w=()=>{confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?")&&(q.logout(),x(!1),m(null),b(null),N(!0))},P=async()=>{if(t)try{await p()}catch(f){console.error("[Toolbar] Save failed:",f),alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç")}},I=()=>l(i+.1),h=()=>l(i-.1),j=()=>l(1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-section",children:[u?e.jsxs("div",{className:"auth-section authenticated",children:[e.jsxs("div",{className:"user-info",children:[e.jsx(Tt,{size:16}),e.jsxs("div",{className:"user-details",children:[e.jsx("span",{className:"org-name",children:g||"Organization"}),e.jsx("span",{className:"plan-badge",children:y||"BASIC"})]})]}),e.jsx("button",{className:"toolbar-btn logout-btn",onClick:w,title:"–í—ã–π—Ç–∏",children:e.jsx(xt,{size:18})})]}):e.jsxs("button",{className:"toolbar-btn login-btn",onClick:()=>N(!0),title:"–í–æ–π—Ç–∏",children:[e.jsx(pe,{size:18}),e.jsx("span",{children:"–í–æ–π—Ç–∏"})]}),e.jsx("div",{className:"toolbar-divider"}),e.jsxs("button",{className:"toolbar-btn",onClick:P,disabled:!t||!u,title:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å (Ctrl+S)",children:[e.jsx(vt,{size:18}),e.jsx("span",{children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"})]}),e.jsxs("button",{className:"toolbar-btn",disabled:!u,title:"–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç",children:[e.jsx(dt,{size:18}),e.jsx("span",{children:"–û—Ç–∫—Ä—ã—Ç—å"})]})]}),e.jsxs("div",{className:"toolbar-section",children:[e.jsx("button",{className:"toolbar-btn",onClick:o,disabled:a.past.length===0,title:"–û—Ç–º–µ–Ω–∏—Ç—å (Ctrl+Z)",children:e.jsx(Ct,{size:18})}),e.jsx("button",{className:"toolbar-btn",onClick:n,disabled:a.future.length===0,title:"–í–µ—Ä–Ω—É—Ç—å (Ctrl+Shift+Z)",children:e.jsx(yt,{size:18})}),e.jsx("div",{className:"toolbar-divider"}),e.jsx("button",{className:"toolbar-btn",onClick:h,disabled:i<=.1,title:"–£–º–µ–Ω—å—à–∏—Ç—å (Ctrl+-)",children:e.jsx(zt,{size:18})}),e.jsxs("button",{className:"toolbar-btn zoom-display",onClick:j,title:"–°–±—Ä–æ—Å–∏—Ç—å –º–∞—Å—à—Ç–∞–± (Ctrl+0)",children:[Math.round(i*100),"%"]}),e.jsx("button",{className:"toolbar-btn",onClick:I,disabled:i>=5,title:"–£–≤–µ–ª–∏—á–∏—Ç—å (Ctrl+=)",children:e.jsx(It,{size:18})}),e.jsx("div",{className:"toolbar-divider"}),e.jsx("button",{className:`toolbar-btn ${r?"active":""}`,onClick:s,title:"–ü–æ–∫–∞–∑–∞—Ç—å —Å–µ—Ç–∫—É",children:e.jsx(ht,{size:18})}),e.jsx("button",{className:`toolbar-btn ${d?"active":""}`,onClick:c,title:"–ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Å–µ—Ç–∫–µ",children:e.jsx(ft,{size:18})})]}),e.jsxs("div",{className:"toolbar-section",children:[u&&t&&e.jsx(Rt,{}),e.jsx("div",{className:"toolbar-divider"}),e.jsxs("button",{className:"toolbar-btn preview-btn",disabled:!t,title:"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä",children:[e.jsx(jt,{size:18}),e.jsx("span",{children:"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä"})]})]})]}),T&&e.jsx(Wt,{onClose:()=>u?N(!1):null,onSuccess:k})]})},Re=({widget:t,image:a})=>{const i=C.useRef(null),{clipShape:r="rectangle",cornerRadius:d=0,opacity:o=1}=t.properties;return C.useEffect(()=>{if(!i.current||!a)return;const n=i.current,l=document.createElement("canvas"),s=l.getContext("2d");if(!s)return;l.width=t.width,l.height=t.height,s.clearRect(0,0,l.width,l.height),s.save();const c=t.width/2,p=t.height/2,u=Math.min(t.width,t.height)/2;switch(r){case"circle":s.beginPath(),s.arc(c,p,u,0,Math.PI*2),s.closePath();break;case"ellipse":s.beginPath(),s.ellipse(c,p,t.width/2,t.height/2,0,0,Math.PI*2),s.closePath();break;case"triangle":s.beginPath(),s.moveTo(c,p-u),s.lineTo(c+u*Math.cos(Math.PI/6),p+u*Math.sin(Math.PI/6)),s.lineTo(c-u*Math.cos(Math.PI/6),p+u*Math.sin(Math.PI/6)),s.closePath();break;case"diamond":s.beginPath(),s.moveTo(c,p-u),s.lineTo(c+u,p),s.lineTo(c,p+u),s.lineTo(c-u,p),s.closePath();break;case"pentagon":he(s,c,p,u,5);break;case"hexagon":he(s,c,p,u,6);break;case"octagon":he(s,c,p,u,8);break;case"rounded-rectangle":At(s,0,0,t.width,t.height,d||20);break;default:s.rect(0,0,t.width,t.height);break}s.clip();const x=a.width/a.height,g=t.width/t.height;let m,y,b,T;x>g?(y=t.height,m=a.width*(t.height/a.height),b=(t.width-m)/2,T=0):(m=t.width,y=a.height*(t.width/a.width),b=0,T=(t.height-y)/2),s.drawImage(a,b,T,m,y),s.restore();const N=new window.Image;N.src=l.toDataURL(),N.onload=()=>{n&&(n.image(N),n.getLayer()?.batchDraw())}},[a,t.width,t.height,r,d]),a?e.jsx(re,{ref:i,width:t.width,height:t.height,opacity:o,listening:!1}):null};function he(t,a,i,r,d){t.beginPath();for(let o=0;o<d;o++){const n=o*2*Math.PI/d-Math.PI/2,l=a+r*Math.cos(n),s=i+r*Math.sin(n);o===0?t.moveTo(l,s):t.lineTo(l,s)}t.closePath()}function At(t,a,i,r,d,o){t.beginPath(),t.moveTo(a+o,i),t.lineTo(a+r-o,i),t.quadraticCurveTo(a+r,i,a+r,i+o),t.lineTo(a+r,i+d-o),t.quadraticCurveTo(a+r,i+d,a+r-o,i+d),t.lineTo(a+o,i+d),t.quadraticCurveTo(a,i+d,a,i+d-o),t.lineTo(a,i+o),t.quadraticCurveTo(a,i,a+o,i),t.closePath()}const Lt=({widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o})=>{const n=C.useRef(null),[l,s]=C.useState({}),[c,p]=C.useState(0),[u,x]=C.useState(!1),g=C.useRef(),{sources:m=[],autoSwitch:y=!1,switchInterval:b=3,transition:T="fade",clipShape:N="rectangle",loop:k=!0}=t.properties;C.useEffect(()=>{const h={};let j=0;return m.forEach(f=>{const S=new window.Image;S.crossOrigin="anonymous",S.onload=()=>{h[f.id]=S,j++,j===m.length&&s({...h})},S.onerror=()=>{console.error("Failed to load image:",f.value),j++,j===m.length&&s({...h})},S.src=f.value}),()=>{Object.values(h).forEach(f=>{f.onload=null,f.onerror=null})}},[m]),C.useEffect(()=>{if(!y||m.length<=1){g.current&&clearInterval(g.current);return}return g.current=setInterval(()=>{p(h=>{const j=h+1;return j>=m.length?k?0:h:j})},b*1e3),()=>{g.current&&clearInterval(g.current)}},[y,b,m.length,k]);const w=t.locked||!1,P=m[c],I=P?l[P.id]:null;return e.jsxs(G,{ref:n,id:t.id,x:t.x,y:t.y,width:t.width,height:t.height,rotation:t.rotation||0,draggable:!w,dragBoundFunc:o,opacity:w?.6:1,onClick:i,onTap:i,onDragEnd:r,onTransformEnd:d,children:[e.jsx(E,{width:t.width,height:t.height,fill:"transparent",listening:!0}),(!I||m.length===0)&&e.jsx(E,{width:t.width,height:t.height,fill:"#9b59b6",listening:!1}),I&&(N&&N!=="rectangle"?e.jsx(Re,{widget:t,image:I}):e.jsx(re,{image:I,x:0,y:0,width:t.width,height:t.height,listening:!1})),a&&e.jsx(E,{width:t.width,height:t.height,stroke:"#007acc",strokeWidth:2,listening:!1}),m.length>1&&e.jsx(E,{x:t.width-40,y:t.height-20,width:35,height:15,fill:"rgba(0, 0, 0, 0.7)",cornerRadius:3,listening:!1}),m.length>1&&e.jsx(re,{x:t.width-35,y:t.height-18,width:10,height:10,image:(()=>{const h=document.createElement("canvas");h.width=10,h.height=10;const j=h.getContext("2d");j&&(j.fillStyle="#fff",j.font="10px Arial",j.fillText("üì∑",0,9));const f=new window.Image;return f.src=h.toDataURL(),f})(),listening:!1})]})},Ft=({widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o})=>{if(t.properties.galleryMode)return e.jsx(Lt,{widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o});const[n,l]=C.useState(null),s=C.useRef(null),{clipShape:c="rectangle"}=t.properties;C.useEffect(()=>{if(!t.properties.src){l(null);return}const k=new window.Image;return k.crossOrigin="anonymous",k.onload=()=>{l(k)},k.onerror=()=>{console.error("Failed to load image:",t.properties.src),l(null)},k.src=t.properties.src,()=>{k.onload=null,k.onerror=null}},[t.properties.src]),C.useEffect(()=>{if(!n||t.properties.objectFit!=="adaptive")return;const{updateWidget:k}=O.getState(),w=n.width/n.height,P=t.width/t.height;if(Math.abs(w-P)>.01){const I=t.width/w;k(t.id,{height:Math.round(I)})}},[n,t.properties.objectFit,t.width,t.height,t.id]);const u=(()=>{if(!n)return null;const{width:k,height:w}=t,{objectFit:P="contain"}=t.properties,I=n.width/n.height,h=k/w;let j=0,f=0,S=n.width,M=n.height;switch(P){case"cover":{I>h?(S=n.height*h,j=(n.width-S)/2):(M=n.width/h,f=(n.height-M)/2);break}case"contain":break;case"fill":break;case"scale-down":{n.width<=k&&n.height<=w&&(S=n.width,M=n.height);break}}return{cropX:j,cropY:f,cropWidth:S,cropHeight:M}})(),{borderEnabled:x,borderStyle:g,borderWidth:m=2,borderColor:y="#000000"}=t.properties,b=k=>{switch(k){case"dashed":return[10,5];case"dotted":return[2,2];case"double":return[];default:return[]}},T=k=>{s.current&&d(k)},N=t.locked||!1;return e.jsxs(G,{ref:s,id:t.id,x:t.x,y:t.y,width:t.width,height:t.height,rotation:t.rotation||0,draggable:!N,dragBoundFunc:o,opacity:N?.6:1,onClick:i,onTap:i,onDragEnd:r,onTransformEnd:T,children:[e.jsx(E,{width:t.width,height:t.height,fill:"transparent",listening:!0}),!n&&e.jsx(E,{width:t.width,height:t.height,fill:"#9b59b6",listening:!1}),n&&(c&&c!=="rectangle"?e.jsx(Re,{widget:t,image:n}):u&&e.jsx(re,{image:n,x:0,y:0,width:t.width,height:t.height,crop:{x:u.cropX,y:u.cropY,width:u.cropWidth,height:u.cropHeight},listening:!1})),a&&e.jsx(E,{width:t.width,height:t.height,stroke:"#007acc",strokeWidth:2,listening:!1}),x&&e.jsx(E,{width:t.width,height:t.height,stroke:y,strokeWidth:m,dash:b(g),listening:!1})]})},Mt=({widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o})=>{const n=C.useRef(null),l=C.useRef(null),{text:s="Button",backgroundColor:c="#2ecc71",textColor:p="#ffffff",fontSize:u=16,fontFamily:x="Arial",fontWeight:g="normal",fontStyle:m="normal",textAlign:y="center",borderRadius:b=8,borderWidth:T=0,borderColor:N="#000000",borderStyle:k="solid",paddingX:w=16,paddingY:P=8,shadowEnabled:I=!1,shadowColor:h="#000000",shadowBlur:j=10,shadowOffsetX:f=0,shadowOffsetY:S=4,shadowOpacity:M=.3}=t.properties,_=t.locked||!1,L=()=>{switch(k){case"dashed":return[10,5];case"dotted":return[3,3];default:return[]}};return e.jsxs(G,{ref:n,id:t.id,x:t.x,y:t.y,width:t.width,height:t.height,rotation:t.rotation||0,draggable:!_,dragBoundFunc:o,opacity:_?.6:1,onClick:i,onTap:i,onDragEnd:r,onTransformEnd:d,children:[I&&e.jsx(E,{x:f,y:S,width:t.width,height:t.height,cornerRadius:b,fill:h,opacity:M,blur:j,listening:!1}),e.jsx(E,{width:t.width,height:t.height,fill:c,cornerRadius:b,stroke:T>0?N:void 0,strokeWidth:T,dash:L(),listening:!1}),e.jsx(F,{ref:l,text:s,x:w,y:0,width:t.width-w*2,height:t.height,fontSize:u,fontFamily:x,fontStyle:g==="bold"?"bold":m,fill:p,align:y,verticalAlign:"middle",listening:!1}),e.jsx(E,{width:t.width,height:t.height,fill:"transparent",listening:!0}),a&&e.jsx(E,{width:t.width,height:t.height,stroke:"#007acc",strokeWidth:2,cornerRadius:b,listening:!1})]})},Dt=({widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o})=>{const n=C.useRef(null),{text:l="Text",fontSize:s=16,fontFamily:c="Arial",fontWeight:p="normal",fontStyle:u="normal",textAlign:x="left",verticalAlign:g="top",textColor:m="#000000",backgroundColor:y="#ffffff",lineHeight:b=1.2,padding:T=8,textDecoration:N="none"}=t.properties,k=t.locked||!1,w=()=>N==="underline"?"underline":N==="line-through"?"line-through":"";return e.jsxs(G,{ref:n,id:t.id,x:t.x,y:t.y,width:t.width,height:t.height,rotation:t.rotation||0,draggable:!k,dragBoundFunc:o,opacity:k?.6:1,onClick:i,onTap:i,onDragEnd:r,onTransformEnd:d,children:[y!=="transparent"&&e.jsx(E,{width:t.width,height:t.height,fill:y,listening:!1}),e.jsx(F,{text:l,x:T,y:T,width:t.width-T*2,height:t.height-T*2,fontSize:s,fontFamily:c,fontStyle:p==="bold"?"bold":u,fill:m,align:x,verticalAlign:g,lineHeight:b,textDecoration:w(),listening:!1}),e.jsx(E,{width:t.width,height:t.height,fill:"transparent",listening:!0}),a&&e.jsx(E,{width:t.width,height:t.height,stroke:"#007acc",strokeWidth:2,listening:!1})]})},Ot=({widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o})=>{const n=C.useRef(null),[l,s]=C.useState(0),{sources:c=[],autoNext:p=!0,loop:u=!0}=t.properties,x=t.locked||!1;return c[l],e.jsxs(G,{ref:n,id:t.id,x:t.x,y:t.y,width:t.width,height:t.height,rotation:t.rotation||0,draggable:!x,dragBoundFunc:o,opacity:x?.6:1,onClick:i,onTap:i,onDragEnd:r,onTransformEnd:d,children:[e.jsx(E,{width:t.width,height:t.height,fill:"transparent",listening:!0}),e.jsx(E,{width:t.width,height:t.height,fill:"#000000",listening:!1}),e.jsx(F,{x:t.width/2,y:t.height/2-30,text:"‚ñ∂",fontSize:60,fill:"#ffffff",align:"center",width:t.width,offsetX:t.width/2,listening:!1}),e.jsx(F,{x:0,y:t.height/2+40,text:"PLAYLIST",fontSize:16,fill:"#ffffff",align:"center",width:t.width,listening:!1}),a&&e.jsx(E,{width:t.width,height:t.height,stroke:"#007acc",strokeWidth:2,listening:!1}),c.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(E,{x:t.width-50,y:t.height-25,width:45,height:20,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:4,listening:!1}),e.jsx(F,{x:t.width-48,y:t.height-21,text:`üé¨ ${c.length}`,fontSize:12,fill:"#ffffff",listening:!1})]})]})},$t=({widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o})=>{if(t.properties.playlistMode)return e.jsx(Ot,{widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o});const n=C.useRef(null),l=C.useRef(null),[s,c]=C.useState(null),p=C.useRef(),{sourceType:u="url",src:x="",rtspUrl:g="",isLocalFile:m=!1,fileName:y="",objectFit:b="contain",borderEnabled:T=!1,borderStyle:N="solid",borderWidth:k=2,borderColor:w="#000000",autoplay:P=!1,loop:I=!1,muted:h=!0,controls:j=!1}=t.properties;C.useEffect(()=>{const v=document.createElement("video");return v.crossOrigin="anonymous",v.loop=I,v.muted=h,v.playsInline=!0,u==="url"&&x?(v.src=x,v.onloadedmetadata=()=>{c(v),P&&v.play().catch(z=>{console.log("Autoplay prevented:",z)})},v.onerror=()=>{console.error("Failed to load video:",x),c(null)}):c(null),l.current=v,()=>{p.current&&cancelAnimationFrame(p.current),v.pause(),v.src="",v.load()}},[x,u,P,I,h]),C.useEffect(()=>{if(!s)return;const v=()=>{const z=n.current?.getLayer();z&&z.batchDraw(),p.current=requestAnimationFrame(v)};return p.current=requestAnimationFrame(v),()=>{p.current&&cancelAnimationFrame(p.current)}},[s]),C.useEffect(()=>{if(b!=="adaptive"||!s)return;const{updateWidget:v}=O.getState(),z=s.videoWidth/s.videoHeight||16/9,$=t.width/t.height;if(Math.abs(z-$)>.01){const B=t.width/z;v(t.id,{height:Math.round(B)})}},[b,s,t.width,t.height,t.id]);const S=(()=>{if(!s||s.videoWidth===0)return null;const{width:v,height:z}=t,$=s.videoWidth/s.videoHeight,B=v/z;let H=0,D=0,J=s.videoWidth,V=s.videoHeight,K=0,ne=0,Y=v,Z=z;switch(b){case"cover":{$>B?(J=s.videoHeight*B,H=(s.videoWidth-J)/2):(V=s.videoWidth/B,D=(s.videoHeight-V)/2);break}case"contain":{$>B?(Z=v/$,ne=(z-Z)/2):(Y=z*$,K=(v-Y)/2);break}case"scale-down":{s.videoWidth<=v&&s.videoHeight<=z?(Y=s.videoWidth,Z=s.videoHeight,K=(v-Y)/2,ne=(z-Z)/2):$>B?(Z=v/$,ne=(z-Z)/2):(Y=z*$,K=(v-Y)/2);break}}return{crop:{x:H,y:D,width:J,height:V},position:{x:K,y:ne,width:Y,height:Z}}})(),M=v=>{switch(v){case"dashed":return[10,5];case"dotted":return[2,2];case"double":return[];default:return[]}},_=v=>{n.current&&d(v)},L=v=>{i(v),j&&s&&(s.paused?s.play():s.pause())},R=t.locked||!1,W=()=>u==="rtsp"&&g?`üìπ RTSP
${g.substring(0,30)}...`:u==="url"&&x?m&&y?`üìÅ ${y}`:`üé• –í–∏–¥–µ–æ
${x.substring(0,30)}...`:`üé• –í–∏–¥–µ–æ
–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏`;return e.jsxs(G,{ref:n,id:t.id,x:t.x,y:t.y,width:t.width,height:t.height,rotation:t.rotation||0,draggable:!R,dragBoundFunc:o,opacity:R?.6:1,onClick:L,onTap:L,onDragEnd:r,onTransformEnd:_,children:[e.jsx(E,{width:t.width,height:t.height,fill:"transparent",listening:!0}),e.jsx(E,{width:t.width,height:t.height,fill:u==="rtsp"?"#2c3e50":"#f39c12",listening:!1}),s&&S?e.jsx(re,{image:s,x:S.position.x,y:S.position.y,width:S.position.width,height:S.position.height,crop:S.crop,listening:!1}):e.jsx(F,{text:W(),x:0,y:0,width:t.width,height:t.height,fontSize:14,fontFamily:"Arial",fill:"#ffffff",align:"center",verticalAlign:"middle",listening:!1}),u==="rtsp"&&e.jsx(E,{x:10,y:10,width:45,height:20,fill:"#ff0000",cornerRadius:4,listening:!1}),u==="rtsp"&&e.jsx(F,{text:"LIVE",x:10,y:13,width:45,fontSize:12,fontFamily:"Arial",fontWeight:"bold",fill:"#ffffff",align:"center",listening:!1}),s&&!s.paused&&e.jsx(F,{text:"‚ñ∂",x:t.width-30,y:10,fontSize:16,fontFamily:"Arial",fill:"#00ff00",listening:!1}),j&&s&&e.jsx(F,{text:s.paused?"‚è∏ –ü–∞—É–∑–∞":"‚ñ∂ –ò–≥—Ä–∞–µ—Ç",x:10,y:t.height-30,fontSize:12,fontFamily:"Arial",fill:"#ffffff",listening:!1}),a&&e.jsx(E,{width:t.width,height:t.height,stroke:"#007acc",strokeWidth:2,listening:!1}),T&&e.jsx(E,{width:t.width,height:t.height,stroke:w,strokeWidth:k,dash:M(N),listening:!1})]})},Bt=({widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o})=>{const n=C.useRef(null),{shapeType:l="rectangle",fillColor:s="#4a90e2",strokeColor:c="#2c3e50",strokeWidth:p=0,cornerRadius:u=0,opacity:x=1}=t.properties,g=t.locked||!1,m=()=>{const y={fill:s,stroke:p>0?c:void 0,strokeWidth:p,opacity:x,listening:!1};switch(l){case"rectangle":return e.jsx(E,{x:0,y:0,width:t.width,height:t.height,cornerRadius:u,...y});case"circle":const b=Math.min(t.width,t.height)/2;return e.jsx(Fe,{x:t.width/2,y:t.height/2,radius:b,...y});case"ellipse":return e.jsx(Le,{x:t.width/2,y:t.height/2,radiusX:t.width/2,radiusY:t.height/2,...y});case"triangle":return e.jsx(ie,{x:t.width/2,y:t.height/2,sides:3,radius:Math.min(t.width,t.height)/2,...y});case"pentagon":return e.jsx(ie,{x:t.width/2,y:t.height/2,sides:5,radius:Math.min(t.width,t.height)/2,...y});case"hexagon":return e.jsx(ie,{x:t.width/2,y:t.height/2,sides:6,radius:Math.min(t.width,t.height)/2,...y});case"star":return e.jsx(Ae,{x:t.width/2,y:t.height/2,numPoints:5,innerRadius:Math.min(t.width,t.height)/4,outerRadius:Math.min(t.width,t.height)/2,...y});case"diamond":return e.jsx(ie,{x:t.width/2,y:t.height/2,sides:4,radius:Math.min(t.width,t.height)/2,rotation:45,...y});case"line":return e.jsx(te,{points:[0,t.height/2,t.width,t.height/2],stroke:c,strokeWidth:Math.max(p,2),opacity:x,listening:!1});case"arrow":const T=t.width,N=t.height,k=N*.6,w=N*.4;return e.jsx(te,{points:[0,N/2-w/2,T-k,N/2-w/2,T-k,0,T,N/2,T-k,N,T-k,N/2+w/2,0,N/2+w/2],closed:!0,fill:s,stroke:p>0?c:void 0,strokeWidth:p,opacity:x,listening:!1});default:return e.jsx(E,{x:0,y:0,width:t.width,height:t.height,...y})}};return e.jsxs(G,{ref:n,id:t.id,x:t.x,y:t.y,width:t.width,height:t.height,rotation:t.rotation||0,draggable:!g,dragBoundFunc:o,opacity:g?.6:1,onClick:i,onTap:i,onDragEnd:r,onTransformEnd:d,children:[e.jsx(E,{width:t.width,height:t.height,fill:"transparent",listening:!0}),m(),a&&e.jsx(E,{width:t.width,height:t.height,stroke:"#007acc",strokeWidth:2,listening:!1})]})},_t=({widget:t,isSelected:a,onSelect:i,onDragEnd:r,onTransformEnd:d,dragBoundFunc:o})=>{const n=C.useRef(null),[l,s]=C.useState(null),[c,p]=C.useState(null),{orientation:u="horizontal",items:x=[{id:"1",label:"–ì–ª–∞–≤–Ω–∞—è"},{id:"2",label:"–û –Ω–∞—Å"},{id:"3",label:"–£—Å–ª—É–≥–∏",children:[{id:"3-1",label:"–£—Å–ª—É–≥–∞ 1"},{id:"3-2",label:"–£—Å–ª—É–≥–∞ 2"}]},{id:"4",label:"–ö–æ–Ω—Ç–∞–∫—Ç—ã"}],backgroundColor:g="#2c3e50",textColor:m="#ffffff",hoverColor:y="#34495e",fontSize:b=16,fontFamily:T="Arial",itemPadding:N=16,submenuBackgroundColor:k="#34495e",submenuTextColor:w="#ffffff",borderWidth:P=0,borderColor:I="#000000",itemHeight:h=40}=t.properties,j=t.locked||!1,f=u==="horizontal",S=L=>L.length*(b*.6)+N*2,M=()=>{const L=[];let R=0;return x.forEach((W,v)=>{const z=S(W.label),$=l===W.id,B=c===W.id,H=W.children&&W.children.length>0;L.push(e.jsx(E,{x:R,y:0,width:z,height:h,fill:$?y:g,listening:!0,onMouseEnter:()=>s(W.id),onMouseLeave:()=>s(null),onClick:()=>{H&&p(c===W.id?null:W.id)}},`bg-${W.id}`)),L.push(e.jsx(F,{x:R,y:0,width:z,height:h,text:W.label,fontSize:b,fontFamily:T,fill:m,align:"center",verticalAlign:"middle",listening:!1},`text-${W.id}`)),H&&L.push(e.jsx(F,{x:R+z-20,y:0,width:20,height:h,text:"‚ñº",fontSize:10,fill:m,align:"center",verticalAlign:"middle",listening:!1},`arrow-${W.id}`)),v<x.length-1&&L.push(e.jsx(te,{points:[R+z,5,R+z,h-5],stroke:I,strokeWidth:1,opacity:.3,listening:!1},`divider-${W.id}`)),B&&H&&W.children.forEach((D,J)=>{const V=h+J*h,K=Math.max(z,S(D.label));L.push(e.jsx(E,{x:R,y:V,width:K,height:h,fill:k,listening:!0,onMouseEnter:()=>s(D.id),onMouseLeave:()=>s(null)},`submenu-bg-${D.id}`)),L.push(e.jsx(F,{x:R+N/2,y:V,width:K-N/2,height:h,text:D.label,fontSize:b-2,fontFamily:T,fill:w,align:"left",verticalAlign:"middle",listening:!1},`submenu-text-${D.id}`))}),R+=z}),L},_=()=>{const L=[];let R=0;const W=t.width;return x.forEach((v,z)=>{const $=l===v.id,B=c===v.id,H=v.children&&v.children.length>0;L.push(e.jsx(E,{x:0,y:R,width:W,height:h,fill:$?y:g,listening:!0,onMouseEnter:()=>s(v.id),onMouseLeave:()=>s(null),onClick:()=>{H&&p(c===v.id?null:v.id)}},`bg-${v.id}`)),L.push(e.jsx(F,{x:N,y:R,width:W-N*2-(H?20:0),height:h,text:v.label,fontSize:b,fontFamily:T,fill:m,align:"left",verticalAlign:"middle",listening:!1},`text-${v.id}`)),H&&L.push(e.jsx(F,{x:W-20,y:R,width:20,height:h,text:B?"‚ñº":"‚ñ∂",fontSize:10,fill:m,align:"center",verticalAlign:"middle",listening:!1},`arrow-${v.id}`)),R+=h,z<x.length-1&&!B&&L.push(e.jsx(te,{points:[10,R,W-10,R],stroke:I,strokeWidth:1,opacity:.3,listening:!1},`divider-${v.id}`)),B&&H&&(v.children.forEach((D,J)=>{const V=l===D.id;L.push(e.jsx(E,{x:0,y:R,width:W,height:h,fill:V?y:k,listening:!0,onMouseEnter:()=>s(D.id),onMouseLeave:()=>s(null)},`submenu-bg-${D.id}`)),L.push(e.jsx(F,{x:N*2,y:R,width:W-N*3,height:h,text:D.label,fontSize:b-2,fontFamily:T,fill:w,align:"left",verticalAlign:"middle",listening:!1},`submenu-text-${D.id}`)),R+=h}),z<x.length-1&&L.push(e.jsx(te,{points:[10,R,W-10,R],stroke:I,strokeWidth:1,opacity:.3,listening:!1},`divider-after-${v.id}`)))}),L};return e.jsxs(G,{ref:n,id:t.id,x:t.x,y:t.y,width:t.width,height:t.height,rotation:t.rotation||0,draggable:!j,dragBoundFunc:o,opacity:j?.6:1,onClick:i,onTap:i,onDragEnd:r,onTransformEnd:d,children:[e.jsx(E,{width:t.width,height:t.height,fill:"transparent",listening:!0}),e.jsx(E,{width:t.width,height:t.height,fill:g,listening:!1}),P>0&&e.jsx(E,{width:t.width,height:t.height,stroke:I,strokeWidth:P,listening:!1}),f?M():_(),a&&e.jsx(E,{width:t.width,height:t.height,stroke:"#007acc",strokeWidth:2,listening:!1})]})},Ht={shape:"#4a90e2",rectangle:"#4a90e2",button:"#2ecc71",text:"#e74c3c",image:"#9b59b6",video:"#f39c12"},qt=()=>{const{project:t,selectedWidgetIds:a,selectWidget:i,clearSelection:r,updateWidget:d,zoom:o,gridEnabled:n,snapToGrid:l,gridSize:s,gridLineWidth:c,gridColor:p,pendingWidget:u,addWidgetAtPosition:x,clearPendingWidget:g}=O(),m=C.useRef(null),y=C.useRef(null),b=h=>l?Math.round(h/s)*s:h,T=h=>({x:b(h.x),y:b(h.y)});if(C.useEffect(()=>{if(!y.current||!t)return;const h=m.current,j=a.map(f=>t.widgets.find(M=>M.id===f)?.locked?null:h.findOne(`#${f}`)).filter(Boolean);y.current.nodes(j),y.current.getLayer().batchDraw()},[a,t]),!t)return null;const N=h=>{if(u){const S=h.target.getStage().getPointerPosition();S&&x(S.x,S.y);return}(h.target===h.target.getStage()||h.target.attrs.id==="canvas-background")&&r()},k=(h,j)=>{j.cancelBubble=!0;const f=j.evt.ctrlKey||j.evt.metaKey;i(h,f)},w=(h,j)=>{const f=b(j.target.x()),S=b(j.target.y());d(h,{x:f,y:S})},P=(h,j)=>{const f=j.target,S=f.scaleX(),M=f.scaleY();f.scaleX(1),f.scaleY(1);const _=f.width?f.width():f.attrs.width||100,L=f.height?f.height():f.attrs.height||100;let R=Math.max(10,_*S),W=Math.max(10,L*M),v=f.x(),z=f.y();l&&(R=b(R),W=b(W),v=b(v),z=b(z)),d(h,{x:v,y:z,width:R,height:W,rotation:f.rotation()})},I=()=>{if(!n)return null;const h=[],{width:j,height:f}=t.canvas;for(let S=0;S<=j/s;S++)h.push(e.jsx(E,{x:S*s,y:0,width:c,height:f,fill:p},`v-${S}`));for(let S=0;S<=f/s;S++)h.push(e.jsx(E,{x:0,y:S*s,width:j,height:c,fill:p},`h-${S}`));return h};return e.jsxs("div",{className:"canvas-container",children:[e.jsx("div",{className:"canvas-scroll",children:e.jsx("div",{className:"canvas-wrapper",style:{transform:`scale(${o})`,transformOrigin:"top left",cursor:u?"crosshair":"default"},children:e.jsx(Me,{ref:m,width:t.canvas.width,height:t.canvas.height,onClick:N,onTap:N,children:e.jsxs(De,{children:[e.jsx(E,{id:"canvas-background",x:0,y:0,width:t.canvas.width,height:t.canvas.height,fill:t.canvas.backgroundColor||"#ffffff"}),I(),t.widgets.slice().sort((h,j)=>(h.zIndex||0)-(j.zIndex||0)).map(h=>{const j=h.locked||!1;return h.type==="image"?e.jsxs(X.Fragment,{children:[e.jsx(Ft,{widget:h,isSelected:a.includes(h.id),onSelect:f=>k(h.id,f),onDragEnd:f=>w(h.id,f),onTransformEnd:f=>P(h.id,f),dragBoundFunc:l?T:void 0}),j&&e.jsx(F,{x:h.x+5,y:h.y+5,text:"üîí",fontSize:16,listening:!1})]},h.id):h.type==="button"?e.jsxs(X.Fragment,{children:[e.jsx(Mt,{widget:h,isSelected:a.includes(h.id),onSelect:f=>k(h.id,f),onDragEnd:f=>w(h.id,f),onTransformEnd:f=>P(h.id,f),dragBoundFunc:l?T:void 0}),j&&e.jsx(F,{x:h.x+5,y:h.y+5,text:"üîí",fontSize:16,listening:!1})]},h.id):h.type==="text"?e.jsxs(X.Fragment,{children:[e.jsx(Dt,{widget:h,isSelected:a.includes(h.id),onSelect:f=>k(h.id,f),onDragEnd:f=>w(h.id,f),onTransformEnd:f=>P(h.id,f),dragBoundFunc:l?T:void 0}),j&&e.jsx(F,{x:h.x+5,y:h.y+5,text:"üîí",fontSize:16,listening:!1})]},h.id):h.type==="video"?e.jsxs(X.Fragment,{children:[e.jsx($t,{widget:h,isSelected:a.includes(h.id),onSelect:f=>k(h.id,f),onDragEnd:f=>w(h.id,f),onTransformEnd:f=>P(h.id,f),dragBoundFunc:l?T:void 0}),j&&e.jsx(F,{x:h.x+5,y:h.y+5,text:"üîí",fontSize:16,listening:!1})]},h.id):h.type==="shape"||h.type==="rectangle"?e.jsxs(X.Fragment,{children:[e.jsx(Bt,{widget:h,isSelected:a.includes(h.id),onSelect:f=>k(h.id,f),onDragEnd:f=>w(h.id,f),onTransformEnd:f=>P(h.id,f),dragBoundFunc:l?T:void 0}),j&&e.jsx(F,{x:h.x+5,y:h.y+5,text:"üîí",fontSize:16,listening:!1})]},h.id):h.type==="menu"?e.jsxs(X.Fragment,{children:[e.jsx(_t,{widget:h,isSelected:a.includes(h.id),onSelect:f=>k(h.id,f),onDragEnd:f=>w(h.id,f),onTransformEnd:f=>P(h.id,f),dragBoundFunc:l?T:void 0}),j&&e.jsx(F,{x:h.x+5,y:h.y+5,text:"üîí",fontSize:16,listening:!1})]},h.id):e.jsxs(X.Fragment,{children:[e.jsx(E,{id:h.id,x:h.x,y:h.y,width:h.width,height:h.height,rotation:h.rotation||0,fill:Ht[h.type]||"#4a90e2",stroke:a.includes(h.id)?"#007acc":void 0,strokeWidth:a.includes(h.id)?2:0,opacity:j?.6:1,draggable:!j,onClick:f=>k(h.id,f),onTap:f=>k(h.id,f),onDragEnd:f=>w(h.id,f),onTransformEnd:f=>P(h.id,f)}),j&&e.jsx(F,{x:h.x+5,y:h.y+5,text:"üîí",fontSize:16,listening:!1})]},h.id)}),e.jsx(Oe,{ref:y,boundBoxFunc:(h,j)=>j.width<10||j.height<10?h:j})]})})})}),e.jsxs("div",{className:"canvas-info",children:[e.jsxs("span",{children:[t.canvas.width," √ó ",t.canvas.height," px"]}),a.length>0&&e.jsxs("span",{children:["–í—ã–±—Ä–∞–Ω–æ: ",a.length]})]})]})},Ut="modulepreload",Xt=function(t){return"/"+t},Ce={},Ne=function(a,i,r){let d=Promise.resolve();if(i&&i.length>0){let s=function(c){return Promise.all(c.map(p=>Promise.resolve(p).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),l=n?.nonce||n?.getAttribute("nonce");d=s(i.map(c=>{if(c=Xt(c),c in Ce)return;Ce[c]=!0;const p=c.endsWith(".css"),u=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const x=document.createElement("link");if(x.rel=p?"stylesheet":Ut,p||(x.as="script"),x.crossOrigin="",x.href=c,l&&x.setAttribute("nonce",l),document.head.appendChild(x),p)return new Promise((g,m)=>{x.addEventListener("load",g),x.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(n){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=n,window.dispatchEvent(l),!l.defaultPrevented)throw n}return d.then(n=>{for(const l of n||[])l.status==="rejected"&&o(l.reason);return a().catch(o)})},Te=({widget:t,onUpdate:a,allWidgets:i})=>{const r=t.properties.actions||[],d=()=>{const l={type:"url",url:""};a([...r,l])},o=(l,s)=>{const c=[...r];c[l]={...c[l],...s},a(c)},n=l=>{const s=r.filter((c,p)=>p!==l);a(s)};return e.jsxs("div",{className:"action-editor",children:[e.jsx("h4",{style:{marginBottom:"12px",fontSize:"12px",color:"#aaa"},children:"–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ"}),r.length===0&&e.jsx("div",{style:{padding:"16px",background:"#252525",borderRadius:"6px",textAlign:"center",color:"#888",fontSize:"13px",marginBottom:"12px"},children:"–ù–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π. –î–æ–±–∞–≤—å—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∏–∂–µ."}),r.map((l,s)=>e.jsxs("div",{className:"action-item",children:[e.jsxs("div",{className:"action-header",children:[e.jsxs("span",{className:"action-number",children:["#",s+1]}),e.jsx("button",{className:"btn-danger-small",onClick:()=>n(s),title:"–£–¥–∞–ª–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ",children:"üóëÔ∏è"})]}),e.jsxs("div",{className:"action-body",children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è"}),e.jsxs("select",{value:l.type,onChange:c=>o(s,{type:c.target.value}),children:[e.jsx("option",{value:"url",children:"üîó –û—Ç–∫—Ä—ã—Ç—å URL"}),e.jsx("option",{value:"page",children:"üìÑ –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É"}),e.jsx("option",{value:"popup",children:"üí¨ –ü–æ–∫–∞–∑–∞—Ç—å popup"}),e.jsx("option",{value:"widget_show",children:"üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å –≤–∏–¥–∂–µ—Ç"}),e.jsx("option",{value:"widget_hide",children:"üôà –°–∫—Ä—ã—Ç—å –≤–∏–¥–∂–µ—Ç"}),e.jsx("option",{value:"video_play",children:"‚ñ∂Ô∏è –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤–∏–¥–µ–æ"}),e.jsx("option",{value:"video_stop",children:"‚è∏Ô∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–∏–¥–µ–æ"})]})]}),l.type==="url"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"URL –∞–¥—Ä–µ—Å"}),e.jsx("input",{type:"text",value:l.url||"",onChange:c=>o(s,{url:c.target.value}),placeholder:"https://example.com"})]}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:l.openInNewTab||!1,onChange:c=>o(s,{openInNewTab:c.target.checked})}),"–û—Ç–∫—Ä—ã—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ"]})})]}),l.type==="page"&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"ID —Å—Ç—Ä–∞–Ω–∏—Ü—ã"}),e.jsx("input",{type:"text",value:l.pageId||"",onChange:c=>o(s,{pageId:c.target.value}),placeholder:"page-1"}),e.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:"–£–∫–∞–∂–∏—Ç–µ ID —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞"})]}),l.type==="popup"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ó–∞–≥–æ–ª–æ–≤–æ–∫ popup"}),e.jsx("input",{type:"text",value:l.popupTitle||"",onChange:c=>o(s,{popupTitle:c.target.value}),placeholder:"–ó–∞–≥–æ–ª–æ–≤–æ–∫"})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–æ–¥–µ—Ä–∂–∏–º–æ–µ popup"}),e.jsx("textarea",{value:l.popupContent||"",onChange:c=>o(s,{popupContent:c.target.value}),rows:4,placeholder:"–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è..."})]}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs("div",{className:"property-field",style:{flex:1},children:[e.jsx("label",{children:"–®–∏—Ä–∏–Ω–∞ (px)"}),e.jsx("input",{type:"number",value:l.popupWidth||400,onChange:c=>o(s,{popupWidth:parseInt(c.target.value)}),min:200,max:1e3})]}),e.jsxs("div",{className:"property-field",style:{flex:1},children:[e.jsx("label",{children:"–í—ã—Å–æ—Ç–∞ (px)"}),e.jsx("input",{type:"number",value:l.popupHeight||300,onChange:c=>o(s,{popupHeight:parseInt(c.target.value)}),min:150,max:800})]})]})]}),(l.type==="widget_show"||l.type==="widget_hide")&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–µ–ª–µ–≤–æ–π –≤–∏–¥–∂–µ—Ç"}),e.jsxs("select",{value:l.targetWidgetId||"",onChange:c=>o(s,{targetWidgetId:c.target.value}),children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–∂–µ—Ç..."}),i.filter(c=>c.id!==t.id).map(c=>e.jsxs("option",{value:c.id,children:[c.type," - ",c.id]},c.id))]})]}),(l.type==="video_play"||l.type==="video_stop")&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–í–∏–¥–µ–æ –≤–∏–¥–∂–µ—Ç"}),e.jsxs("select",{value:l.targetWidgetId||"",onChange:c=>o(s,{targetWidgetId:c.target.value}),children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–µ–æ..."}),i.filter(c=>c.type==="video").map(c=>e.jsxs("option",{value:c.id,children:["Video - ",c.id]},c.id))]})]})]})]},s)),e.jsx("button",{className:"btn-secondary",onClick:d,style:{width:"100%",marginTop:"8px"},children:"‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ"})]})},Vt=()=>{const{project:t,selectedWidgetIds:a,updateWidget:i}=O();if(!t)return null;const r=a.length===1?t.widgets.find(n=>n.id===a[0]):null,d=(n,l)=>{r&&i(r.id,{[n]:l})},o=(n,l)=>{r&&i(r.id,{properties:{...r.properties,[n]:l}})};return r?e.jsxs("div",{className:"properties-panel panel",children:[e.jsxs("div",{className:"properties-header",children:[e.jsx("h3",{children:"–°–≤–æ–π—Å—Ç–≤–∞"}),e.jsx("span",{className:"widget-type-badge",children:r.type})]}),e.jsxs("div",{className:"properties-content",children:[e.jsxs("div",{className:"property-section",children:[e.jsx("h4",{children:"–ü–æ–∑–∏—Ü–∏—è –∏ —Ä–∞–∑–º–µ—Ä"}),e.jsxs("div",{className:"property-row",children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"X"}),e.jsx("input",{type:"number",value:Math.round(r.x),onChange:n=>d("x",parseFloat(n.target.value))})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"Y"}),e.jsx("input",{type:"number",value:Math.round(r.y),onChange:n=>d("y",parseFloat(n.target.value))})]})]}),e.jsxs("div",{className:"property-row",children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–®–∏—Ä–∏–Ω–∞"}),e.jsx("input",{type:"number",value:Math.round(r.width),onChange:n=>d("width",parseFloat(n.target.value)),min:1})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–í—ã—Å–æ—Ç–∞"}),e.jsx("input",{type:"number",value:Math.round(r.height),onChange:n=>d("height",parseFloat(n.target.value)),min:1})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü–æ–≤–æ—Ä–æ—Ç (–≥—Ä–∞–¥—É—Å—ã)"}),e.jsx("input",{type:"number",value:Math.round(r.rotation||0),onChange:n=>d("rotation",parseFloat(n.target.value))})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"Z-Index (–ø–æ—Ä—è–¥–æ–∫)"}),e.jsx("input",{type:"number",min:"0",value:r.zIndex||0,onChange:n=>d("zIndex",Math.max(0,parseInt(n.target.value)||0))}),e.jsxs("div",{style:{marginTop:"8px",display:"flex",gap:"4px"},children:[e.jsx("button",{className:"btn-secondary",onClick:()=>{const{bringToFront:n}=O.getState();n(r.id)},style:{flex:1,fontSize:"11px",padding:"4px"},title:"–ù–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω",children:"‚¨ÜÔ∏è –ù–∞–≤–µ—Ä—Ö"}),e.jsx("button",{className:"btn-secondary",onClick:()=>{const{sendToBack:n}=O.getState();n(r.id)},style:{flex:1,fontSize:"11px",padding:"4px"},title:"–ù–∞ –∑–∞–¥–Ω–∏–π –ø–ª–∞–Ω",children:"‚¨áÔ∏è –í–Ω–∏–∑"})]})]}),e.jsxs("div",{className:"property-field",style:{marginTop:"12px"},children:[e.jsx("button",{className:r.locked?"btn-danger":"btn-secondary",onClick:()=>{const{toggleLockWidget:n}=O.getState();n(r.id)},style:{width:"100%"},children:r.locked?"üîí –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å":"üîì –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å"}),r.locked&&e.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–∏–¥–∂–µ—Ç –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å —Ä–∞–∑–º–µ—Ä"})]})]}),e.jsxs("div",{className:"property-section",children:[e.jsx("h4",{children:"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∏–¥–∂–µ—Ç–∞"}),r.type==="shape"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø —Ñ–∏–≥—É—Ä—ã"}),e.jsxs("select",{value:r.properties.shapeType||"rectangle",onChange:n=>o("shapeType",n.target.value),children:[e.jsx("option",{value:"rectangle",children:"–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"circle",children:"–ö—Ä—É–≥"}),e.jsx("option",{value:"ellipse",children:"–≠–ª–ª–∏–ø—Å"}),e.jsx("option",{value:"triangle",children:"–¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"pentagon",children:"–ü—è—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"hexagon",children:"–®–µ—Å—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"star",children:"–ó–≤–µ–∑–¥–∞"}),e.jsx("option",{value:"diamond",children:"–†–æ–º–±"}),e.jsx("option",{value:"line",children:"–õ–∏–Ω–∏—è"}),e.jsx("option",{value:"arrow",children:"–°—Ç—Ä–µ–ª–∫–∞"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ó–∞–ª–∏–≤–∫–∞"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç –∑–∞–ª–∏–≤–∫–∏"}),e.jsx("input",{type:"color",value:r.properties.fillColor||"#4a90e2",onChange:n=>o("fillColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å"}),e.jsx("input",{type:"range",value:(r.properties.opacity||1)*100,onChange:n=>o("opacity",parseInt(n.target.value)/100),min:0,max:100}),e.jsxs("span",{style:{fontSize:"11px",color:"#888"},children:[Math.round((r.properties.opacity||1)*100),"%"]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ö–æ–Ω—Ç—É—Ä"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ –∫–æ–Ω—Ç—É—Ä–∞"}),e.jsx("input",{type:"number",value:r.properties.strokeWidth||0,onChange:n=>o("strokeWidth",parseInt(n.target.value)),min:0,max:20})]}),r.properties.strokeWidth>0&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç –∫–æ–Ω—Ç—É—Ä–∞"}),e.jsx("input",{type:"color",value:r.properties.strokeColor||"#2c3e50",onChange:n=>o("strokeColor",n.target.value)})]}),r.properties.shapeType==="rectangle"&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤"}),e.jsx("input",{type:"number",value:r.properties.cornerRadius||0,onChange:n=>o("cornerRadius",parseInt(n.target.value)),min:0,max:100})]})]}),r.type==="button"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°—Ç–∏–ª—å –∫–Ω–æ–ø–∫–∏"}),e.jsxs("select",{onChange:n=>{const l=n.target.value;l!=="custom"&&Ne(async()=>{const{buttonStyles:s}=await import("./buttonStyles-VsZJSFTR.js");return{buttonStyles:s}},[]).then(({buttonStyles:s})=>{const c=s.find(p=>p.name===l);c&&i(r.id,{properties:{...r.properties,...c.properties}})})},children:[e.jsx("option",{value:"custom",children:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π"}),e.jsx("option",{value:"–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é",children:"–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é"}),e.jsx("option",{value:"–û—Å–Ω–æ–≤–Ω–∞—è",children:"–û—Å–Ω–æ–≤–Ω–∞—è (—Å–∏–Ω—è—è —Å —Ç–µ–Ω—å—é)"}),e.jsx("option",{value:"–£—Å–ø–µ—Ö",children:"–£—Å–ø–µ—Ö (–∑–µ–ª—ë–Ω–∞—è)"}),e.jsx("option",{value:"–û–ø–∞—Å–Ω–æ—Å—Ç—å",children:"–û–ø–∞—Å–Ω–æ—Å—Ç—å (–∫—Ä–∞—Å–Ω–∞—è)"}),e.jsx("option",{value:"–ö–æ–Ω—Ç—É—Ä–Ω–∞—è",children:"–ö–æ–Ω—Ç—É—Ä–Ω–∞—è"}),e.jsx("option",{value:"–ü—Ä–∏–∑—Ä–∞–∫",children:"–ü—Ä–∏–∑—Ä–∞–∫"}),e.jsx("option",{value:"–ì—Ä–∞–¥–∏–µ–Ω—Ç",children:"–ì—Ä–∞–¥–∏–µ–Ω—Ç"}),e.jsx("option",{value:"–ú–∏–Ω–∏–º–∞–ª–∏–∑–º",children:"–ú–∏–Ω–∏–º–∞–ª–∏–∑–º"}),e.jsx("option",{value:"–ù–µ–æ–Ω",children:"–ù–µ–æ–Ω"}),e.jsx("option",{value:"–ö–ª–∞—Å—Å–∏–∫–∞",children:"–ö–ª–∞—Å—Å–∏–∫–∞"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–¢–µ–∫—Å—Ç"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏"}),e.jsx("input",{type:"text",value:r.properties.text||"Button",onChange:n=>o("text",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞"}),e.jsx("input",{type:"number",value:r.properties.fontSize||16,onChange:n=>o("fontSize",parseInt(n.target.value)),min:8,max:72})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–®—Ä–∏—Ñ—Ç"}),e.jsxs("select",{value:r.properties.fontFamily||"Arial",onChange:n=>o("fontFamily",n.target.value),children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Helvetica",children:"Helvetica"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Courier New",children:"Courier New"}),e.jsx("option",{value:"Verdana",children:"Verdana"}),e.jsx("option",{value:"Georgia",children:"Georgia"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ù–∞—á–µ—Ä—Ç–∞–Ω–∏–µ"}),e.jsxs("select",{value:r.properties.fontWeight||"normal",onChange:n=>o("fontWeight",n.target.value),children:[e.jsx("option",{value:"normal",children:"–û–±—ã—á–Ω—ã–π"}),e.jsx("option",{value:"bold",children:"–ñ–∏—Ä–Ω—ã–π"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ"}),e.jsxs("select",{value:r.properties.textAlign||"center",onChange:n=>o("textAlign",n.target.value),children:[e.jsx("option",{value:"left",children:"–ü–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é"}),e.jsx("option",{value:"center",children:"–ü–æ —Ü–µ–Ω—Ç—Ä—É"}),e.jsx("option",{value:"right",children:"–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞"}),e.jsx("input",{type:"color",value:r.properties.textColor||"#ffffff",onChange:n=>o("textColor",n.target.value)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–§–æ–Ω"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ñ–æ–Ω–∞"}),e.jsx("input",{type:"color",value:r.properties.backgroundColor||"#2ecc71",onChange:n=>o("backgroundColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤"}),e.jsx("input",{type:"number",value:r.properties.borderRadius||8,onChange:n=>o("borderRadius",parseInt(n.target.value)),min:0,max:50})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–º–∫–∞"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"number",value:r.properties.borderWidth||0,onChange:n=>o("borderWidth",parseInt(n.target.value)),min:0,max:10})]}),r.properties.borderWidth>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"color",value:r.properties.borderColor||"#000000",onChange:n=>o("borderColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°—Ç–∏–ª—å —Ä–∞–º–∫–∏"}),e.jsxs("select",{value:r.properties.borderStyle||"solid",onChange:n=>o("borderStyle",n.target.value),children:[e.jsx("option",{value:"solid",children:"–°–ø–ª–æ—à–Ω–∞—è"}),e.jsx("option",{value:"dashed",children:"–®—Ç—Ä–∏—Ö–æ–≤–∞—è"}),e.jsx("option",{value:"dotted",children:"–ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è"})]})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–¢–µ–Ω—å"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.shadowEnabled||!1,onChange:n=>o("shadowEnabled",n.target.checked)}),"–í–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω—å"]})}),r.properties.shadowEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–Ω–∏"}),e.jsx("input",{type:"color",value:r.properties.shadowColor||"#000000",onChange:n=>o("shadowColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–∑–º—ã—Ç–∏–µ"}),e.jsx("input",{type:"number",value:r.properties.shadowBlur||10,onChange:n=>o("shadowBlur",parseInt(n.target.value)),min:0,max:50})]}),e.jsxs("div",{className:"property-row",children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–º–µ—â–µ–Ω–∏–µ X"}),e.jsx("input",{type:"number",value:r.properties.shadowOffsetX||0,onChange:n=>o("shadowOffsetX",parseInt(n.target.value)),min:-50,max:50})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–º–µ—â–µ–Ω–∏–µ Y"}),e.jsx("input",{type:"number",value:r.properties.shadowOffsetY||4,onChange:n=>o("shadowOffsetY",parseInt(n.target.value)),min:-50,max:50})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å"}),e.jsx("input",{type:"range",value:(r.properties.shadowOpacity||.3)*100,onChange:n=>o("shadowOpacity",parseInt(n.target.value)/100),min:0,max:100}),e.jsxs("span",{style:{fontSize:"11px",color:"#888"},children:[Math.round((r.properties.shadowOpacity||.3)*100),"%"]})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–î–µ–π—Å—Ç–≤–∏—è"}),e.jsx(Te,{widget:r,onUpdate:n=>{i(r.id,{properties:{...r.properties,actions:n}})},allWidgets:t.widgets})]}),r.type==="text"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–µ–∫—Å—Ç"}),e.jsx("textarea",{value:r.properties.text||"Text",onChange:n=>o("text",n.target.value),rows:6})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª"}),e.jsx("input",{type:"file",accept:".txt,.pdf,.odt,.docx",onChange:async n=>{const l=n.target.files?.[0];if(l)try{const{extractTextFromFile:s,loadRequiredLibraries:c}=await Ne(async()=>{const{extractTextFromFile:u,loadRequiredLibraries:x}=await import("./fileTextExtractor-HZqzU4jo.js");return{extractTextFromFile:u,loadRequiredLibraries:x}},[]);c(),o("text","–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...");const p=await s(l);i(r.id,{properties:{...r.properties,text:p,sourceFile:l.name}})}catch(s){console.error("Error loading file:",s),alert(`–û—à–∏–±–∫–∞: ${s instanceof Error?s.message:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª"}`),o("text","Text")}n.target.value=""}}),e.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:"–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: TXT, PDF, ODT, DOCX"}),r.properties.sourceFile&&e.jsxs("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:["üìÑ ",r.properties.sourceFile]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–®—Ä–∏—Ñ—Ç"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞"}),e.jsx("input",{type:"number",value:r.properties.fontSize||16,onChange:n=>o("fontSize",parseInt(n.target.value)),min:8,max:144})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–µ–º–µ–π—Å—Ç–≤–æ —à—Ä–∏—Ñ—Ç–∞"}),e.jsxs("select",{value:r.properties.fontFamily||"Arial",onChange:n=>o("fontFamily",n.target.value),children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Helvetica",children:"Helvetica"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Courier New",children:"Courier New"}),e.jsx("option",{value:"Verdana",children:"Verdana"}),e.jsx("option",{value:"Georgia",children:"Georgia"}),e.jsx("option",{value:"Comic Sans MS",children:"Comic Sans MS"}),e.jsx("option",{value:"Impact",children:"Impact"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ù–∞—á–µ—Ä—Ç–∞–Ω–∏–µ"}),e.jsxs("select",{value:r.properties.fontWeight||"normal",onChange:n=>o("fontWeight",n.target.value),children:[e.jsx("option",{value:"normal",children:"–û–±—ã—á–Ω—ã–π"}),e.jsx("option",{value:"bold",children:"–ñ–∏—Ä–Ω—ã–π"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°—Ç–∏–ª—å"}),e.jsxs("select",{value:r.properties.fontStyle||"normal",onChange:n=>o("fontStyle",n.target.value),children:[e.jsx("option",{value:"normal",children:"–û–±—ã—á–Ω—ã–π"}),e.jsx("option",{value:"italic",children:"–ö—É—Ä—Å–∏–≤"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–î–µ–∫–æ—Ä–∞—Ü–∏—è"}),e.jsxs("select",{value:r.properties.textDecoration||"none",onChange:n=>o("textDecoration",n.target.value),children:[e.jsx("option",{value:"none",children:"–ù–µ—Ç"}),e.jsx("option",{value:"underline",children:"–ü–æ–¥—á—ë—Ä–∫–Ω—É—Ç—ã–π"}),e.jsx("option",{value:"line-through",children:"–ó–∞—á—ë—Ä–∫–Ω—É—Ç—ã–π"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏"}),e.jsxs("select",{value:r.properties.textAlign||"left",onChange:n=>o("textAlign",n.target.value),children:[e.jsx("option",{value:"left",children:"–ü–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é"}),e.jsx("option",{value:"center",children:"–ü–æ —Ü–µ–Ω—Ç—Ä—É"}),e.jsx("option",{value:"right",children:"–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ü–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏"}),e.jsxs("select",{value:r.properties.verticalAlign||"top",onChange:n=>o("verticalAlign",n.target.value),children:[e.jsx("option",{value:"top",children:"–°–≤–µ—Ä—Ö—É"}),e.jsx("option",{value:"middle",children:"–ü–æ —Ü–µ–Ω—Ç—Ä—É"}),e.jsx("option",{value:"bottom",children:"–°–Ω–∏–∑—É"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–¶–≤–µ—Ç–∞ –∏ —Ñ–æ–Ω"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞"}),e.jsx("input",{type:"color",value:r.properties.textColor||"#000000",onChange:n=>o("textColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ñ–æ–Ω–∞"}),e.jsx("input",{type:"color",value:r.properties.backgroundColor||"#ffffff",onChange:n=>o("backgroundColor",n.target.value)}),e.jsxs("label",{style:{marginTop:"4px",fontSize:"11px"},children:[e.jsx("input",{type:"checkbox",checked:r.properties.backgroundColor==="transparent",onChange:n=>o("backgroundColor",n.target.checked?"transparent":"#ffffff")}),"–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω"]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ú–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª"}),e.jsx("input",{type:"number",value:r.properties.lineHeight||1.2,onChange:n=>o("lineHeight",parseFloat(n.target.value)),min:.5,max:3,step:.1})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–û—Ç—Å—Ç—É–ø –æ—Ç –∫—Ä–∞—è"}),e.jsx("input",{type:"number",value:r.properties.padding||8,onChange:n=>o("padding",parseInt(n.target.value)),min:0,max:50})]})]}),r.type==="image"&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginTop:"0",marginBottom:"12px",fontSize:"13px",fontWeight:"bold"},children:"–†–µ–∂–∏–º"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"imageMode",checked:!r.properties.galleryMode,onChange:()=>o("galleryMode",!1)})," ","–û–¥–∏–Ω–æ—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"imageMode",checked:r.properties.galleryMode||!1,onChange:()=>{o("galleryMode",!0),r.properties.sources||o("sources",[])}})," ","–ì–∞–ª–µ—Ä–µ—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"]})}),!r.properties.galleryMode&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"}),e.jsx("input",{type:"text",value:r.properties.src||"",onChange:n=>o("src",n.target.value),placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª"}),e.jsx("input",{type:"file",accept:"image/*",onChange:n=>{const l=n.target.files?.[0];if(l){const s=new FileReader;s.onload=c=>{const p=c.target?.result;p&&i(r.id,{properties:{...r.properties,src:p,isLocalFile:!0,fileName:l.name}})},s.readAsDataURL(l)}n.target.value=""}}),r.properties.isLocalFile&&r.properties.fileName&&e.jsxs("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:["üìÅ ",r.properties.fileName]})]})]}),r.properties.galleryMode&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ò—Å—Ç–æ—á–Ω–∏–∫–∏ (–º–∞–∫—Å. 50)"}),e.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid #ddd",borderRadius:"4px",padding:"8px",marginBottom:"8px",backgroundColor:"#fafafa"},children:[(r.properties.sources||[]).map((n,l)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",padding:"6px",backgroundColor:"#fff",borderRadius:"4px",border:"1px solid #e0e0e0"},children:[e.jsxs("span",{style:{fontSize:"11px",color:"#666",minWidth:"20px"},children:[l+1,"."]}),e.jsx("span",{style:{fontSize:"11px",color:n.type==="url"?"#007acc":"#2ecc71"},children:n.type==="url"?"üåê":"üì∑"}),e.jsx("span",{style:{flex:1,fontSize:"11px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.value.length>40?n.value.substring(0,40)+"...":n.value}),e.jsx("button",{onClick:()=>{const s=(r.properties.sources||[]).filter((c,p)=>p!==l);o("sources",s)},style:{padding:"2px 6px",fontSize:"10px",border:"none",background:"#e74c3c",color:"#fff",borderRadius:"3px",cursor:"pointer"},children:"‚úï"})]},n.id)),(!r.properties.sources||r.properties.sources.length===0)&&e.jsx("div",{style:{textAlign:"center",color:"#999",fontSize:"11px",padding:"20px"},children:"–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≥–∞–ª–µ—Ä–µ–µ"})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,id:`gallery-upload-${r.id}`,style:{display:"none"},onChange:n=>{const l=Array.from(n.target.files||[]),s=r.properties.sources||[];if(s.length+l.length>50){alert("–ú–∞–∫—Å–∏–º—É–º 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≥–∞–ª–µ—Ä–µ–µ"),n.target.value="";return}let c=0;const p=[];l.forEach(u=>{const x=new FileReader;x.onload=g=>{const m=g.target?.result;m&&p.push({id:`img-${Date.now()}-${Math.random()}`,type:"local",value:m}),c++,c===l.length&&o("sources",[...s,...p])},x.readAsDataURL(u)}),n.target.value=""}}),e.jsx("button",{onClick:()=>{document.getElementById(`gallery-upload-${r.id}`)?.click()},className:"btn-secondary",style:{flex:1,fontSize:"11px",padding:"6px"},children:"üì∑ –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã"}),e.jsx("button",{onClick:()=>{const n=prompt("–í–≤–µ–¥–∏—Ç–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:");if(n){const l=r.properties.sources||[];if(l.length>=50){alert("–ú–∞–∫—Å–∏–º—É–º 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≥–∞–ª–µ—Ä–µ–µ");return}o("sources",[...l,{id:`img-${Date.now()}-${Math.random()}`,type:"url",value:n}])}},className:"btn-secondary",style:{flex:1,fontSize:"11px",padding:"6px"},children:"üåê –î–æ–±–∞–≤–∏—Ç—å URL"})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ê–≤—Ç–æ–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.autoSwitch||!1,onChange:n=>o("autoSwitch",n.target.checked)})," ","–í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ"]})}),r.properties.autoSwitch&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ò–Ω—Ç–µ—Ä–≤–∞–ª (—Å–µ–∫—É–Ω–¥—ã)"}),e.jsx("input",{type:"number",min:"1",max:"60",value:r.properties.switchInterval||3,onChange:n=>o("switchInterval",parseInt(n.target.value)||3)})]})}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–≠—Ñ—Ñ–µ–∫—Ç—ã –ø–µ—Ä–µ—Ö–æ–¥–∞"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–≠—Ñ—Ñ–µ–∫—Ç"}),e.jsxs("select",{value:r.properties.transition||"fade",onChange:n=>o("transition",n.target.value),children:[e.jsx("option",{value:"none",children:"–ù–µ—Ç (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)"}),e.jsx("option",{value:"fade",children:"–ó–∞—Ç—É—Ö–∞–Ω–∏–µ"}),e.jsx("option",{value:"slide",children:"–°–∫–æ–ª—å–∂–µ–Ω–∏–µ"}),e.jsx("option",{value:"zoom",children:"–£–≤–µ–ª–∏—á–µ–Ω–∏–µ"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º—Å)"}),e.jsx("input",{type:"number",min:"100",max:"2000",step:"100",value:r.properties.transitionDuration||500,onChange:n=>o("transitionDuration",parseInt(n.target.value)||500)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ö–æ–Ω—Ç—Ä–æ–ª—ã"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.showControls!==!1,onChange:n=>o("showControls",n.target.checked)})," ","–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–µ–ª–∫–∏"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.showIndicators!==!1,onChange:n=>o("showIndicators",n.target.checked)})," ","–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.loop!==!1,onChange:n=>o("loop",n.target.checked)})," ","–ó–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ"]})})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"}),e.jsxs("select",{value:r.properties.objectFit||"contain",onChange:n=>o("objectFit",n.target.value),children:[e.jsx("option",{value:"contain",children:"–ü—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–≤–ø–∏—Å–∞—Ç—å)"}),e.jsx("option",{value:"cover",children:"–ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤–µ—Å—å –≤–∏–¥–∂–µ—Ç"}),e.jsx("option",{value:"fill",children:"–†–∞—Å—Ç—è–Ω—É—Ç—å"}),e.jsx("option",{value:"scale-down",children:"–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä"}),e.jsx("option",{value:"adaptive",children:"–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π (–∏–∑–º–µ–Ω–∏—Ç—å –≤–∏–¥–∂–µ—Ç)"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–§–æ—Ä–º–∞ –æ–±—Ä–µ–∑–∫–∏"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–§–æ—Ä–º–∞"}),e.jsxs("select",{value:r.properties.clipShape||"rectangle",onChange:n=>o("clipShape",n.target.value),children:[e.jsx("option",{value:"rectangle",children:"‚¨ú –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"circle",children:"‚ö´ –ö—Ä—É–≥"}),e.jsx("option",{value:"ellipse",children:"üî¥ –≠–ª–ª–∏–ø—Å"}),e.jsx("option",{value:"triangle",children:"üî∫ –¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"diamond",children:"üî∂ –†–æ–º–±"}),e.jsx("option",{value:"pentagon",children:"‚¨¢ –ü—è—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"hexagon",children:"‚¨° –®–µ—Å—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"octagon",children:"‚≠ê –í–æ—Å—å–º–∏—É–≥–æ–ª—å–Ω–∏–∫"}),e.jsx("option",{value:"rounded-rectangle",children:"üè∑Ô∏è –ó–∞–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫"})]})]}),r.properties.clipShape==="rounded-rectangle"&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–¥–∏—É—Å —É–≥–ª–æ–≤ (px)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:r.properties.cornerRadius||20,onChange:n=>o("cornerRadius",parseInt(n.target.value)||20)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–º–∫–∞"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.borderEnabled||!1,onChange:n=>o("borderEnabled",n.target.checked)}),"–í–∫–ª—é—á–∏—Ç—å —Ä–∞–º–∫—É"]})}),r.properties.borderEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø —Ä–∞–º–∫–∏"}),e.jsxs("select",{value:r.properties.borderStyle||"solid",onChange:n=>o("borderStyle",n.target.value),children:[e.jsx("option",{value:"solid",children:"–°–ø–ª–æ—à–Ω–∞—è"}),e.jsx("option",{value:"dashed",children:"–®—Ç—Ä–∏—Ö–æ–≤–∞—è"}),e.jsx("option",{value:"dotted",children:"–ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è"}),e.jsx("option",{value:"double",children:"–î–≤–æ–π–Ω–∞—è"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–∫–∏ (px)"}),e.jsx("input",{type:"number",value:r.properties.borderWidth||2,onChange:n=>o("borderWidth",parseFloat(n.target.value)),min:1,max:20})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"color",value:r.properties.borderColor||"#000000",onChange:n=>o("borderColor",n.target.value)})]})]})]}),r.type==="video"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞"}),e.jsxs("select",{value:r.properties.sourceType||"url",onChange:n=>o("sourceType",n.target.value),children:[e.jsx("option",{value:"url",children:"URL / –§–∞–π–ª"}),e.jsx("option",{value:"rtsp",children:"RTSP –ø–æ—Ç–æ–∫"})]})]}),r.properties.sourceType==="rtsp"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"RTSP URL"}),e.jsx("input",{type:"text",value:r.properties.rtspUrl||"",onChange:n=>o("rtspUrl",n.target.value),placeholder:"rtsp://username:password@host:554/stream"}),e.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:"–ü—Ä–∏–º–µ—Ä: rtsp://admin:12345@192.168.1.100:554/live"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"URL –≤–∏–¥–µ–æ"}),e.jsx("input",{type:"text",value:r.properties.src||"",onChange:n=>o("src",n.target.value),placeholder:"https://example.com/video.mp4"})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª"}),e.jsx("input",{type:"file",accept:"video/*",onChange:n=>{const l=n.target.files?.[0];if(l){const s=new FileReader;s.onload=c=>{const p=c.target?.result;p&&i(r.id,{properties:{...r.properties,src:p,isLocalFile:!0,fileName:l.name}})},s.readAsDataURL(l)}n.target.value=""}}),r.properties.isLocalFile&&r.properties.fileName&&e.jsxs("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"},children:["üìÅ ",r.properties.fileName]})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–∏–ø –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"}),e.jsxs("select",{value:r.properties.objectFit||"contain",onChange:n=>o("objectFit",n.target.value),children:[e.jsx("option",{value:"contain",children:"–ü—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–≤–ø–∏—Å–∞—Ç—å)"}),e.jsx("option",{value:"cover",children:"–ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤–µ—Å—å –≤–∏–¥–∂–µ—Ç"}),e.jsx("option",{value:"fill",children:"–†–∞—Å—Ç—è–Ω—É—Ç—å"}),e.jsx("option",{value:"scale-down",children:"–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä"}),e.jsx("option",{value:"adaptive",children:"–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π (–∏–∑–º–µ–Ω–∏—Ç—å –≤–∏–¥–∂–µ—Ç)"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.autoplay||!1,onChange:n=>o("autoplay",n.target.checked)}),"–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.loop||!1,onChange:n=>o("loop",n.target.checked)}),"–ü–æ–≤—Ç–æ—Ä (loop)"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.muted!==!1,onChange:n=>o("muted",n.target.checked)}),"–ë–µ–∑ –∑–≤—É–∫–∞ (muted)"]})}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.controls!==!1,onChange:n=>o("controls",n.target.checked)}),"–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è"]})}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–º–∫–∞"}),e.jsx("div",{className:"property-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:r.properties.borderEnabled||!1,onChange:n=>o("borderEnabled",n.target.checked)}),"–í–∫–ª—é—á–∏—Ç—å —Ä–∞–º–∫—É"]})}),r.properties.borderEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°—Ç–∏–ª—å —Ä–∞–º–∫–∏"}),e.jsxs("select",{value:r.properties.borderStyle||"solid",onChange:n=>o("borderStyle",n.target.value),children:[e.jsx("option",{value:"solid",children:"–°–ø–ª–æ—à–Ω–∞—è"}),e.jsx("option",{value:"dashed",children:"–®—Ç—Ä–∏—Ö–æ–≤–∞—è"}),e.jsx("option",{value:"dotted",children:"–ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è"}),e.jsx("option",{value:"double",children:"–î–≤–æ–π–Ω–∞—è"})]})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"number",value:r.properties.borderWidth||2,onChange:n=>o("borderWidth",parseInt(n.target.value)),min:1,max:20})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"color",value:r.properties.borderColor||"#000000",onChange:n=>o("borderColor",n.target.value)})]})]})]}),r.type==="menu"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è"}),e.jsxs("select",{value:r.properties.orientation||"horizontal",onChange:n=>o("orientation",n.target.value),children:[e.jsx("option",{value:"horizontal",children:"–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è"}),e.jsx("option",{value:"vertical",children:"–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–í–Ω–µ—à–Ω–∏–π –≤–∏–¥"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ñ–æ–Ω–∞"}),e.jsx("input",{type:"color",value:r.properties.backgroundColor||"#2c3e50",onChange:n=>o("backgroundColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞"}),e.jsx("input",{type:"color",value:r.properties.textColor||"#ffffff",onChange:n=>o("textColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏"}),e.jsx("input",{type:"color",value:r.properties.hoverColor||"#34495e",onChange:n=>o("hoverColor",n.target.value)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–®—Ä–∏—Ñ—Ç"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞"}),e.jsx("input",{type:"number",value:r.properties.fontSize||16,onChange:n=>o("fontSize",parseInt(n.target.value)),min:10,max:32})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–°–µ–º–µ–π—Å—Ç–≤–æ —à—Ä–∏—Ñ—Ç–∞"}),e.jsxs("select",{value:r.properties.fontFamily||"Arial",onChange:n=>o("fontFamily",n.target.value),children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Helvetica",children:"Helvetica"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Verdana",children:"Verdana"}),e.jsx("option",{value:"Georgia",children:"Georgia"})]})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–∑–º–µ—Ä—ã"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–í—ã—Å–æ—Ç–∞ –ø—É–Ω–∫—Ç–∞"}),e.jsx("input",{type:"number",value:r.properties.itemHeight||40,onChange:n=>o("itemHeight",parseInt(n.target.value)),min:30,max:100})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–û—Ç—Å—Ç—É–ø –ø—É–Ω–∫—Ç–∞"}),e.jsx("input",{type:"number",value:r.properties.itemPadding||16,onChange:n=>o("itemPadding",parseInt(n.target.value)),min:8,max:40})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ü–æ–¥–º–µ–Ω—é"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ñ–æ–Ω–∞ –ø–æ–¥–º–µ–Ω—é"}),e.jsx("input",{type:"color",value:r.properties.submenuBackgroundColor||"#34495e",onChange:n=>o("submenuBackgroundColor",n.target.value)})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –ø–æ–¥–º–µ–Ω—é"}),e.jsx("input",{type:"color",value:r.properties.submenuTextColor||"#ffffff",onChange:n=>o("submenuTextColor",n.target.value)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–†–∞–º–∫–∞"}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"number",value:r.properties.borderWidth||0,onChange:n=>o("borderWidth",parseInt(n.target.value)),min:0,max:10})]}),r.properties.borderWidth>0&&e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–¶–≤–µ—Ç —Ä–∞–º–∫–∏"}),e.jsx("input",{type:"color",value:r.properties.borderColor||"#000000",onChange:n=>o("borderColor",n.target.value)})]}),e.jsx("h4",{style:{marginTop:"16px",marginBottom:"8px",fontSize:"12px"},children:"–ü—É–Ω–∫—Ç—ã –º–µ–Ω—é"}),e.jsx("div",{className:"property-field",children:e.jsx("button",{className:"btn-secondary",onClick:()=>{const n=r.properties.items||[],l={id:`item-${Date.now()}`,label:"–ù–æ–≤—ã–π –ø—É–Ω–∫—Ç"};i(r.id,{properties:{...r.properties,items:[...n,l]}})},style:{width:"100%"},children:"‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç"})}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:(r.properties.items||[]).map((n,l)=>e.jsxs("div",{style:{background:"#252525",padding:"12px",marginBottom:"8px",borderRadius:"6px",border:"1px solid #333"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[e.jsxs("strong",{style:{fontSize:"12px",color:"#aaa"},children:["–ü—É–Ω–∫—Ç ",l+1]}),e.jsx("button",{className:"btn-danger",onClick:()=>{const s=r.properties.items||[];i(r.id,{properties:{...r.properties,items:s.filter(c=>c.id!==n.id)}})},style:{fontSize:"11px",padding:"4px 8px"},children:"üóëÔ∏è –£–¥–∞–ª–∏—Ç—å"})]}),e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"–ù–∞–∑–≤–∞–Ω–∏–µ"}),e.jsx("input",{type:"text",value:n.label,onChange:s=>{const c=[...r.properties.items||[]];c[l]={...c[l],label:s.target.value},i(r.id,{properties:{...r.properties,items:c}})}})]}),e.jsxs("div",{style:{marginTop:"12px"},children:[e.jsx("div",{style:{fontSize:"11px",color:"#888",marginBottom:"8px"},children:"–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ"}),e.jsx(Te,{widget:{...r,id:n.id,properties:n},onUpdate:s=>{const c=[...r.properties.items||[]];c[l]={...c[l],actions:s},i(r.id,{properties:{...r.properties,items:c}})},allWidgets:t.widgets})]}),e.jsxs("div",{style:{marginTop:"12px",paddingLeft:"12px",borderLeft:"2px solid #444"},children:[e.jsx("div",{style:{fontSize:"11px",color:"#888",marginBottom:"8px"},children:"–ü–æ–¥–ø—É–Ω–∫—Ç—ã"}),e.jsx("button",{className:"btn-secondary",onClick:()=>{const s=[...r.properties.items||[]],c=s[l].children||[];s[l]={...s[l],children:[...c,{id:`subitem-${Date.now()}`,label:"–ü–æ–¥–ø—É–Ω–∫—Ç"}]},i(r.id,{properties:{...r.properties,items:s}})},style:{width:"100%",fontSize:"11px",padding:"6px",marginBottom:"8px"},children:"‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø—É–Ω–∫—Ç"}),(n.children||[]).map((s,c)=>e.jsx("div",{style:{background:"#1e1e1e",padding:"8px",marginBottom:"6px",borderRadius:"4px",border:"1px solid #2a2a2a"},children:e.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[e.jsx("input",{type:"text",value:s.label,onChange:p=>{const u=[...r.properties.items||[]],x=[...u[l].children||[]];x[c]={...x[c],label:p.target.value},u[l]={...u[l],children:x},i(r.id,{properties:{...r.properties,items:u}})},style:{flex:1,fontSize:"12px",padding:"4px 8px"}}),e.jsx("button",{className:"btn-danger",onClick:()=>{const p=[...r.properties.items||[]],u=p[l].children?.filter(x=>x.id!==s.id)||[];p[l]={...p[l],children:u},i(r.id,{properties:{...r.properties,items:p}})},style:{fontSize:"11px",padding:"4px 8px"},children:"üóëÔ∏è"})]})},s.id))]})]},n.id))})]})]}),e.jsx("div",{className:"property-section",children:e.jsxs("div",{className:"property-field",children:[e.jsx("label",{children:"ID"}),e.jsx("input",{type:"text",value:r.id,disabled:!0,style:{opacity:.5,cursor:"not-allowed"}})]})})]})]}):e.jsxs("div",{className:"properties-panel panel",children:[e.jsx("div",{className:"properties-header",children:e.jsx("h3",{children:"–°–≤–æ–π—Å—Ç–≤–∞"})}),e.jsx("div",{className:"properties-empty",children:e.jsx("p",{children:"–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–∂–µ—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"})})]})},Gt=()=>{const{project:t,selectedWidgetIds:a,selectWidget:i,updateWidget:r,deleteWidget:d}=O();if(!t)return null;const o=s=>({shape:"üî∑",rectangle:"üî∑",text:"üìù",button:"üîò",image:"üñºÔ∏è",video:"üé¨",menu:"üçî"})[s]||"‚¨ú",n=s=>{if(s.properties.text){const c=s.properties.text.substring(0,20);return c.length<s.properties.text.length?`${c}...`:c}return s.properties.items?`–ú–µ–Ω—é (${s.properties.items.length} –ø—É–Ω–∫—Ç–æ–≤)`:s.type.charAt(0).toUpperCase()+s.type.slice(1)},l=[...t.widgets].sort((s,c)=>(c.zIndex||0)-(s.zIndex||0));return e.jsxs("div",{className:"outline-panel",children:[e.jsxs("div",{className:"outline-header",children:[e.jsx("h3",{children:"–°—Ç—Ä—É–∫—Ç—É—Ä–∞"}),e.jsxs("span",{className:"outline-count",children:[t.widgets.length," –≤–∏–¥–∂–µ—Ç–æ–≤"]})]}),e.jsx("div",{className:"outline-list",children:l.length===0?e.jsxs("div",{className:"outline-empty",children:[e.jsx("p",{children:"–ù–µ—Ç –≤–∏–¥–∂–µ—Ç–æ–≤"}),e.jsx("span",{children:"–î–æ–±–∞–≤—å—Ç–µ –≤–∏–¥–∂–µ—Ç—ã –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏"})]}):l.map(s=>{const c=a.includes(s.id),p=s.locked||!1;return e.jsxs("div",{className:`outline-item ${c?"selected":""} ${p?"locked":""}`,onClick:()=>i(s.id,!1),children:[e.jsxs("div",{className:"outline-item-main",children:[e.jsx("span",{className:"outline-icon",children:o(s.type)}),e.jsxs("div",{className:"outline-info",children:[e.jsx("span",{className:"outline-label",children:n(s)}),e.jsxs("span",{className:"outline-meta",children:[s.width,"√ó",s.height," ‚Ä¢ z:",s.zIndex||0]})]})]}),e.jsxs("div",{className:"outline-actions",onClick:u=>u.stopPropagation(),children:[e.jsx("button",{className:"outline-action-btn",onClick:()=>{r(s.id,{locked:!p})},title:p?"–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å":"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å",children:p?e.jsx(ut,{size:14}):e.jsx(Nt,{size:14})}),e.jsx("button",{className:"outline-action-btn delete",onClick:()=>{window.confirm(`–£–¥–∞–ª–∏—Ç—å –≤–∏–¥–∂–µ—Ç "${n(s)}"?`)&&d(s.id)},title:"–£–¥–∞–ª–∏—Ç—å",children:e.jsx(kt,{size:14})})]})]},s.id)})})]})},Kt=()=>{const{addWidget:t,project:a}=O(),i=[{type:"shape",name:"–§–∏–≥—É—Ä–∞",icon:bt,defaultProps:{shapeType:"rectangle",fillColor:"#4a90e2",strokeColor:"#2c3e50",strokeWidth:0,cornerRadius:0,opacity:1}},{type:"button",name:"–ö–Ω–æ–ø–∫–∞",icon:mt,defaultProps:{text:"–ù–∞–∂–º–∏ –º–µ–Ω—è",backgroundColor:"#4a90e2",textColor:"#ffffff"}},{type:"text",name:"–¢–µ–∫—Å—Ç",icon:St,defaultProps:{text:"–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç",fontSize:24,color:"#000000"}},{type:"image",name:"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",icon:pt,defaultProps:{src:""}},{type:"video",name:"–í–∏–¥–µ–æ",icon:Et,defaultProps:{src:"",autoplay:!1,loop:!1}},{type:"menu",name:"–ú–µ–Ω—é",icon:gt,defaultProps:{orientation:"horizontal",items:[{id:"1",label:"–ì–ª–∞–≤–Ω–∞—è"},{id:"2",label:"–û –Ω–∞—Å"},{id:"3",label:"–£—Å–ª—É–≥–∏",children:[{id:"3-1",label:"–£—Å–ª—É–≥–∞ 1"},{id:"3-2",label:"–£—Å–ª—É–≥–∞ 2"}]},{id:"4",label:"–ö–æ–Ω—Ç–∞–∫—Ç—ã"}],backgroundColor:"#2c3e50",textColor:"#ffffff",hoverColor:"#34495e",fontSize:16,fontFamily:"Arial",itemPadding:16,submenuBackgroundColor:"#34495e",submenuTextColor:"#ffffff",borderWidth:0,borderColor:"#000000",itemHeight:40}}],r=(d,o)=>{if(!a)return;const{setPendingWidget:n}=O.getState();n(d,o)};return e.jsxs("div",{className:"widget-library panel",children:[e.jsx("div",{className:"widget-library-header",children:e.jsx("h3",{children:"–í–∏–¥–∂–µ—Ç—ã"})}),e.jsx("div",{className:"widget-library-content",children:i.map(d=>{const o=d.icon;return e.jsxs("button",{className:"widget-item",onClick:()=>r(d.type,d.defaultProps),title:`–î–æ–±–∞–≤–∏—Ç—å ${d.name}`,children:[e.jsx(o,{size:24}),e.jsx("span",{children:d.name})]},d.type)})}),e.jsx("div",{className:"widget-library-footer",children:e.jsx("button",{className:"btn-secondary",style:{width:"100%",fontSize:"12px"},children:"+ –ò–º–ø–æ—Ä—Ç –≤–∏–¥–∂–µ—Ç–∞"})}),e.jsx(Gt,{})]})},Yt=()=>{const{project:t,createProject:a}=O();return C.useEffect(()=>{(async()=>{if(!t&&q.isAuthenticated())try{await a("–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç",{width:1920,height:1080})}catch(r){console.error("[Editor] Failed to create project:",r)}})()},[t,a]),C.useEffect(()=>{const i=r=>{const{undo:d,redo:o,copy:n,paste:l,cut:s,deleteWidget:c,selectedWidgetIds:p,pendingWidget:u,clearPendingWidget:x}=O.getState();if(r.key==="Escape"&&u){r.preventDefault(),x();return}(r.ctrlKey||r.metaKey)&&r.key==="z"&&!r.shiftKey&&(r.preventDefault(),d()),((r.ctrlKey||r.metaKey)&&r.shiftKey&&r.key==="z"||(r.ctrlKey||r.metaKey)&&r.key==="y")&&(r.preventDefault(),o()),(r.ctrlKey||r.metaKey)&&r.key==="c"&&(r.preventDefault(),n()),(r.ctrlKey||r.metaKey)&&r.key==="v"&&(r.preventDefault(),l()),(r.ctrlKey||r.metaKey)&&r.key==="x"&&(r.preventDefault(),s()),r.key==="Delete"&&(r.preventDefault(),p.forEach(g=>c(g)))};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[]),q.isAuthenticated()?t?e.jsxs("div",{className:"editor",children:[e.jsx(Pt,{}),e.jsxs("div",{className:"editor-main",children:[e.jsx(Kt,{}),e.jsx(qt,{}),e.jsx(Vt,{})]})]}):e.jsx("div",{className:"editor-loading",children:e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞..."})}):e.jsxs("div",{className:"editor-loading",children:[e.jsx("p",{children:"–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è..."}),e.jsx("p",{style:{fontSize:"14px",color:"#888",marginTop:"8px"},children:'–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–í–æ–π—Ç–∏" –≤ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤'})]})};class Zt extends C.Component{constructor(a){super(a),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a,errorInfo:null}}componentDidCatch(a,i){console.error("ErrorBoundary caught an error:",a,i),this.setState({error:a,errorInfo:i})}render(){return this.state.hasError?e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",background:"#1e1e1e",color:"#ff6b6b",fontFamily:"Arial, sans-serif",padding:"20px"},children:e.jsxs("div",{style:{textAlign:"center",maxWidth:"700px"},children:[e.jsx("h1",{children:"‚ùå –û—à–∏–±–∫–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ"}),e.jsx("p",{style:{color:"#cccccc",marginBottom:"20px"},children:"–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π."}),this.state.error&&e.jsxs("div",{style:{textAlign:"left",background:"#2a2a2a",padding:"15px",borderRadius:"5px",marginBottom:"20px",overflow:"auto"},children:[e.jsx("div",{style:{color:"#ff6b6b",marginBottom:"10px",fontWeight:"bold"},children:this.state.error.toString()}),this.state.errorInfo&&e.jsx("pre",{style:{fontSize:"12px",color:"#888",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:this.state.errorInfo.componentStack})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"10px 20px",background:"#4a90e2",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"14px"},children:"–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É"}),e.jsx("button",{onClick:()=>{localStorage.clear(),window.location.reload()},style:{padding:"10px 20px",background:"#e74c3c",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"14px"},children:"–°–±—Ä–æ—Å–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å"})]}),e.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#2a2a2a",borderRadius:"5px",textAlign:"left",color:"#cccccc",fontSize:"13px"},children:[e.jsx("strong",{children:"–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:"}),e.jsxs("ul",{style:{marginTop:"10px",marginBottom:0},children:[e.jsxs("li",{children:["–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ - –≤—ã–ø–æ–ª–Ω–∏—Ç–µ ",e.jsx("code",{children:"npm install"})]}),e.jsx("li",{children:"–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è –≤–µ—Ä—Å–∏—è Node.js - —Ç—Ä–µ–±—É–µ—Ç—Å—è v18.0+"}),e.jsx("li",{children:"–ü—Ä–æ–±–ª–µ–º—ã —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏ –º–æ–¥—É–ª–µ–π"}),e.jsx("li",{children:'–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–π –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ - –ø–æ–ø—Ä–æ–±—É–π—Ç–µ "–°–±—Ä–æ—Å–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å"'})]})]})]})}):this.props.children}}function Jt(){return e.jsx(Zt,{children:e.jsx(Yt,{})})}try{const t=document.getElementById("root");if(!t)throw new Error("Root element not found");qe.createRoot(t).render(e.jsx(X.StrictMode,{children:e.jsx(Jt,{})}))}catch(t){console.error("Failed to mount React app:",t),document.body.innerHTML=`
    <div style="
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background: #1e1e1e;
      color: #ff6b6b;
      font-family: Arial, sans-serif;
      padding: 20px;
    ">
      <div style="text-align: center; max-width: 600px;">
        <h1>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</h1>
        <p style="color: #cccccc;">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.</p>
        <pre style="
          text-align: left;
          background: #2a2a2a;
          padding: 15px;
          border-radius: 5px;
          overflow-x: auto;
          color: #ff6b6b;
        ">${t}</pre>
        <button onclick="location.reload()" style="
          margin-top: 20px;
          padding: 10px 20px;
          background: #4a90e2;
          color: white;
          border: none;
          border-radius: 5px;
          cursor: pointer;
          font-size: 14px;
        ">
          –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
        </button>
      </div>
    </div>
  `}
