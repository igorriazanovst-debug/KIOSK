const x=t=>new Promise((e,o)=>{const n=new FileReader;n.onload=r=>{e(r.target?.result)},n.onerror=o,n.readAsText(t)}),p=async t=>{try{if(typeof window<"u"&&window.pdfjsLib){const o=window.pdfjsLib,n=await t.arrayBuffer(),r=await o.getDocument({data:n}).promise;let d="";for(let s=1;s<=r.numPages;s++){const i=(await(await r.getPage(s)).getTextContent()).items.map(a=>a.str).join(" ");d+=i+`

`}return d.trim()}return await t.text()}catch(e){throw console.error("Error extracting PDF text:",e),new Error("Не удалось извлечь текст из PDF. Убедитесь, что файл не защищён паролем.")}},l=async t=>{try{if(typeof window<"u"&&window.JSZip){const e=window.JSZip,o=await t.arrayBuffer(),r=await(await e.loadAsync(o)).file("content.xml")?.async("text");if(!r)throw new Error("content.xml not found in ODT file");const w=new DOMParser().parseFromString(r,"text/xml").querySelectorAll("text\\:p, text\\:h, text\\:span"),c=[];return w.forEach(i=>{const a=i.textContent?.trim();a&&c.push(a)}),c.join(`

`)}throw new Error("JSZip library not available")}catch(e){throw console.error("Error extracting ODT text:",e),new Error("Не удалось извлечь текст из ODT файла. Убедитесь, что файл не повреждён.")}},f=async t=>{try{if(typeof window<"u"&&window.JSZip){const e=window.JSZip,o=await t.arrayBuffer(),r=await(await e.loadAsync(o)).file("word/document.xml")?.async("text");if(!r)throw new Error("document.xml not found in DOCX file");const w=new DOMParser().parseFromString(r,"text/xml").querySelectorAll("w\\:t"),c=[];return w.forEach(i=>{const a=i.textContent?.trim();a&&c.push(a)}),c.join(" ")}throw new Error("JSZip library not available")}catch(e){throw console.error("Error extracting DOCX text:",e),new Error("Не удалось извлечь текст из DOCX файла.")}},m=async t=>{switch(t.name.split(".").pop()?.toLowerCase()){case"txt":case"text":return x(t);case"pdf":return p(t);case"odt":return l(t);case"docx":return f(t);case"doc":throw new Error("Формат .doc не поддерживается. Пожалуйста, конвертируйте в .docx или .txt");default:return x(t)}},u=()=>{if(typeof window<"u"){if(!window.JSZip){const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js",document.head.appendChild(t)}if(!window.pdfjsLib){const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js",t.onload=()=>{window.pdfjsLib&&(window.pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js")},document.head.appendChild(t)}}};export{f as extractTextFromDocx,m as extractTextFromFile,l as extractTextFromOdt,p as extractTextFromPdf,x as extractTextFromTxt,u as loadRequiredLibraries};
